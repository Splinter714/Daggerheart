import{j as e,C as w,a as M,E as k}from"./index-e6ac55ce.js";import{r as F}from"./dndkit-fdc06b07.js";import"./fa-8ab3eb90.js";import"./lucide-abc1b48f.js";const T=({type:d,item:n=null,source:m="campaign",onSave:C,onCancel:j})=>{var N,y;const g=d==="adversary",f=d==="environment",h=d==="countdown",[s,c]=F.useState({name:"",tier:1,type:"",difficulty:1,description:"",motives:"",source:m,hpMax:1,stressMax:0,passiveFeatures:[{name:"",description:""}],actionFeatures:[{name:"",description:""}],reactionFeatures:[{name:"",description:""}],thresholds:{major:0,severe:0},atk:0,weapon:"Weapon",range:"Melee",damage:"1d6 phy",effects:[],hazards:[],max:5,value:0,countdownType:"standard",loop:"none"});F.useEffect(()=>{var a,r,t;n&&c({name:n.name||"",tier:n.tier||1,type:n.type||"",difficulty:n.difficulty||1,description:n.description||"",motives:n.motives||"",source:n.source||m,hpMax:n.hpMax||1,stressMax:n.stressMax||0,passiveFeatures:n.passiveFeatures||((a=n.features)==null?void 0:a.filter(i=>i.type==="Passive"))||[{name:"",description:""}],actionFeatures:n.actionFeatures||((r=n.features)==null?void 0:r.filter(i=>i.type==="Action"))||[{name:"",description:""}],reactionFeatures:n.reactionFeatures||((t=n.features)==null?void 0:t.filter(i=>i.type==="Reaction"))||[{name:"",description:""}],thresholds:n.thresholds||{major:0,severe:0},atk:n.atk||0,weapon:n.weapon||"Weapon",range:n.range||"Melee",damage:n.damage||"1d6 phy",effects:n.effects||[],hazards:n.hazards||[],max:n.max||5,value:n.value||0,countdownType:n.type||"standard",loop:n.loop||"none"})},[n,m]);const l=(a,r)=>{c(t=>({...t,[a]:r}))},o=(a,r,t)=>{c(i=>({...i,[a]:i[a].map((x,b)=>b===r?t:x)}))},p=a=>{c(r=>({...r,[a]:[...r[a],""]}))},u=(a,r)=>{c(t=>({...t,[a]:t[a].filter((i,x)=>x!==r)}))},v=a=>{if(a.preventDefault(),!s.name.trim()){alert("Name is required");return}const r={...s,name:s.name.trim(),description:s.description.trim(),...g&&{hp:0,hpMax:s.hpMax,stress:0,stressMax:s.stressMax,thresholds:s.thresholds,atk:s.atk,weapon:s.weapon,range:s.range,damage:s.damage,features:[...s.passiveFeatures.filter(t=>t.name.trim()).map(t=>({...t,type:"Passive"})),...s.actionFeatures.filter(t=>t.name.trim()).map(t=>({...t,type:"Action"})),...s.reactionFeatures.filter(t=>t.name.trim()).map(t=>({...t,type:"Reaction"}))]},...f&&{effects:s.effects.filter(t=>t.trim()),hazards:s.hazards.filter(t=>t.trim())},...h&&{max:s.max,value:s.value,type:s.countdownType,loop:s.loop}};C(r)};return e.jsx("div",{className:"creator-container",children:e.jsx("form",{onSubmit:v,className:"creator-form",children:g?e.jsxs("div",{className:"expanded-card adversary",children:[e.jsxs("div",{className:"expanded-header",children:[e.jsxs("div",{className:"edit-header-row",children:[e.jsx("input",{type:"text",className:"form-input-inline",value:s.name||"",onChange:a=>l("name",a.target.value),placeholder:"Adversary name"}),e.jsxs("div",{className:"edit-actions",children:[e.jsx("button",{className:"save-button",onClick:v,type:"button",children:"Save"}),e.jsx("button",{className:"cancel-button",onClick:j,type:"button",children:"Cancel"})]})]}),e.jsxs("div",{className:"edit-header-controls",children:[e.jsxs("select",{className:"form-select-inline-small",value:s.tier||1,onChange:a=>l("tier",parseInt(a.target.value)),children:[e.jsx("option",{value:1,children:"Tier 1"}),e.jsx("option",{value:2,children:"Tier 2"}),e.jsx("option",{value:3,children:"Tier 3"}),e.jsx("option",{value:4,children:"Tier 4"})]}),e.jsxs("select",{className:"form-select-inline-small","data-type":"type",value:s.type||"",onChange:a=>l("type",a.target.value),children:[e.jsx("option",{value:"",children:"Type"}),e.jsx("option",{value:"Solo",children:"Solo"}),e.jsx("option",{value:"Bruiser",children:"Bruiser"}),e.jsx("option",{value:"Horde",children:"Horde"}),e.jsx("option",{value:"Minion",children:"Minion"}),e.jsx("option",{value:"Ranged",children:"Ranged"}),e.jsx("option",{value:"Standard",children:"Standard"}),e.jsx("option",{value:"Leader",children:"Leader"}),e.jsx("option",{value:"Skulk",children:"Skulk"}),e.jsx("option",{value:"Social",children:"Social"}),e.jsx("option",{value:"Support",children:"Support"})]})]}),e.jsx("textarea",{className:"form-textarea-inline",value:s.description||"",onChange:a=>l("description",a.target.value),placeholder:"Description",rows:2}),e.jsxs("div",{className:"motives-row",children:[e.jsx("span",{className:"motives-label",children:"Motives & Tactics:"}),e.jsx("div",{className:"motives-field",children:e.jsx("textarea",{className:"inline-field",value:s.motives||"",onChange:a=>l("motives",a.target.value),placeholder:"Motives & Tactics",rows:1})})]})]}),e.jsxs("div",{className:"core-stats-block",children:[e.jsxs("div",{className:"stats-row",children:[e.jsxs("span",{className:"stat-item",children:[e.jsx("strong",{children:"Diff:"}),e.jsx("input",{type:"number",className:"form-input-inline-small",value:s.difficulty||"",onChange:a=>l("difficulty",a.target.value===""?"":parseInt(a.target.value)),min:"1",max:"21"})]}),e.jsx("span",{className:"stat-separator",children:"|"}),e.jsxs("span",{className:"stat-item",children:[e.jsx("strong",{children:"Thresholds:"}),e.jsx("input",{type:"number",className:"form-input-inline-small",value:((N=s.thresholds)==null?void 0:N.major)||"",onChange:a=>l("thresholds",{...s.thresholds,major:a.target.value===""?"":parseInt(a.target.value)}),min:"1",max:"20"}),"/",e.jsx("input",{type:"number",className:"form-input-inline-small",value:((y=s.thresholds)==null?void 0:y.severe)||"",onChange:a=>l("thresholds",{...s.thresholds,severe:a.target.value===""?"":parseInt(a.target.value)}),min:"1",max:"25"})]}),e.jsx("span",{className:"stat-separator",children:"|"}),e.jsxs("span",{className:"stat-item",children:[e.jsx("strong",{children:"HP:"}),e.jsx("input",{type:"number",className:"form-input-inline-small",value:s.hpMax||"",onChange:a=>l("hpMax",a.target.value===""?"":parseInt(a.target.value)),min:"1",max:"12"})]}),e.jsx("span",{className:"stat-separator",children:"|"}),e.jsxs("span",{className:"stat-item",children:[e.jsx("strong",{children:"Stress:"}),e.jsx("input",{type:"number",className:"form-input-inline-small",value:s.stressMax||"",onChange:a=>l("stressMax",a.target.value===""?"":parseInt(a.target.value)),min:"1",max:"10"})]})]}),e.jsxs("div",{className:"stats-row",children:[e.jsxs("span",{className:"stat-item",children:[e.jsx("strong",{children:"ATK:"}),e.jsx("input",{type:"number",className:"form-input-inline-small",value:s.atk||"",onChange:a=>l("atk",a.target.value===""?"":parseInt(a.target.value)),min:"-10",max:"10"})]}),e.jsx("span",{className:"stat-separator",children:"|"}),e.jsxs("span",{className:"stat-item",children:[e.jsx("strong",{children:e.jsx("input",{type:"text",className:"form-input-inline-small",value:s.weapon||"",onChange:a=>l("weapon",a.target.value),placeholder:"Weapon"})}),":",e.jsxs("select",{className:"form-select-inline-small","data-field":"range",value:s.range||"",onChange:a=>l("range",a.target.value),children:[e.jsx("option",{value:"",children:"Select Range"}),e.jsx("option",{value:"Melee",children:"Melee"}),e.jsx("option",{value:"Very Close",children:"Very Close"}),e.jsx("option",{value:"Close",children:"Close"}),e.jsx("option",{value:"Far",children:"Far"}),e.jsx("option",{value:"Very Far",children:"Very Far"})]})]}),e.jsx("span",{className:"stat-separator",children:"|"}),e.jsx("span",{className:"stat-item",children:e.jsx("input",{type:"text",className:"form-input-inline-small",value:s.damage||"",onChange:a=>l("damage",a.target.value),placeholder:"1d12+2 phy"})})]})]}),e.jsxs("div",{className:"features-section",children:[s.passiveFeatures&&s.passiveFeatures.length>0&&e.jsxs("div",{className:"feature-type-section",children:[e.jsxs("div",{className:"feature-type-header",children:[e.jsx("h4",{children:"Passives"}),e.jsx("hr",{})]}),s.passiveFeatures.map((a,r)=>e.jsxs("div",{className:"feature-edit-row",children:[e.jsx("input",{type:"text",className:"form-input-inline",value:a.name||"",onChange:t=>o("passiveFeatures",r,{...a,name:t.target.value}),placeholder:"Feature name"}),e.jsx("textarea",{className:"form-textarea-inline",value:a.description||"",onChange:t=>o("passiveFeatures",r,{...a,description:t.target.value}),placeholder:"Feature description",rows:2}),e.jsx("button",{className:"remove-feature-btn",onClick:()=>u("passiveFeatures",r),type:"button",children:"Remove"})]},r)),e.jsx("button",{className:"add-feature-btn",onClick:()=>p("passiveFeatures"),type:"button",children:"Add Passive"})]}),s.actionFeatures&&s.actionFeatures.length>0&&e.jsxs("div",{className:"feature-type-section",children:[e.jsxs("div",{className:"feature-type-header",children:[e.jsx("h4",{children:"Actions"}),e.jsx("hr",{})]}),s.actionFeatures.map((a,r)=>e.jsxs("div",{className:"feature-edit-row",children:[e.jsx("input",{type:"text",className:"form-input-inline",value:a.name||"",onChange:t=>o("actionFeatures",r,{...a,name:t.target.value}),placeholder:"Feature name"}),e.jsx("textarea",{className:"form-textarea-inline",value:a.description||"",onChange:t=>o("actionFeatures",r,{...a,description:t.target.value}),placeholder:"Feature description",rows:2}),e.jsx("button",{className:"remove-feature-btn",onClick:()=>u("actionFeatures",r),type:"button",children:"Remove"})]},r)),e.jsx("button",{className:"add-feature-btn",onClick:()=>p("actionFeatures"),type:"button",children:"Add Action"})]}),s.reactionFeatures&&s.reactionFeatures.length>0&&e.jsxs("div",{className:"feature-type-section",children:[e.jsxs("div",{className:"feature-type-header",children:[e.jsx("h4",{children:"Reactions"}),e.jsx("hr",{})]}),s.reactionFeatures.map((a,r)=>e.jsxs("div",{className:"feature-edit-row",children:[e.jsx("input",{type:"text",className:"form-input-inline",value:a.name||"",onChange:t=>o("reactionFeatures",r,{...a,name:t.target.value}),placeholder:"Feature name"}),e.jsx("textarea",{className:"form-textarea-inline",value:a.description||"",onChange:t=>o("reactionFeatures",r,{...a,description:t.target.value}),placeholder:"Feature description",rows:2}),e.jsx("button",{className:"remove-feature-btn",onClick:()=>u("reactionFeatures",r),type:"button",children:"Remove"})]},r)),e.jsx("button",{className:"add-feature-btn",onClick:()=>p("reactionFeatures"),type:"button",children:"Add Reaction"})]})]})]}):e.jsxs(w,{item:n,type:d,editData:s,onChange:l,onSave:v,onCancel:j,showMetaDetails:!h,children:[h&&e.jsx(M,{data:s,onChange:l}),f&&e.jsx(k,{data:s,onArrayChange:o,onAddItem:p,onRemoveItem:u})]})})})};export{T as default};
