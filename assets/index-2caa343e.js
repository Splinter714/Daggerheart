import{r as v,a as be,R as ie}from"./dndkit-57209f9c.js";import{F as Te,f as Le,a as Be,b as Re,c as pe}from"./fa-b4bcccb0.js";import{D as ne,A as je,H as re,X as we,C as He,M as Ne,P as se,a as Pe,T as Fe,b as Oe,E as $e,F as Ve,S as ue,c as he}from"./lucide-503236d0.js";(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const d of document.querySelectorAll('link[rel="modulepreload"]'))h(d);new MutationObserver(d=>{for(const l of d)if(l.type==="childList")for(const o of l.addedNodes)o.tagName==="LINK"&&o.rel==="modulepreload"&&h(o)}).observe(document,{childList:!0,subtree:!0});function p(d){const l={};return d.integrity&&(l.integrity=d.integrity),d.referrerPolicy&&(l.referrerPolicy=d.referrerPolicy),d.crossOrigin==="use-credentials"?l.credentials="include":d.crossOrigin==="anonymous"?l.credentials="omit":l.credentials="same-origin",l}function h(d){if(d.ep)return;d.ep=!0;const l=p(d);fetch(d.href,l)}})();var Ce={exports:{}},te={};/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var _e=v,qe=Symbol.for("react.element"),Ye=Symbol.for("react.fragment"),Xe=Object.prototype.hasOwnProperty,Ge=_e.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,Ue={key:!0,ref:!0,__self:!0,__source:!0};function Se(r,t,p){var h,d={},l=null,o=null;p!==void 0&&(l=""+p),t.key!==void 0&&(l=""+t.key),t.ref!==void 0&&(o=t.ref);for(h in t)Xe.call(t,h)&&!Ue.hasOwnProperty(h)&&(d[h]=t[h]);if(r&&r.defaultProps)for(h in t=r.defaultProps,t)d[h]===void 0&&(d[h]=t[h]);return{$$typeof:qe,type:r,key:l,ref:o,props:d,_owner:Ge.current}}te.Fragment=Ye;te.jsx=Se;te.jsxs=Se;Ce.exports=te;var e=Ce.exports,oe={},xe=be;oe.createRoot=xe.createRoot,oe.hydrateRoot=xe.hydrateRoot;const ge={fear:{icon:Le,maxValue:12,containerStyle:{display:"flex",gap:"0.125rem",alignItems:"center",justifyContent:"center",width:"100%",height:"100%",padding:"0.125rem",maxWidth:"none"},pipStyle:{fontSize:"var(--text-lg)",fontWeight:600,transition:"color 0.3s ease",height:"1.5rem",width:"1.5rem",display:"inline-block",textAlign:"center",lineHeight:"1.5rem",flexShrink:0,imageRendering:"crisp-edges"},filledColor:"var(--purple)",emptyColor:"var(--gray-dark)",tooltipTitle:"Click anywhere in header to adjust fear:",tooltipInstructions:[{text:"Left of boundary:",description:"Click to decrease fear by 1"},{text:"Right of boundary:",description:"Click to increase fear by 1"}]},hp:{icon:Be,maxValue:20,containerStyle:{display:"inline-block",width:"auto",height:"100%",padding:"0.125rem",textAlign:"center"},pipStyle:{fontSize:"var(--text-sm)",fontWeight:600,transition:"color 0.3s ease",height:"1.5rem",width:"1.5rem",display:"inline-block",textAlign:"center",lineHeight:"1.5rem",flexShrink:0},filledColor:"var(--red)",emptyColor:"var(--text-secondary)",tooltipTitle:"Click anywhere to adjust HP:",tooltipInstructions:[{text:"Left of boundary:",description:"Click to decrease HP by 1"},{text:"Right of boundary:",description:"Click to increase HP by 1"}]},stress:{icon:Re,maxValue:12,containerStyle:{display:"inline-block",width:"auto",height:"100%",padding:"0.125rem",textAlign:"center"},pipStyle:{fontSize:"var(--text-sm)",fontWeight:600,transition:"color 0.3s ease",height:"1.5rem",width:"1.5rem",display:"inline-block",textAlign:"center",lineHeight:"1.5rem",flexShrink:0},filledColor:"var(--gold)",emptyColor:"var(--text-secondary)",tooltipTitle:"Click anywhere to adjust stress:",tooltipInstructions:[{text:"Left of boundary:",description:"Click to decrease stress by 1"},{text:"Right of boundary:",description:"Click to increase stress by 1"}]},countdown:{icon:pe,maxValue:6,containerStyle:{display:"inline-block",width:"auto",height:"100%",padding:"0.125rem",textAlign:"center"},pipStyle:{fontSize:"var(--text-sm)",fontWeight:600,transition:"color 0.3s ease",height:"1.5rem",width:"1.5rem",display:"inline-block",textAlign:"center",lineHeight:"1.5rem",flexShrink:0},filledColor:"var(--text-secondary)",emptyColor:"var(--text-secondary)",tooltipTitle:"Click anywhere to adjust countdown:",tooltipInstructions:[{text:"Left of boundary:",description:"Click to decrease countdown by 1"},{text:"Right of boundary:",description:"Click to increase countdown by 1"}]},hpDots:{maxValue:20,containerStyle:{display:"flex",flexWrap:"wrap",gap:"1px",justifyContent:"center",alignItems:"center",maxWidth:"120px"},pipStyle:{width:"8px",height:"8px",borderRadius:"50%",border:"1px solid var(--border)",transition:"background-color 0.5s ease, border-color 0.5s ease, box-shadow 0.5s ease"},filledStyle:{background:"var(--red)",borderColor:"var(--red)",boxShadow:"0 0 4px rgba(239, 68, 68, 0.5)"},emptyStyle:{background:"var(--bg-primary)",borderColor:"var(--border)"},isDots:!0,tooltipTitle:"Click anywhere to adjust HP:",tooltipInstructions:[{text:"Left of boundary:",description:"Click to decrease HP by 1"},{text:"Right of boundary:",description:"Click to increase HP by 1"}]},stressDots:{maxValue:12,containerStyle:{display:"flex",flexWrap:"wrap",gap:"1px",justifyContent:"center",alignItems:"center",maxWidth:"120px"},pipStyle:{width:"8px",height:"8px",borderRadius:"50%",border:"1px solid var(--border)",transition:"background-color 0.5s ease, border-color 0.5s ease, box-shadow 0.5s ease"},filledStyle:{background:"var(--purple)",borderColor:"var(--purple)",boxShadow:"0 0 4px rgba(139, 92, 246, 0.5)"},emptyStyle:{background:"var(--bg-primary)",borderColor:"var(--border)"},isDots:!0,tooltipTitle:"Click anywhere to adjust stress:",tooltipInstructions:[{text:"Left of boundary:",description:"Click to decrease stress by 1"},{text:"Right of boundary:",description:"Click to increase stress by 1"}]},adversaryHP:{icon:ne,maxValue:20,containerStyle:{display:"flex",gap:"0px",flexWrap:"wrap",alignContent:"flex-start",rowGap:"0.03125rem",maxWidth:"100%"},pipStyle:{fontSize:"var(--text-sm)",fontWeight:600,transition:"color 0.3s ease",cursor:"pointer",width:"1rem",height:"1rem",display:"flex",alignItems:"center",justifyContent:"center",flexShrink:0},filledColor:"var(--red)",emptyColor:"var(--gray-400)",tooltipTitle:"Click to adjust HP:",tooltipInstructions:[{text:"Filled pip:",description:"Click to heal (reduce damage)"},{text:"Empty pip:",description:"Click to take damage"}]},adversaryStress:{icon:je,maxValue:12,containerStyle:{display:"flex",gap:"0px",flexWrap:"wrap",alignContent:"flex-start",rowGap:"0.03125rem",maxWidth:"100%"},pipStyle:{fontSize:"var(--text-sm)",fontWeight:600,transition:"color 0.3s ease",cursor:"pointer",width:"1rem",height:"1rem",display:"flex",alignItems:"center",justifyContent:"center",flexShrink:0},filledColor:"var(--gold)",emptyColor:"var(--gray-400)",tooltipTitle:"Click to adjust stress:",tooltipInstructions:[{text:"Filled pip:",description:"Click to reduce stress"},{text:"Empty pip:",description:"Click to increase stress"}]},countdownDistributed:{icon:pe,maxValue:6,containerStyle:{display:"inline-block",width:"auto",height:"100%",padding:"0.125rem",textAlign:"center"},pipStyle:{fontSize:"var(--text-sm)",fontWeight:600,transition:"color 0.3s ease",height:"1.5rem",width:"1.5rem",display:"inline-block",textAlign:"center",lineHeight:"1.5rem",flexShrink:0},filledColor:"var(--text-secondary)",emptyColor:"var(--text-secondary)",tooltipTitle:"Countdown progress:",tooltipInstructions:[{text:"Progress:",description:"Current countdown value"}]}},ee=({type:r="fear",value:t=0,maxValue:p,onChange:h,size:d="lg",showTooltip:l=!0,containerStyle:o={},pipStyle:a={},countdownType:n=null,distributedGroups:i=null,onPipClick:c=null,enableBoundaryClick:s=!1,clickContainerWidth:x="auto",centerPips:f=!0})=>{const[j,w]=v.useState(!1),y=ge[r]||ge.fear,W=p||y.maxValue,S=Math.max(0,Math.min(W,t));let I=y.filledColor;r==="countdown"&&n&&(["progress","dynamic-progress","simple-hope"].includes(n)?I="var(--gold)":["consequence","dynamic-consequence","simple-fear"].includes(n)?I="var(--purple)":["long-term","standard"].includes(n)&&(I="var(--text-secondary)"));const C=(T,L)=>{if(c)c(T,L);else if(h){const O=T+1;h(O)}},E=T=>{if(!s||!h||c)return;T.currentTarget.getBoundingClientRect();const L=T.currentTarget.querySelector(".pip-container");if(!L)return;const O=L.getBoundingClientRect(),P=T.clientX-O.left;if(P<0){S>0&&h(S-1);return}if(P>O.width){S<W&&h(S+1);return}const V=O.width,_=V*.05,z=V-2*_,k=P-_,M=S/W,u=z*M;k<u?S>0&&h(S-1):S<W&&h(S+1)},D=(()=>{if(!i||r!=="countdownDistributed")return[{start:0,end:W,groupIndex:0}];let T=0;return i.map((L,O)=>{const P={start:T,end:T+L,groupIndex:O};return T+=L,P})})(),$=()=>e.jsxs(e.Fragment,{children:[D.map(T=>e.jsx(ie.Fragment,{children:[...Array(T.end-T.start)].map((L,O)=>{const P=T.start+O,V=P<S;if(y.isDots)return e.jsx("div",{style:{...y.pipStyle,...V?y.filledStyle:y.emptyStyle,...a,cursor:h||c?"pointer":"default"},onClick:s?void 0:()=>C(P,V),title:`${P+1} of ${W}`},P);{const _=y.icon,z=_&&typeof _=="object"&&_.iconName,k=V?I:y.emptyColor;return e.jsx("span",{className:`fear-pip ${V?"filled":"empty"}`,style:{...y.pipStyle,color:k,cursor:h||c?"pointer":"default",...a},onClick:s?void 0:()=>C(P,V),title:`${P+1} of ${W}`,children:z?e.jsx(Te,{icon:_,size:d}):e.jsx(_,{size:16})},P)}})},T.groupIndex)),l&&e.jsx("div",{style:{position:"relative",cursor:"help",pointerEvents:"none"},children:e.jsxs("div",{style:{position:"absolute",bottom:"100%",left:"50%",transform:j?"translateX(-50%) translateY(-5px)":"translateX(-50%)",background:"rgba(15, 23, 42, 0.95)",border:"1px solid var(--gray)",borderRadius:"var(--radius-md)",padding:"var(--space-md)",minWidth:"250px",zIndex:1e3,opacity:j?1:0,visibility:j?"visible":"hidden",transition:"all 0.2s ease",boxShadow:"0 10px 25px rgba(0, 0, 0, 0.5)"},children:[e.jsx("div",{style:{fontWeight:600,color:"var(--gray-200)",marginBottom:"0.75rem",fontSize:"var(--text-sm)"},children:y.tooltipTitle}),y.tooltipInstructions.map((T,L)=>e.jsxs("div",{style:{marginBottom:"0.5rem",fontSize:"0.8rem",color:"var(--gray-300)",lineHeight:1.4},children:[e.jsx("strong",{style:{color:"var(--gray-200)"},children:T.text})," ",T.description]},L))]})})]});return e.jsx("div",{style:{width:x,height:"100%",cursor:h||c?"pointer":"default",touchAction:"manipulation",userSelect:"none",display:f?"flex":"block",alignItems:f?"center":"stretch",justifyContent:f?"center":"flex-start",...o},onClick:T=>{T.stopPropagation(),T.preventDefault(),s&&E(T)},onMouseEnter:()=>w(l),onMouseLeave:()=>w(!1),children:e.jsx("div",{className:"pip-container",style:{...y.containerStyle,width:"auto",height:"100%",padding:"0.125rem",textAlign:"center"},children:$()})})};function le(r){const t=typeof crypto<"u"&&crypto.randomUUID?crypto.randomUUID():`${Date.now()}-${Math.random().toString(36).slice(2,10)}`;return r?`${r}-${t}`:t}const Ke=(r,t)=>({createAdversary:o=>{const a=le("adv"),n=r().adversaries||[],i=o.name||"Unknown",c=n.filter(f=>f.baseName===i);let s=1;if(c.length===0)s=1;else{const f=c.map(w=>w.duplicateNumber||1);let j=1;for(;f.includes(j);)j++;s=j}const x={...o,id:a,baseName:i,duplicateNumber:s,name:`${i} (${s})`,hp:0,stress:0,isVisible:!0};t(f=>({...f,adversaries:[...f.adversaries,x]}))},updateAdversary:(o,a)=>{t(n=>({...n,adversaries:n.adversaries.map(i=>{if(i.id===o){const c={...i,...a};if(a.baseName!==void 0){const s=a.baseName,x=c.duplicateNumber||1;c.name=x===1?s:`${s} (${x})`}return c}return i})}))},deleteAdversary:o=>{t(a=>({...a,adversaries:a.adversaries.filter(n=>n.id!==o)}))},reorderAdversaries:o=>{t(a=>{const[n,i]=o,c=[...a.adversaries],[s]=c.splice(n,1);return c.splice(i,0,s),{...a,adversaries:c}})}}),Je=r=>({createCountdown:n=>{const i={id:le("countdown"),name:n.name||"Countdown",max:parseInt(n.max)||1,value:0,visible:!0,type:n.type||"standard",loop:n.loop||"none",source:n.source||"campaign"};r(c=>({...c,countdowns:[...c.countdowns,i]}))},updateCountdown:(n,i)=>{r(c=>({...c,countdowns:c.countdowns.map(s=>s.id===n?{...s,...i}:s)}))},deleteCountdown:n=>{r(i=>({...i,countdowns:i.countdowns.filter(c=>c.id!==n)}))},advanceCountdown:(n,i)=>{r(c=>({...c,countdowns:c.countdowns.map(s=>{if(s.id!==n)return s;let x=i;if(s.loop==="loop")x>s.max?x=(x-1)%s.max+1:x<0&&(x=s.max);else if(s.loop==="increasing"){if(x>s.max)return{...s,max:s.max+1,value:1};if(x<0)return{...s,max:Math.max(1,s.max-1),value:1};x=Math.max(0,x)}else if(s.loop==="decreasing"){if(x>s.max)return{...s,max:Math.max(1,s.max-1),value:1};if(x<0)return{...s,max:s.max+1,value:1};x=Math.min(s.max,x)}else x=Math.max(0,Math.min(x,s.max));return{...s,value:x}})}))},incrementCountdown:(n,i=1)=>{r(c=>({...c,countdowns:c.countdowns.map(s=>{if(s.id!==n)return s;let x=s.value+i;if(s.loop==="loop")x>s.max&&(x=(x-1)%s.max+1);else if(s.loop==="increasing"){if(x>s.max)return{...s,max:s.max+1,value:1}}else if(s.loop==="decreasing"){if(x>s.max)return{...s,max:Math.max(1,s.max-1),value:1}}else x=Math.min(x,s.max);return{...s,value:x}})}))},decrementCountdown:n=>{r(i=>({...i,countdowns:i.countdowns.map(c=>{if(c.id!==n)return c;let s=c.value-1;if(c.loop==="loop")s<0&&(s=c.max);else if(c.loop==="increasing"){if(s<0)return{...c,max:Math.max(1,c.max-1),value:c.max};s=Math.max(0,s)}else if(c.loop==="decreasing"){if(s<0)return{...c,max:c.max+1,value:1}}else s=Math.max(0,s);return{...c,value:s}})}))},reorderCountdowns:n=>{r(i=>{const[c,s]=n,x=[...i.countdowns],[f]=x.splice(c,1);return x.splice(s,0,f),{...i,countdowns:x}})}}),Qe=(r,t)=>({createEnvironment:o=>{const a=le("env"),i=(r().environments||[]).filter(x=>x.name.replace(/\s+\(\d+\)$/,"")===o.name);let c=o.name||"Unknown";if(i.length===0)c=o.name;else if(i.length===1){const x=i[0],f=x.name.replace(/\s+\(\d+\)$/,""),j=r().environments.map(w=>w.id===x.id?{...w,name:`${f} (1)`}:w);t(w=>({...w,environments:j})),c=`${o.name} (2)`}else{const x=i.map(j=>{const w=j.name.match(/\((\d+)\)$/);return w?parseInt(w[1]):null}).filter(j=>j!==null);let f=1;for(;x.includes(f);)f++;c=`${o.name} (${f})`}const s={...o,id:a,name:c,isVisible:!0};t(x=>({...x,environments:[...x.environments,s]}))},updateEnvironment:(o,a)=>{t(n=>({...n,environments:n.environments.map(i=>i.id===o?{...i,...a}:i)}))},deleteEnvironment:o=>{t(a=>({...a,environments:a.environments.filter(n=>n.id!==o)}))},reorderEnvironments:o=>{t(a=>{const[n,i]=o,c=[...a.environments],[s]=c.splice(n,1);return c.splice(i,0,s),{...a,environments:c}})}});function Ze(r,t){const p=(r==null?void 0:r.type)||"standard";if(p==="standard")return 1;if(p==="progress"||p==="dynamic-progress")switch(t){case"success-hope":return 2;case"success-fear":return 1;case"critical-success":return 3;default:return 0}if(p==="consequence"||p==="dynamic-consequence")switch(t){case"success-fear":return 1;case"failure-hope":return 2;case"failure-fear":return 3;default:return 0}return p==="simple-fear"?t==="simple-fear"||t==="success-fear"||t==="failure-fear"?1:0:p==="simple-hope"&&(t==="simple-hope"||t==="success-hope"||t==="failure-hope"||t==="critical-success")?1:0}function er(r){return((r==null?void 0:r.type)||"standard")==="standard"?1:0}function rr({adversaries:r,updateAdversary:t,deleteAdversary:p,selectedItem:h,setSelectedItem:d}){const l=v.useCallback((n,i,c,s)=>{var W,S;const x=r.find(I=>I.id===n);if(!x)return;const f=x.type==="Minion",j=(W=x.features)==null?void 0:W.find(I=>{var C;return(C=I.name)==null?void 0:C.startsWith("Minion (")}),w=j?parseInt(((S=j.name.match(/\((\d+)\)/))==null?void 0:S[1])||"1"):1;if(f){p(n);const I=Math.floor(i/w);if(I>0){const C=r.filter(E=>E.type==="Minion"&&E.id!==n&&E.name===x.name);for(let E=0;E<Math.min(I,C.length);E++)p(C[E].id)}return}const y=Math.min(c+i,s);h&&h.id===n&&d(I=>({...I,hp:y})),t(n,{hp:y})},[r,t,p,h,d]),o=v.useCallback((n,i,c)=>{const s=Math.max(0,c-i);h&&h.id===n&&d(x=>({...x,hp:s})),t(n,{hp:s})},[t,h,d]),a=v.useCallback((n,i,c,s)=>{const x=r.find(w=>w.id===n);if(!x)return;let f=c+i,j=x.hp||0;if(f>s){const w=f-s;f=s,j=Math.min(x.hpMax||0,j+w)}f=Math.max(0,f),h&&h.id===n&&d(w=>({...w,stress:f,hp:j})),t(n,{stress:f,hp:j})},[r,t,h,d]);return{handleAdversaryDamage:l,handleAdversaryHealing:o,handleAdversaryStressChange:a}}const B={transitions:{hoverIn:"all 0.1s ease",hoverOut:"all 0.3s ease",colorIn:"color 0.1s ease",colorOut:"color 0.3s ease",backgroundIn:"background-color 0.1s ease",backgroundOut:"background-color 0.3s ease"},card:{backgroundColor:"var(--bg-card)",borderRadius:"8px",padding:"12px",cursor:"pointer",transition:"all 0.1s ease",position:"relative"},cardHover:{backgroundColor:"var(--bg-card-hover)"},cardDead:{opacity:.6,backgroundColor:"var(--gray-800)",borderColor:"var(--border)"},cardAtMax:{backgroundColor:"var(--success)",borderColor:"var(--success)"},rowMain:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:"8px"},rowTitle:{fontSize:"16px",fontWeight:"600",color:"var(--text-primary)",margin:0},rowMeta:{display:"flex",gap:"8px",alignItems:"center"},cardActions:{display:"flex",justifyContent:"flex-start",alignItems:"center",gap:"12px"},controlButtons:{display:"flex",gap:"8px",alignItems:"center"},pipSymbols:{display:"flex",gap:"4px",alignItems:"center",cursor:"pointer",padding:"2px"},pipSymbol:{fontSize:"16px",transition:"color 0.1s ease"},pipGroup:{display:"flex",gap:"4px",marginBottom:"4px"},badge:{padding:"2px 6px",borderRadius:"3px",fontSize:"10px",fontWeight:"600",textTransform:"uppercase"},typeBadge:{backgroundColor:"var(--purple)",color:"var(--text-primary)"},difficultyBadge:{backgroundColor:"var(--gray-500)",color:"var(--text-primary)",cursor:"pointer",transition:"background-color 0.1s ease"},tierBadge:{backgroundColor:"var(--info)",color:"var(--text-primary)"},inputBase:{padding:"8px",borderColor:"var(--gray-500)",backgroundColor:"var(--gray-900)",color:"var(--text-primary)",fontSize:"14px",transition:"all 0.2s ease"},inputBaseFocus:{outline:"none",borderColor:"var(--purple)",boxShadow:"0 0 0 2px rgba(79, 70, 229, 0.1)"},inputBaseDisabled:{opacity:.6,cursor:"not-allowed"},button:{backgroundColor:"var(--danger)",color:"var(--text-primary)",borderWidth:"0",borderStyle:"none",borderRadius:"4px",padding:"4px 8px",fontSize:"14px",cursor:"pointer",transition:"background-color 0.1s ease"},incrementButton:{backgroundColor:"var(--success)",color:"var(--text-primary)",borderWidth:"0",borderStyle:"none",borderRadius:"4px",padding:"4px 8px",fontSize:"14px",cursor:"pointer",transition:"background-color 0.1s ease"},decrementButton:{backgroundColor:"var(--warning)",color:"var(--text-primary)",borderWidth:"0",borderStyle:"none",borderRadius:"4px",padding:"4px 8px",fontSize:"14px",cursor:"pointer",transition:"background-color 0.1s ease"},damageInputPopup:{position:"absolute",top:0,left:0,right:0,bottom:0,backgroundColor:"rgba(0, 0, 0, 0.8)",display:"flex",alignItems:"center",justifyContent:"center",zIndex:1e3,borderRadius:"8px"},damageInputContent:{backgroundColor:"var(--gray-900)",borderWidth:"1px",borderStyle:"solid",borderColor:"var(--border)",borderRadius:"8px",padding:"8px",display:"flex",flexDirection:"row",gap:"8px",minWidth:"200px",alignItems:"center",position:"absolute",right:"1rem",top:"50%",transform:"translateY(-50%)"},damageInput:{backgroundColor:"var(--gray-900)",borderWidth:"1px",borderStyle:"solid",borderColor:"var(--border)",borderRadius:"4px",padding:"4px 6px",color:"var(--text-primary)",fontSize:"12px",width:"80px",textAlign:"center"},damageIndicators:{display:"flex",gap:"8px",alignItems:"center",justifyContent:"center"},damageDrop:{fontSize:"16px",color:"var(--text-secondary)",cursor:"pointer",transition:"color 0.1s ease"},applyButton:{backgroundColor:"var(--gray-600)",color:"white",borderWidth:"0",borderStyle:"none",borderRadius:"4px",padding:"4px 8px",fontSize:"14px",cursor:"pointer",transition:"background-color 0.1s ease",display:"flex",alignItems:"center",justifyContent:"center",minWidth:"32px",minHeight:"32px"}},tr=(r,t,p,h)=>{const[d,l]=v.useState(!1),[o,a]=v.useState("");v.useEffect(()=>{if(d){const f=j=>{j.target.closest(".damage-input-popup")||(l(!1),a(""))};return document.addEventListener("click",f),()=>document.removeEventListener("click",f)}},[d]);const n=f=>{f.stopPropagation(),f.preventDefault();const j=r.hp||0,w=r.hpMax||1,y=f.currentTarget.getBoundingClientRect(),W=f.clientX-y.left,S=y.width/w;Math.floor(W/S)<j?p&&p(r.id,1,r.hp):t&&t(r.id,1,r.hp,r.hpMax)},i=f=>{f.stopPropagation(),f.preventDefault();const j=r.stress||0,w=r.stressMax||1,y=f.currentTarget.getBoundingClientRect(),W=f.clientX-y.left,S=y.width/w;Math.floor(W/S)<j?h&&h(r.id,-1,r.stress,r.stressMax):h&&h(r.id,1,r.stress,r.stressMax)},c=f=>{f.stopPropagation(),(r.thresholds&&r.thresholds.major&&r.thresholds.severe||r.type==="Minion")&&(l(!0),a(r.type==="Minion"?"1":""))},s=()=>{const f=parseInt(o);if(f>0){if(r.type==="Minion")t&&t(r.id,f,r.hp,r.hpMax);else{let j=0;f>=r.thresholds.severe?j=3:f>=r.thresholds.major?j=2:f>=1&&(j=1),t&&t(r.id,j,r.hp,r.hpMax)}l(!1),a("")}};return{showDamageInput:d,damageValue:o,setDamageValue:a,setShowDamageInput:l,handleHpClick:n,handleStressClick:i,handleDifficultyClick:c,applyDamage:s,handleKeyDown:f=>{f.key==="Enter"?s():f.key==="Escape"&&(l(!1),a(""))}}},nr=(r,t,p)=>({renderDistributedPips:()=>{const d=r.max,l=[];for(let o=0;o<d;o+=5){const a=Math.min(5,d-o);l.push(a)}return l.map((o,a)=>e.jsx("div",{style:B.pipGroup,children:Array.from({length:o},(n,i)=>{const c=a*5+i;return e.jsx("span",{style:{...B.pipSymbol,color:c<(r.value||0)?"var(--red)":"var(--text-secondary)"},title:`${c+1} of ${r.max}`,children:c<(r.value||0)?"●":"○"},c)})},a))}}),Q=({item:r,type:t,mode:p="compact",onClick:h,onDelete:d,onApplyDamage:l,onApplyHealing:o,onApplyStressChange:a,onUpdate:n,onIncrement:i,onDecrement:c,dragAttributes:s,dragListeners:x,adversaries:f=[],isSelected:j=!1,isEditMode:w=!1})=>{const y=tr(r,l,o,a),W=nr(r);(t==="adversary"||t==="adversaries")&&y.handleDifficultyClick;const[S,I]=v.useState(!1),C=()=>{I(!0)},E=()=>{I(!1)},N=(u=!1)=>{let g={...B.card};if(j?g.transition="none":g.transition=S?B.transitions.hoverIn:B.transitions.hoverOut,u){const{marginTop:m,...b}=g;g=b}return(S&&p!=="expanded"||j)&&(g={...g,...B.cardHover}),t==="adversary"&&(r.hp||0)>=(r.hpMax||1)&&(g={...g,...B.cardDead}),t==="countdown"&&(r.value||0)>=r.max&&(g={...g,...B.cardAtMax}),g},D=()=>{let u="border rounded-lg";return(S&&p!=="expanded"||j)&&(u+=" border-hover"),u},$=()=>{var u,g;if(t==="adversary"||t==="adversaries"){const m=r.baseName||((u=r.name)==null?void 0:u.replace(/\s+\(\d+\)$/,""))||"",b=r.duplicateNumber||((g=r.name)!=null&&g.match(/\((\d+)\)$/)?parseInt(r.name.match(/\((\d+)\)$/)[1]):1),A=[...f];return f.some(Y=>Y.id===r.id)||A.push(r),A.filter(Y=>Y.baseName===m).length>1?`${m} (${b})`:m}return r.name},T=()=>{const u=[];return r.type&&u.push(e.jsx("span",{style:{...B.badge,...B.typeBadge},children:r.type},"type")),t==="environment"&&r.tier&&u.push(e.jsxs("span",{style:{...B.badge,...B.tierBadge},children:["Tier ",r.tier]},"tier")),u},L=()=>e.jsxs("div",{style:B.cardActions,children:[e.jsxs("div",{style:B.controlButtons,children:[e.jsx("div",{style:{display:"flex",alignItems:"center"},children:e.jsx("div",{style:{display:"flex",gap:"0.25rem",alignItems:"center",cursor:"pointer",padding:"0.125rem",borderRadius:"0.5rem",transition:"all 0.2s ease"},onClick:t==="adversary"||t==="adversaries"?y.handleHpClick:void 0,onMouseEnter:u=>u.target.style.background="var(--gray-800)",onMouseLeave:u=>u.target.style.background="transparent",children:Array.from({length:r.hpMax||1},(u,g)=>e.jsx("span",{style:{fontSize:"1rem",transition:"color 0.1s ease",cursor:"pointer",color:g<(r.hp||0)?"var(--red)":"var(--text-secondary)"},title:g<(r.hp||0)?"Click to heal (reduce damage)":"Click to take damage",children:e.jsx(ne,{size:16})},g))})}),r.stressMax>0&&e.jsx("div",{style:{display:"flex",alignItems:"center"},children:e.jsx("div",{style:{display:"flex",gap:"0.25rem",alignItems:"center",cursor:"pointer",padding:"0.125rem",borderRadius:"0.5rem",transition:"all 0.2s ease"},onClick:t==="adversary"||t==="adversaries"?y.handleStressClick:void 0,onMouseEnter:u=>u.target.style.background="var(--gray-800)",onMouseLeave:u=>u.target.style.background="transparent",children:Array.from({length:r.stressMax},(u,g)=>e.jsx("span",{style:{fontSize:"1rem",transition:"color 0.1s ease",cursor:"pointer",color:g<(r.stress||0)?"var(--gold)":"var(--text-secondary)"},title:g<(r.stress||0)?"Click to reduce stress":"Click to increase stress",children:e.jsx(je,{size:16})},g))})}),r.difficulty&&e.jsx("div",{style:{display:"flex",alignItems:"center",gap:"0.5rem"},children:e.jsx("div",{onClick:t==="adversary"||t==="adversaries"?y.handleDifficultyClick:void 0,style:{cursor:r.thresholds&&r.thresholds.major&&r.thresholds.severe||r.type==="Minion"?"pointer":"default"},title:r.thresholds&&r.thresholds.major&&r.thresholds.severe?`Click to enter damage (thresholds: ${r.thresholds.major}/${r.thresholds.severe})`:r.type==="Minion"?"Click to enter damage (minion mechanics)":"",children:e.jsx("div",{className:"border rounded-sm",style:{display:"flex",alignItems:"center",gap:"0.25rem",background:"var(--gray-900)",borderColor:"var(--border)",padding:"0.25rem 0.5rem",transition:"all 0.2s ease"},onMouseEnter:u=>u.target.style.background="var(--gray-800)",onMouseLeave:u=>u.target.style.background="var(--gray-900)",children:e.jsx("span",{style:{fontSize:"0.875rem",fontWeight:600,color:"var(--text-primary)"},children:r.difficulty})})})})]}),e.jsx("div",{style:{display:"flex",alignItems:"center"},children:!1})]}),O=()=>null,P=()=>e.jsxs(e.Fragment,{children:[e.jsx("button",{style:B.decrementButton,onClick:u=>{u.stopPropagation(),u.preventDefault(),c&&c(r.id)},title:"Decrease progress",children:e.jsx(Ne,{size:16})}),e.jsx("button",{style:B.incrementButton,onClick:u=>{u.stopPropagation(),u.preventDefault(),i&&i(r.id)},title:r.value>=r.max?r.loop&&r.loop!=="none"?"Loop countdown":"Countdown at max":"Increase progress",children:r.value>=r.max?r.loop&&r.loop!=="none"?"⟳":e.jsx(se,{size:16}):e.jsx(se,{size:16})})]}),V=()=>{switch(t){case"adversary":return L();case"environment":return O();case"countdown":return P();default:return null}},_=()=>t==="countdown"?e.jsx("div",{style:B.pipSymbols,children:t==="countdown"?W.renderDistributedPips():null}):null,z=()=>t!=="adversary"||!y.showDamageInput||!(r.thresholds&&r.thresholds.major&&r.thresholds.severe||r.type==="Minion")?null:e.jsx("div",{className:"damage-input-popup",style:B.damageInputPopup,onClick:u=>{u.stopPropagation(),u.target===u.currentTarget&&(t==="adversary"||t==="adversaries")&&(y.setShowDamageInput(!1),y.setDamageValue(""))},children:e.jsxs("div",{className:"border rounded-lg",style:{...B.damageInputContent,borderColor:"var(--border)"},onClick:u=>u.stopPropagation(),children:[e.jsx("input",{type:"number",inputMode:"numeric",enterKeyHint:"done",placeholder:"dmg",min:(r.type==="Minion","0"),value:t==="adversary"||t==="adversaries"?y.damageValue:"",onChange:u=>{(t==="adversary"||t==="adversaries")&&y.setDamageValue(u.target.value)},onKeyDown:t==="adversary"||t==="adversaries"?y.handleKeyDown:void 0,className:"border rounded-sm",style:{...B.damageInput,borderColor:"var(--border)"},autoFocus:!0}),e.jsxs("div",{style:B.damageIndicators,children:[r.type==="Minion"?(()=>{var A,R;const u=parseInt(t==="adversary"||t==="adversaries"?y.damageValue:"0")||0,g=(A=r.features)==null?void 0:A.find(X=>{var Y;return(Y=X.name)==null?void 0:Y.startsWith("Minion (")}),m=g?parseInt(((R=g.name.match(/\((\d+)\)/))==null?void 0:R[1])||"1"):1,b=Math.floor(u/m);return u>=m&&b>0?e.jsxs("span",{style:{...B.damageDrop,color:"var(--red)"},title:`${u} damage can defeat ${b+1} minion${b+1!==1?"s":""} (1 + ${b} additional)`,children:["+",b," additional minion(s)"]}):e.jsx("span",{style:B.damageDrop,title:`${u} damage defeats this minion only`,children:"+0 additional minion(s)"})})():[1,2,3].map(u=>{const g=parseInt(t==="adversary"||t==="adversaries"?y.damageValue:"0")||0;let m=!1;return u===1&&g>=1&&(m=!0),u===2&&g>=r.thresholds.major&&(m=!0),u===3&&g>=r.thresholds.severe&&(m=!0),e.jsx("span",{style:{...B.damageDrop,color:m?"var(--red)":"var(--text-secondary)"},onClick:b=>{b.stopPropagation(),(t==="adversary"||t==="adversaries")&&(u===1?y.setDamageValue("1"):u===2?y.setDamageValue(r.thresholds.major.toString()):u===3&&y.setDamageValue(r.thresholds.severe.toString()))},title:`Click to set damage to ${u===1?"1":u===2?r.thresholds.major:r.thresholds.severe}`,children:e.jsx(ne,{size:16})},u)}),e.jsx("button",{style:{...B.applyButton,backgroundColor:"var(--gray-600)"},onClick:u=>{u.stopPropagation(),(t==="adversary"||t==="adversaries")&&(!y.damageValue||parseInt(y.damageValue)<1?(y.setShowDamageInput(!1),y.setDamageValue("")):y.applyDamage())},title:!y.damageValue||parseInt(y.damageValue)<1?"Close damage input":"Apply damage",children:!y.damageValue||parseInt(y.damageValue)<1?e.jsx(we,{size:16}):e.jsx(He,{size:16})})]})]})}),k=()=>{const g=(r.hp||0)>=(r.hpMax||1),m=p==="edit";return e.jsxs("div",{className:D(),style:{...N(!0),padding:0,minHeight:"400px",opacity:g?.7:1,backgroundColor:g?"var(--gray-900)":N(!0).backgroundColor,borderColor:g?"color-mix(in srgb, var(--gray-600) 40%, transparent)":j?"var(--purple)":S&&p!=="expanded"?"var(--border-hover)":"var(--border)",borderWidth:"2px",display:"flex",flexDirection:"column",position:"relative"},...s,...x,onClick:h,...p!=="expanded"&&{onMouseEnter:C,onMouseLeave:E},children:[g&&e.jsxs(e.Fragment,{children:[e.jsx("div",{style:{position:"absolute",top:0,left:0,right:0,bottom:0,background:`repeating-linear-gradient(
                45deg,
                transparent,
                transparent 8px,
                var(--gray-600) 1px,
                var(--gray-600) 9px
              )`,pointerEvents:"none",zIndex:9999}}),e.jsx("div",{style:{position:"absolute",top:"50%",left:"50%",transform:"translate(-50%, -50%)",color:"var(--text-secondary)",fontSize:"1rem",fontWeight:600,textTransform:"uppercase",letterSpacing:"0.05em",zIndex:1e4,pointerEvents:"none",textShadow:"1px 1px 2px rgba(0, 0, 0, 0.5)",backgroundColor:"var(--gray-900)",padding:"0.25rem 0.5rem",borderRadius:"0.5rem",border:"0.5px solid var(--gray-600)"},children:"DEFEATED"})]}),e.jsx("div",{className:"border-b",style:{padding:"12px",flexShrink:0,backgroundColor:"var(--bg-card)",borderRadius:"8px 8px 0 0",position:"relative",zIndex:g?1:"auto",borderBottomColor:j?"var(--purple)":"var(--border)"},children:e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"0.5rem",position:"relative",zIndex:g?1:"auto"},children:[e.jsx("div",{style:{display:"flex",flexDirection:"column",alignItems:"flex-start",gap:"0.25rem",flex:"1 1 0%",minWidth:0},children:e.jsx("h4",{style:{...B.rowTitle,color:g?"color-mix(in srgb, var(--gray-400) 80%, transparent)":B.rowTitle.color},children:$()})}),e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"0.5rem",flex:"0 0 auto",minWidth:"fit-content"},children:[e.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:"0.125rem",alignItems:"flex-end",padding:"0.25rem",margin:"-0.25rem"},children:[e.jsx(ee,{type:"adversaryHP",value:r.hp||0,maxValue:r.hpMax||1,onChange:b=>{const A=r.hp||0;b>A?l&&l(r.id,b-A,r.hp,r.hpMax):b<A&&o&&o(r.id,A-b,r.hp)},containerStyle:{cursor:"pointer",padding:"0.5rem 0.25rem 0.25rem 0.25rem",borderRadius:"0.125rem",transition:"all 0.2s ease"},pipStyle:{fontSize:"0.75rem"},showTooltip:!1,enableBoundaryClick:!0}),r.stressMax>0&&e.jsx(ee,{type:"adversaryStress",value:r.stress||0,maxValue:r.stressMax,onChange:b=>{const A=r.stress||0,R=b-A;a&&a(r.id,R,r.stress)},containerStyle:{cursor:"pointer",padding:"0.25rem 0.25rem 0.5rem 0.25rem",borderRadius:"0.125rem",transition:"all 0.2s ease"},pipStyle:{fontSize:"0.75rem"},showTooltip:!1,enableBoundaryClick:!0})]}),e.jsxs("div",{onClick:y.handleDifficultyClick,style:{display:"flex",flexDirection:"column",alignItems:"center",gap:"0.25rem",cursor:r.thresholds&&r.thresholds.major&&r.thresholds.severe||r.type==="Minion"?"pointer":"default",padding:"0.5rem",margin:"-0.5rem",borderRadius:"0.25rem",transition:"background-color 0.2s ease"},onMouseEnter:b=>{(r.thresholds&&r.thresholds.major&&r.thresholds.severe||r.type==="Minion")&&(b.target.style.backgroundColor="var(--gray-800)")},onMouseLeave:b=>{b.target.style.backgroundColor="transparent"},title:r.thresholds&&r.thresholds.major&&r.thresholds.severe?`Click to enter damage (thresholds: ${r.thresholds.major}/${r.thresholds.severe})`:r.type==="Minion"?"Click to enter damage (minion mechanics)":"",children:[r.type&&e.jsx("span",{style:{fontSize:"0.625rem",fontWeight:500,color:g?"color-mix(in srgb, var(--gray-400) 80%, transparent)":"var(--text-secondary)",letterSpacing:"0.5px",textAlign:"center",lineHeight:1,width:"50px",display:"block",paddingLeft:0},children:r.type}),r.difficulty&&e.jsxs("div",{style:{display:"flex",alignItems:"center",justifyContent:"center",position:"relative"},children:[e.jsx(re,{size:32,strokeWidth:1,style:{color:"var(--text-secondary)",transform:"rotate(30deg)"}}),e.jsx("span",{style:{position:"absolute",fontSize:"0.75rem",fontWeight:600,color:"white",pointerEvents:"none"},children:r.difficulty})]})]}),!1]})]})}),e.jsxs("div",{style:{flex:1,overflowY:"auto",padding:"12px",borderRadius:"0 0 8px 8px",position:"relative",zIndex:g?1:"auto"},children:[(r.tier||r.type)&&e.jsx("div",{style:{marginBottom:"1rem",paddingBottom:"0.75rem",borderBottom:"1px solid var(--border)"},children:e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"0.5rem"},children:[r.tier&&e.jsxs("span",{style:{fontSize:"0.875rem",fontWeight:500,color:g?"color-mix(in srgb, var(--gray-400) 80%, transparent)":"var(--text-secondary)",letterSpacing:"0.5px",padding:"0.25rem 0.5rem",backgroundColor:"var(--gray-800)",borderRadius:"0.25rem",border:"1px solid var(--border)"},children:["Tier ",r.tier]}),r.type&&e.jsx("span",{style:{fontSize:"0.875rem",fontWeight:500,color:g?"color-mix(in srgb, var(--gray-400) 80%, transparent)":"var(--text-secondary)",letterSpacing:"0.5px",padding:"0.25rem 0.5rem",backgroundColor:"var(--gray-800)",borderRadius:"0.25rem",border:"1px solid var(--border)"},children:r.type})]})}),r.description&&e.jsxs("div",{style:{marginBottom:"1rem",paddingBottom:"0.75rem",borderBottom:"1px solid var(--border)"},children:[e.jsx("h3",{style:{fontSize:"1rem",fontWeight:600,color:"var(--text-primary)",margin:"0 0 0.5rem 0"},children:"Description"}),m?e.jsx("textarea",{style:{width:"100%",minHeight:"100px",padding:"0.5rem",border:"1px solid var(--border)",borderRadius:"0.5rem",backgroundColor:"var(--bg-secondary)",color:"white",fontSize:"0.875rem",lineHeight:1.5,resize:"vertical",fontFamily:"inherit"},value:r.description,onChange:b=>{n&&n(r.id,{description:b.target.value})},placeholder:"Enter adversary description..."}):e.jsx("p",{style:{fontSize:"0.875rem",lineHeight:1.5,color:"var(--text-secondary)",margin:0,whiteSpace:"pre-wrap"},children:r.description})]}),r.motives&&e.jsxs("div",{style:{marginBottom:"1rem",paddingBottom:"0.75rem",borderBottom:"1px solid var(--border)"},children:[e.jsx("h3",{style:{fontSize:"1rem",fontWeight:600,color:"var(--text-primary)",margin:"0 0 0.5rem 0"},children:"Motives"}),m?e.jsx("textarea",{style:{width:"100%",minHeight:"80px",padding:"0.5rem",border:"1px solid var(--border)",borderRadius:"0.5rem",backgroundColor:"var(--bg-secondary)",color:"white",fontSize:"0.875rem",lineHeight:1.5,resize:"vertical",fontFamily:"inherit"},value:r.motives,onChange:b=>{n&&n(r.id,{motives:b.target.value})},placeholder:"Enter adversary motives..."}):e.jsx("p",{style:{fontSize:"0.875rem",lineHeight:1.5,color:"var(--text-secondary)",margin:0,whiteSpace:"pre-wrap"},children:r.motives})]}),e.jsx("div",{style:{marginBottom:"1rem",paddingBottom:"0.75rem",borderBottom:"1px solid var(--border)"},children:e.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:"0.5rem",fontSize:"0.875rem"},children:[e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"1rem",flexWrap:"wrap"},children:[e.jsxs("span",{children:[e.jsx("strong",{children:"Difficulty:"})," ",r.difficulty]}),r.thresholds&&e.jsxs("span",{children:[e.jsx("strong",{children:"Thresholds:"})," ",r.thresholds.major,"/",r.thresholds.severe]}),e.jsxs("span",{children:[e.jsx("strong",{children:"HP:"})," ",r.hpMax]}),r.stressMax>0&&e.jsxs("span",{children:[e.jsx("strong",{children:"Stress:"})," ",r.stressMax]})]}),(r.atk!==void 0||r.weapon||r.damage)&&e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"1rem",flexWrap:"wrap"},children:[r.atk!==void 0&&e.jsxs("span",{children:[e.jsx("strong",{children:"ATK:"})," ",r.atk>=0?"+":"",r.atk]}),r.weapon&&e.jsxs("span",{children:[e.jsxs("strong",{children:[r.weapon,":"]})," ",r.range||"Melee"]}),r.damage&&e.jsxs("span",{children:[e.jsx("strong",{children:"Damage:"})," ",r.damage]})]}),r.experience&&r.experience.length>0&&e.jsxs("div",{children:[e.jsx("strong",{children:"Experience:"})," ",r.experience.map(b=>typeof b=="string"?b:`${b.name} ${b.modifier>=0?"+":""}${b.modifier}`).join(", ")]})]})}),r.features&&r.features.length>0&&e.jsxs("div",{style:{marginBottom:"1rem"},children:[r.features.filter(b=>b.type==="Passive").length>0&&e.jsxs("div",{style:{marginBottom:"1rem"},children:[e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"0.75rem",marginBottom:"0.75rem"},children:[e.jsx("h4",{style:{fontSize:"0.875rem",fontWeight:600,color:"white",margin:0,textTransform:"uppercase",letterSpacing:"0.5px"},children:"Passives"}),e.jsx("hr",{style:{flex:1,border:"none",borderTop:"1px solid var(--border)",margin:0}})]}),e.jsx("div",{style:{display:"flex",flexDirection:"column",gap:"0.5rem"},children:r.features.filter(b=>b.type==="Passive").map((b,A)=>e.jsxs("div",{style:{fontSize:"0.875rem",lineHeight:1.4,color:"var(--text-secondary)"},children:[e.jsx("span",{style:{fontWeight:600,color:"var(--text-primary)"},children:b.name}),b.description&&e.jsxs(e.Fragment,{children:[e.jsx("span",{children:" - "}),e.jsx("span",{children:b.description})]})]},A))})]}),r.features.filter(b=>b.type==="Action").length>0&&e.jsxs("div",{style:{marginBottom:"1rem"},children:[e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"0.75rem",marginBottom:"0.75rem"},children:[e.jsx("h4",{style:{fontSize:"0.875rem",fontWeight:600,color:"white",margin:0,textTransform:"uppercase",letterSpacing:"0.5px"},children:"Actions"}),e.jsx("hr",{style:{flex:1,border:"none",borderTop:"1px solid var(--border)",margin:0}})]}),e.jsx("div",{style:{display:"flex",flexDirection:"column",gap:"0.5rem"},children:r.features.filter(b=>b.type==="Action").map((b,A)=>e.jsxs("div",{style:{fontSize:"0.875rem",lineHeight:1.4,color:"var(--text-secondary)"},children:[e.jsx("span",{style:{fontWeight:600,color:"var(--text-primary)"},children:b.name}),b.description&&e.jsxs(e.Fragment,{children:[e.jsx("span",{children:" - "}),e.jsx("span",{children:b.description})]})]},A))})]}),r.features.filter(b=>b.type==="Reaction").length>0&&e.jsxs("div",{style:{marginBottom:"1rem"},children:[e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"0.75rem",marginBottom:"0.75rem"},children:[e.jsx("h4",{style:{fontSize:"0.875rem",fontWeight:600,color:"white",margin:0,textTransform:"uppercase",letterSpacing:"0.5px"},children:"Reactions"}),e.jsx("hr",{style:{flex:1,border:"none",borderTop:"1px solid var(--border)",margin:0}})]}),e.jsx("div",{style:{display:"flex",flexDirection:"column",gap:"0.5rem"},children:r.features.filter(b=>b.type==="Reaction").map((b,A)=>e.jsxs("div",{style:{fontSize:"0.875rem",lineHeight:1.4,color:"var(--text-secondary)"},children:[e.jsx("span",{style:{fontWeight:600,color:"var(--text-primary)"},children:b.name}),b.description&&e.jsxs(e.Fragment,{children:[e.jsx("span",{children:" - "}),e.jsx("span",{children:b.description})]})]},A))})]})]})]}),z()]})},M=()=>{const g=p==="edit";return e.jsxs("div",{className:D(),style:{...N(!0),padding:0,minHeight:"400px",display:"flex",flexDirection:"column",position:"relative"},...s,...x,onClick:h,...p!=="expanded"&&{onMouseEnter:C,onMouseLeave:E},children:[e.jsx("div",{className:"border-b",style:{padding:"12px",flexShrink:0,backgroundColor:"var(--bg-card)",borderRadius:"8px 8px 0 0",position:"relative"},children:e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",gap:"0.5rem"},children:[e.jsxs("div",{style:{display:"flex",flexDirection:"column",alignItems:"flex-start",gap:"0.25rem"},children:[e.jsx("h2",{style:{fontSize:"1rem",fontWeight:600,color:"var(--text-primary)",margin:0},children:r.name}),e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"0.25rem"},children:[r.tier&&e.jsxs("span",{style:{fontSize:"0.75rem",fontWeight:500,color:"var(--text-secondary)",letterSpacing:"0.5px"},children:["Tier ",r.tier]}),r.type&&e.jsx("span",{style:{fontSize:"0.75rem",fontWeight:500,color:"var(--text-secondary)",letterSpacing:"0.5px"},children:r.type})]})]}),e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"0.5rem"},children:[r.difficulty&&e.jsxs("div",{style:{display:"flex",alignItems:"center",justifyContent:"center",position:"relative"},children:[e.jsx(re,{size:32,strokeWidth:1,style:{color:"var(--text-secondary)"}}),e.jsx("span",{style:{position:"absolute",top:"50%",left:"50%",transform:"translate(-50%, -50%)",fontSize:"0.75rem",fontWeight:700,color:"white",pointerEvents:"none"},children:r.difficulty})]}),!1]})]})}),e.jsxs("div",{style:{flex:1,overflowY:"auto",padding:"12px",borderRadius:"0 0 8px 8px"},children:[r.description&&e.jsxs("div",{style:{marginBottom:"1rem",paddingBottom:"0.75rem",borderBottom:"1px solid var(--border)"},children:[e.jsx("h3",{style:{fontSize:"1rem",fontWeight:600,color:"var(--text-primary)",margin:"0 0 0.5rem 0"},children:"Description"}),g?e.jsx("textarea",{style:{width:"100%",minHeight:"100px",padding:"0.5rem",border:"1px solid var(--border)",borderRadius:"0.5rem",backgroundColor:"var(--bg-secondary)",color:"white",fontSize:"0.875rem",lineHeight:1.5,resize:"vertical",fontFamily:"inherit"},value:r.description,onChange:m=>{n&&n(r.id,{description:m.target.value})},placeholder:"Enter environment description..."}):e.jsx("p",{style:{fontSize:"0.875rem",lineHeight:1.5,color:"var(--text-secondary)",margin:0,whiteSpace:"pre-wrap"},children:r.description})]}),r.impulses&&e.jsxs("div",{style:{marginBottom:"1rem",paddingBottom:"0.75rem",borderBottom:"1px solid var(--border)"},children:[e.jsx("h3",{style:{fontSize:"1rem",fontWeight:600,color:"var(--text-primary)",margin:"0 0 0.5rem 0"},children:"Impulses"}),e.jsx("p",{style:{fontSize:"0.875rem",lineHeight:1.5,color:"var(--text-secondary)",margin:0,whiteSpace:"pre-wrap"},children:r.impulses})]}),e.jsxs("div",{style:{marginBottom:"1rem",paddingBottom:"0.75rem",borderBottom:"1px solid var(--border)"},children:[e.jsx("h3",{style:{fontSize:"1rem",fontWeight:600,color:"var(--text-primary)",margin:"0 0 0.5rem 0"},children:"Core Stats"}),e.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:"0.5rem",fontSize:"0.875rem"},children:[e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"1rem",flexWrap:"wrap"},children:[e.jsxs("span",{children:[e.jsx("strong",{children:"Difficulty:"})," ",r.difficulty||"~"]}),e.jsxs("span",{children:[e.jsx("strong",{children:"Type:"})," ",r.type]}),e.jsxs("span",{children:[e.jsx("strong",{children:"Tier:"})," ",r.tier]})]}),r.potentialAdversaries&&r.potentialAdversaries.length>0&&e.jsxs("div",{children:[e.jsx("strong",{children:"Potential Adversaries:"}),e.jsx("div",{style:{marginTop:"0.25rem",display:"flex",flexDirection:"column",gap:"0.125rem"},children:r.potentialAdversaries.map((m,b)=>e.jsxs("div",{style:{fontSize:"0.75rem",color:"var(--text-secondary)",marginLeft:"0.5rem"},children:["• ",m]},b))})]})]})]}),r.features&&r.features.length>0&&e.jsxs("div",{style:{marginBottom:"1rem"},children:[r.features.filter(m=>m.type==="Passive").length>0&&e.jsxs("div",{style:{marginBottom:"1rem"},children:[e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"0.75rem",marginBottom:"0.75rem"},children:[e.jsx("h4",{style:{fontSize:"0.875rem",fontWeight:600,color:"white",margin:0,textTransform:"uppercase",letterSpacing:"0.5px"},children:"Passives"}),e.jsx("hr",{style:{flex:1,border:"none",borderTop:"1px solid var(--border)",margin:0}})]}),e.jsx("div",{style:{display:"flex",flexDirection:"column",gap:"0.75rem"},children:r.features.filter(m=>m.type==="Passive").map((m,b)=>e.jsxs("div",{style:{fontSize:"0.875rem",lineHeight:1.4,color:"var(--text-secondary)"},children:[e.jsx("div",{style:{fontWeight:600,color:"white",marginBottom:"0.25rem"},children:m.name}),e.jsx("div",{style:{marginBottom:"0.25rem"},children:m.description}),m.details&&m.details.length>0&&e.jsxs("div",{style:{marginLeft:"0.5rem"},children:[e.jsx("strong",{children:"Details:"}),e.jsx("ul",{style:{margin:"0.25rem 0 0 0",paddingLeft:"1rem",fontSize:"0.75rem"},children:m.details.map((A,R)=>e.jsx("li",{children:A},R))})]}),m.prompts&&m.prompts.length>0&&e.jsxs("div",{style:{marginLeft:"0.5rem"},children:[e.jsx("strong",{children:"Prompts:"}),e.jsx("ul",{style:{margin:"0.25rem 0 0 0",paddingLeft:"1rem",fontSize:"0.75rem"},children:m.prompts.map((A,R)=>e.jsxs("li",{style:{fontStyle:"italic"},children:['"',A,'"']},R))})]})]},b))})]}),r.features.filter(m=>m.type==="Action").length>0&&e.jsxs("div",{style:{marginBottom:"1rem"},children:[e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"0.75rem",marginBottom:"0.75rem"},children:[e.jsx("h4",{style:{fontSize:"0.875rem",fontWeight:600,color:"white",margin:0,textTransform:"uppercase",letterSpacing:"0.5px"},children:"Actions"}),e.jsx("hr",{style:{flex:1,border:"none",borderTop:"1px solid var(--border)",margin:0}})]}),e.jsx("div",{style:{display:"flex",flexDirection:"column",gap:"0.75rem"},children:r.features.filter(m=>m.type==="Action").map((m,b)=>e.jsxs("div",{style:{fontSize:"0.875rem",lineHeight:1.4,color:"var(--text-secondary)"},children:[e.jsx("div",{style:{fontWeight:600,color:"white",marginBottom:"0.25rem"},children:m.name}),e.jsx("div",{style:{marginBottom:"0.25rem"},children:m.description}),m.details&&m.details.length>0&&e.jsxs("div",{style:{marginLeft:"0.5rem"},children:[e.jsx("strong",{children:"Details:"}),e.jsx("ul",{style:{margin:"0.25rem 0 0 0",paddingLeft:"1rem",fontSize:"0.75rem"},children:m.details.map((A,R)=>e.jsx("li",{children:A},R))})]}),m.prompts&&m.prompts.length>0&&e.jsxs("div",{style:{marginLeft:"0.5rem"},children:[e.jsx("strong",{children:"Prompts:"}),e.jsx("ul",{style:{margin:"0.25rem 0 0 0",paddingLeft:"1rem",fontSize:"0.75rem"},children:m.prompts.map((A,R)=>e.jsxs("li",{style:{fontStyle:"italic"},children:['"',A,'"']},R))})]})]},b))})]}),r.features.filter(m=>m.type==="Reaction").length>0&&e.jsxs("div",{style:{marginBottom:"1rem"},children:[e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"0.75rem",marginBottom:"0.75rem"},children:[e.jsx("h4",{style:{fontSize:"0.875rem",fontWeight:600,color:"white",margin:0,textTransform:"uppercase",letterSpacing:"0.5px"},children:"Reactions"}),e.jsx("hr",{style:{flex:1,border:"none",borderTop:"1px solid var(--border)",margin:0}})]}),e.jsx("div",{style:{display:"flex",flexDirection:"column",gap:"0.75rem"},children:r.features.filter(m=>m.type==="Reaction").map((m,b)=>e.jsxs("div",{style:{fontSize:"0.875rem",lineHeight:1.4,color:"var(--text-secondary)"},children:[e.jsx("div",{style:{fontWeight:600,color:"white",marginBottom:"0.25rem"},children:m.name}),e.jsx("div",{style:{marginBottom:"0.25rem"},children:m.description}),m.details&&m.details.length>0&&e.jsxs("div",{style:{marginLeft:"0.5rem"},children:[e.jsx("strong",{children:"Details:"}),e.jsx("ul",{style:{margin:"0.25rem 0 0 0",paddingLeft:"1rem",fontSize:"0.75rem"},children:m.details.map((A,R)=>e.jsx("li",{children:A},R))})]}),m.prompts&&m.prompts.length>0&&e.jsxs("div",{style:{marginLeft:"0.5rem"},children:[e.jsx("strong",{children:"Prompts:"}),e.jsx("ul",{style:{margin:"0.25rem 0 0 0",paddingLeft:"1rem",fontSize:"0.75rem"},children:m.prompts.map((A,R)=>e.jsxs("li",{style:{fontStyle:"italic"},children:['"',A,'"']},R))})]})]},b))})]})]})]})]})};if((p==="expanded"||p==="edit")&&(t==="adversary"||t==="adversaries"))return k();if((p==="expanded"||p==="edit")&&(t==="environment"||t==="environments"))return M();if(p!=="compact"&&!(t==="adversary"||t==="adversaries"||t==="environment"||t==="environments"))return e.jsxs("div",{className:D(),style:N(!0),children:[e.jsxs("div",{style:B.rowMain,children:[e.jsx("h4",{style:B.rowTitle,children:$()}),e.jsx("div",{style:B.rowMeta,children:T()})]}),e.jsxs("p",{style:{color:"var(--text-secondary)",fontSize:"12px",margin:0},children:["Expanded view coming soon for ",t]})]});if(t==="adversary"||t==="adversaries"){const g=(r.hp||0)>=(r.hpMax||1);return e.jsxs("div",{className:D(),style:{...N(),opacity:g?.7:1,backgroundColor:g?"var(--gray-900)":N().backgroundColor,borderColor:g?"color-mix(in srgb, var(--gray-600) 40%, transparent)":j?"var(--purple)":S&&p!=="expanded"?"var(--border-hover)":"var(--border)",paddingLeft:"0.75rem",paddingTop:0,paddingBottom:0,position:"relative"},onClick:h,...p!=="expanded"&&{onMouseEnter:C,onMouseLeave:E},...s,...x,children:[g&&e.jsxs(e.Fragment,{children:[e.jsx("div",{style:{position:"absolute",top:0,left:0,right:0,bottom:0,background:`repeating-linear-gradient(
                45deg,
                transparent,
                transparent 8px,
                var(--gray-600) 1px,
                var(--gray-600) 9px
              )`,pointerEvents:"none",zIndex:9999}}),e.jsx("div",{style:{position:"absolute",top:"50%",left:"50%",transform:"translate(-50%, -50%)",color:"var(--text-secondary)",fontSize:"1rem",fontWeight:600,textTransform:"uppercase",letterSpacing:"0.05em",zIndex:1e4,pointerEvents:"none",textShadow:"1px 1px 2px rgba(0, 0, 0, 0.5)",backgroundColor:"var(--gray-900)",padding:"0.25rem 0.5rem",borderRadius:"0.5rem",border:"0.5px solid var(--gray-600)"},children:"DEFEATED"})]}),!1,e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"0.5rem",position:"relative",zIndex:g?1:"auto"},children:[e.jsx("div",{style:{display:"flex",flexDirection:"column",alignItems:"flex-start",gap:"0.25rem",flex:"1 1 0%",minWidth:0},children:e.jsx("h4",{style:{...B.rowTitle,color:g?"color-mix(in srgb, var(--gray-400) 80%, transparent)":B.rowTitle.color},children:$()})}),e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"0.25rem",flex:"0 0 auto",minWidth:"200px",justifyContent:"flex-end"},children:[e.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:"0.125rem",alignItems:"flex-end",padding:"0.25rem",margin:"-0.25rem"},children:[e.jsx(ee,{type:"adversaryHP",value:r.hp||0,maxValue:r.hpMax||1,onChange:m=>{const b=r.hp||0;m>b?l&&l(r.id,m-b,r.hp,r.hpMax):m<b&&o&&o(r.id,b-m,r.hp)},containerStyle:{cursor:"pointer",padding:"0.5rem 0.25rem 0.25rem 0.25rem",borderRadius:"0.125rem",transition:"all 0.2s ease"},pipStyle:{fontSize:"0.75rem"},showTooltip:!1,enableBoundaryClick:!0}),r.stressMax>0&&e.jsx(ee,{type:"adversaryStress",value:r.stress||0,maxValue:r.stressMax,onChange:m=>{const b=r.stress||0,A=m-b;a&&a(r.id,A,r.stress)},containerStyle:{cursor:"pointer",padding:"0.25rem 0.25rem 0.5rem 0.25rem",borderRadius:"0.125rem",transition:"all 0.2s ease"},pipStyle:{fontSize:"0.75rem"},showTooltip:!1,enableBoundaryClick:!0})]}),e.jsxs("div",{onClick:y.handleDifficultyClick,style:{display:"flex",flexDirection:"column",alignItems:"center",gap:"0.25rem",cursor:r.thresholds&&r.thresholds.major&&r.thresholds.severe||r.type==="Minion"?"pointer":"default",padding:"0.5rem",margin:"-0.5rem",borderRadius:"0.25rem",transition:"background-color 0.2s ease"},onMouseEnter:m=>{(r.thresholds&&r.thresholds.major&&r.thresholds.severe||r.type==="Minion")&&(m.target.style.backgroundColor="var(--gray-800)")},onMouseLeave:m=>{m.target.style.backgroundColor="transparent"},title:r.thresholds&&r.thresholds.major&&r.thresholds.severe?`Click to enter damage (thresholds: ${r.thresholds.major}/${r.thresholds.severe})`:r.type==="Minion"?"Click to enter damage (minion mechanics)":"",children:[r.type&&e.jsx("span",{style:{fontSize:"0.625rem",fontWeight:500,color:g?"color-mix(in srgb, var(--gray-400) 80%, transparent)":"var(--text-secondary)",letterSpacing:"0.5px",textAlign:"center",lineHeight:1,width:"50px",display:"block",paddingLeft:0},children:r.type}),r.difficulty&&e.jsxs("div",{style:{display:"flex",alignItems:"center",justifyContent:"center",position:"relative"},children:[e.jsx(re,{size:32,strokeWidth:1,style:{color:"var(--text-secondary)",transform:"rotate(30deg)"}}),e.jsx("span",{style:{position:"absolute",fontSize:"0.75rem",fontWeight:600,color:"white",pointerEvents:"none"},children:r.difficulty})]})]}),console.log("Delete button check:",{onDelete:!!d,isEditMode:w,shouldShow:d&&w}),d&&w&&e.jsx("button",{className:"border rounded-sm",style:{background:"var(--red)",borderColor:"var(--red)",padding:"0.25rem",minWidth:"1.5rem",height:"1.5rem",display:"flex",alignItems:"center",justifyContent:"center",cursor:"pointer",transition:"all 0.1s ease",color:"white",fontSize:"1rem"},onClick:m=>{m.stopPropagation(),m.preventDefault(),d&&d(r.id)},onMouseEnter:m=>m.target.style.background="var(--red-dark)",onMouseLeave:m=>m.target.style.background="var(--red)",title:"Delete item",children:"×"})]})]}),z()]})}return t==="environment"||t==="environments"?e.jsxs("div",{className:D(),style:{...N(),paddingLeft:"0.75rem",paddingTop:0,paddingBottom:0,position:"relative"},onClick:h,...p!=="expanded"&&{onMouseEnter:C,onMouseLeave:E},...s,...x,children:[!1,e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",gap:"0.5rem",position:"relative"},children:[e.jsxs("div",{style:{display:"flex",flexDirection:"column",alignItems:"flex-start",gap:"0.25rem"},children:[e.jsx("h4",{style:B.rowTitle,children:$()}),r.type&&e.jsx("span",{style:{fontSize:"0.75rem",fontWeight:500,color:"var(--text-secondary)",letterSpacing:"0.5px"},children:r.type})]}),e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"0.5rem"},children:[r.difficulty&&e.jsxs("div",{style:{display:"flex",alignItems:"center",justifyContent:"center",position:"relative"},children:[e.jsx(re,{size:32,strokeWidth:1,style:{color:"var(--text-secondary)"}}),e.jsx("span",{style:{position:"absolute",top:"50%",left:"50%",transform:"translate(-50%, -50%)",fontSize:"0.75rem",fontWeight:700,color:"white",pointerEvents:"none"},children:r.difficulty})]}),r.type&&e.jsx("div",{style:{display:"flex",flexDirection:"column",alignItems:"center",gap:"0.125rem"},children:e.jsx("span",{style:{fontSize:"0.625rem",fontWeight:500,color:isDead?"color-mix(in srgb, var(--gray-400) 80%, transparent)":"var(--text-secondary)",letterSpacing:"0.5px",textAlign:"center",lineHeight:1,width:"50px",display:"block",paddingLeft:0},children:r.type})}),console.log("Delete button check:",{onDelete:!!d,isEditMode:w,shouldShow:d&&w}),d&&w&&e.jsx("button",{className:"border rounded-sm",style:{background:"var(--red)",borderColor:"var(--red)",padding:"0.25rem",minWidth:"1.5rem",height:"1.5rem",display:"flex",alignItems:"center",justifyContent:"center",cursor:"pointer",transition:"all 0.1s ease",color:"white",fontSize:"1rem"},onClick:g=>{g.stopPropagation(),g.preventDefault(),d&&d(r.id)},onMouseEnter:g=>g.target.style.background="var(--red-dark)",onMouseLeave:g=>g.target.style.background="var(--red)",title:"Delete environment",children:"×"})]})]})]}):e.jsxs("div",{className:D(),style:N(),onClick:h,onMouseEnter:()=>I(!0),onMouseLeave:()=>I(!1),...s,...x,children:[e.jsxs("div",{style:B.rowMain,children:[e.jsx("h4",{style:B.rowTitle,children:$()}),e.jsx("div",{style:B.rowMeta,children:T()})]}),_(),e.jsxs("div",{style:B.cardActions,children:[e.jsx("div",{style:B.controlButtons,children:V()}),e.jsx("div",{style:{display:"flex",alignItems:"center"},children:!1})]}),z()]})},ke=v.createContext();function ae(r){if(typeof localStorage>"u")return null;try{const t=localStorage.getItem(r);return t==null?null:JSON.parse(t)}catch{return null}}function Ee(r,t){if(!(typeof localStorage>"u"))try{localStorage.setItem(r,JSON.stringify(t))}catch{}}const Ie=({children:r})=>{const[t,p]=v.useState({fear:{value:0,visible:!1},countdowns:[],adversaries:[],environments:[]});v.useEffect(()=>{var O,P,V;const L=ae("daggerheart-game-state");if(L)try{(((O=L.adversaries)==null?void 0:O.length)>0||((P=L.environments)==null?void 0:P.length)>0||((V=L.countdowns)==null?void 0:V.length)>0)&&p(L)}catch(_){console.error("Failed to load saved state:",_)}},[]),v.useEffect(()=>{Ee("daggerheart-game-state",t)},[t]);const h=L=>{p(O=>({...O,fear:{...O.fear,value:L}}))},d=()=>{p(L=>({...L,fear:{...L.fear,visible:!L.fear.visible}}))},l=v.useRef(t);v.useEffect(()=>{l.current=t},[t]);const o=()=>l.current,a=Je(p),n=Ke(o,p),i=Qe(o,p),{createCountdown:c,updateCountdown:s,deleteCountdown:x,advanceCountdown:f,incrementCountdown:j,decrementCountdown:w,reorderCountdowns:y}=a,{createAdversary:W,updateAdversary:S,deleteAdversary:I,reorderAdversaries:C}=n,{createEnvironment:E,updateEnvironment:N,deleteEnvironment:D,reorderEnvironments:$}=i,T={gameState:t,updateFear:h,toggleFearVisibility:d,createCountdown:c,updateCountdown:s,deleteCountdown:x,advanceCountdown:f,incrementCountdown:j,decrementCountdown:w,reorderCountdowns:y,createAdversary:W,updateAdversary:S,deleteAdversary:I,reorderAdversaries:C,createEnvironment:E,updateEnvironment:N,deleteEnvironment:D,reorderEnvironments:$};return e.jsx(ke.Provider,{value:T,children:r})},De=()=>{const r=v.useContext(ke);if(!r)return console.warn("useGameState: Context not available yet, returning defaults"),{fear:{value:0,visible:!1},countdowns:[],adversaries:[],environments:[],updateFear:()=>{},toggleFearVisibility:()=>{},createCountdown:()=>{},updateCountdown:()=>{},deleteCountdown:()=>{},advanceCountdown:()=>{},incrementCountdown:()=>{},decrementCountdown:()=>{},reorderCountdowns:()=>{},createAdversary:()=>{},updateAdversary:()=>{},deleteAdversary:()=>{},reorderAdversaries:()=>{},createEnvironment:()=>{},updateEnvironment:()=>{},deleteEnvironment:()=>{},reorderEnvironments:()=>{},hasCountdowns:!1,hasAdversaries:!1,hasEnvironments:!1,getCountdownById:()=>null,getAdversaryById:()=>null,getEnvironmentById:()=>null};const{gameState:t,...p}=r;if(!t)return console.warn("useGameState: gameState not available, returning defaults"),{fear:{value:0,visible:!1},countdowns:[],adversaries:[],environments:[],updateFear:()=>{},toggleFearVisibility:()=>{},createCountdown:()=>{},updateCountdown:()=>{},deleteCountdown:()=>{},advanceCountdown:()=>{},incrementCountdown:()=>{},decrementCountdown:()=>{},reorderCountdowns:()=>{},createAdversary:()=>{},updateAdversary:()=>{},deleteAdversary:()=>{},reorderAdversaries:()=>{},createEnvironment:()=>{},updateEnvironment:()=>{},deleteEnvironment:()=>{},reorderEnvironments:()=>{},hasCountdowns:!1,hasAdversaries:!1,hasEnvironments:!1,getCountdownById:()=>null,getAdversaryById:()=>null,getEnvironmentById:()=>null};const{fear:h,countdowns:d,adversaries:l,environments:o}=t;return{gameState:t,fear:h,countdowns:d,adversaries:l,environments:o,...p,hasCountdowns:d.length>0,hasAdversaries:l.length>0,hasEnvironments:o.length>0,getCountdownById:a=>d.find(n=>n.id===a),getAdversaryById:a=>l.find(n=>n.id===a),getEnvironmentById:a=>o.find(n=>n.id===a)}},sr=(r,t)=>{const[p,h]=v.useState(()=>{const d=ae(r);return d??t});return v.useEffect(()=>{const d=ae(r);h(d??t)},[r]),v.useEffect(()=>{Ee(r,p)},[r,p]),[p,h]},or="/Daggerheart/assets/daggerheart-logo-fe7815ad.svg",ar=({showFlyout:r,onFlyoutChange:t})=>{const[p,h]=v.useState(!1),[d,l]=v.useState(!1),o=r!==void 0?r:p,a=t||h;return v.useEffect(()=>{const n=i=>{i.target.closest(".help-button")||a(!1)};return document.addEventListener("click",n),()=>document.removeEventListener("click",n)},[a]),v.useEffect(()=>{const n=window.matchMedia("(max-width: 800px)"),i=c=>l(c.matches);return l(n.matches),n.addEventListener("change",i),()=>n.removeEventListener("change",i)},[]),e.jsxs("div",{className:"help-button",style:{position:"relative",display:"flex",alignItems:"center",justifyContent:"center",padding:"0.5rem",color:o?"white":"var(--text-primary)",borderRadius:"50%",cursor:"pointer",transition:"all 0.2s ease",minWidth:"44px",minHeight:"44px",backgroundColor:o?"var(--purple)":"transparent"},onMouseEnter:n=>{o||(n.currentTarget.style.backgroundColor="var(--bg-secondary)")},onMouseLeave:n=>{o||(n.currentTarget.style.backgroundColor="transparent")},onClick:n=>{n.stopPropagation(),a(!o)},title:"Help & Info",children:[e.jsx("div",{style:{width:"20px",height:"20px",display:"flex",alignItems:"center",justifyContent:"center",color:"inherit",backgroundColor:"transparent",border:"none",outline:"none"},children:e.jsx(Pe,{size:20})}),e.jsxs("div",{style:{position:"absolute",top:"50%",right:"100%",left:"auto",transform:"translateY(-50%)",background:"var(--bg-primary)",border:"1px solid var(--border)",borderRadius:"var(--radius-md)",boxShadow:"0 4px 12px rgba(0, 0, 0, 0.3)",zIndex:1e3,opacity:o?1:0,visibility:o?"visible":"hidden",transition:"opacity 0.2s ease, visibility 0.2s ease, transform 0.2s ease",pointerEvents:o?"auto":"none",minWidth:"280px",maxWidth:d?"calc(100vw - 2rem)":"320px",marginRight:"0.5rem"},children:[e.jsxs("div",{style:{padding:"0.75rem",borderTop:"1px solid rgba(255, 255, 255, 0.1)",borderBottom:"1px solid rgba(255, 255, 255, 0.1)",background:"var(--bg-primary)",maxWidth:"280px"},children:[e.jsx("img",{src:or,alt:"Daggerheart Community Content Logo",style:{width:"100%",maxWidth:"200px",height:"auto",margin:"0 auto 0.75rem auto",display:"block"},onError:n=>{console.error("Failed to load Daggerheart logo:",n.target.src),n.target.style.display="none";const i=document.createElement("div");i.style.cssText="text-align: center; margin-bottom: 0.75rem; font-size: 1.5rem; font-weight: bold; color: var(--purple);",i.textContent="⚔️ DAGGERHEART ⚔️",n.target.parentNode.insertBefore(i,n.target)},onLoad:()=>{}}),e.jsxs("div",{style:{fontSize:"0.7rem",lineHeight:1.3,color:"var(--text-secondary)",textAlign:"left",wordWrap:"break-word",overflowWrap:"break-word"},children:[e.jsx("p",{children:"This product includes materials from the Daggerheart System Reference Document 1.0, © Critical Role, LLC, under the terms of the Darrington Press Community Gaming (DPCGL) License."}),e.jsxs("p",{children:["More information can be found at ",e.jsx("a",{href:"https://www.daggerheart.com",target:"_blank",rel:"noopener noreferrer",children:"daggerheart.com"})]}),e.jsx("p",{children:e.jsx("em",{children:"This project is unofficial and not endorsed by Darrington Press or Critical Role."})})]})]}),e.jsx("button",{style:{display:"flex",alignItems:"center",justifyContent:"flex-start",padding:"0.25rem 1rem",color:"var(--text-primary)",border:"none",background:"none",width:"100%",textAlign:"left",cursor:"pointer",transition:"background-color 0.2s ease",fontSize:"0.875rem",minHeight:"32px",borderBottom:"1px solid rgba(255, 255, 255, 0.1)"},onMouseEnter:n=>{n.target.style.backgroundColor="var(--gray-dark)"},onMouseLeave:n=>{n.target.style.backgroundColor="transparent"},onClick:n=>{n.stopPropagation(),a(!1),window.open("https://github.com/Splinter714/Daggerheart","_blank")},children:e.jsx("div",{style:{display:"flex",alignItems:"center",justifyContent:"center",gap:"0.25rem"},children:e.jsx("span",{children:"GitHub"})})}),e.jsx("div",{style:{display:"flex",alignItems:"center",justifyContent:"flex-start",padding:"0.25rem 1rem",color:"var(--text-secondary)",border:"none",background:"none",width:"100%",textAlign:"left",cursor:"default",fontSize:"0.875rem",minHeight:"32px"},children:e.jsx("div",{style:{display:"flex",alignItems:"center",justifyContent:"center",gap:"0.25rem"},children:e.jsxs("span",{children:["Version ","0.2.50 (e9d763a)"]})})})]})]})},ir=({adversaries:r,environments:t,countdowns:p,deleteAdversary:h,deleteEnvironment:d,deleteCountdown:l,isClearMode:o,setIsClearMode:a,showFlyout:n,onFlyoutChange:i})=>{const[c,s]=v.useState(!1),x=n!==void 0?n:c,f=i||s,j=((r==null?void 0:r.length)||0)>0||((t==null?void 0:t.length)||0)>0||((p==null?void 0:p.length)||0)>0,w=(r||[]).some(C=>(C.hp||0)>=(C.hpMax||1));v.useEffect(()=>{const C=E=>{E.target.closest(".delete-clear-container")||(f(!1),o&&a(!1))};return document.addEventListener("click",C),()=>document.removeEventListener("click",C)},[o,f]),v.useEffect(()=>{o&&!j&&(a(!1),f(!1))},[o,j,a,f]);const y={position:"absolute",top:"50%",right:"100%",left:"auto",transform:"translateY(-50%)",backgroundColor:"var(--bg-secondary)",border:"1px solid var(--border)",borderRadius:"var(--radius-md)",padding:"0.5rem",minWidth:"200px",boxShadow:"0 4px 12px rgba(0, 0, 0, 0.3)",zIndex:1e3,display:x?"block":"none",marginRight:"0.5rem"},W={background:o||x?"var(--red)":"none",border:"none",color:o||x?"white":j?"var(--text-primary)":"var(--text-secondary)",cursor:j?"pointer":"not-allowed",padding:"0.5rem",borderRadius:"50%",display:"flex",alignItems:"center",justifyContent:"center",transition:"all 0.2s",opacity:j?1:.5,minWidth:"44px",minHeight:"44px"},S={background:"none",border:"none",color:"var(--text-primary)",cursor:"pointer",padding:"0.5rem",borderRadius:"var(--radius-sm)",width:"100%",textAlign:"left",display:"flex",alignItems:"center",gap:"0.5rem",transition:"background-color 0.2s"},I={backgroundColor:"var(--bg-hover)"};return e.jsxs("div",{className:"delete-clear-container",style:{position:"relative"},children:[e.jsx("button",{style:W,onClick:C=>{C.stopPropagation(),j&&(o?(a(!1),f(!1)):(a(!0),f(!0)))},title:j?o?"Clear Items":"Enter Clear Mode":"Nothing to clear",children:e.jsx(Fe,{size:20})}),e.jsxs("div",{style:y,children:[r&&r.length>0&&e.jsxs("button",{style:S,onMouseEnter:C=>Object.assign(C.target.style,I),onMouseLeave:C=>Object.assign(C.target.style,S),onClick:C=>{C.stopPropagation(),s(!1),r.forEach(E=>h(E.id))},children:[e.jsx("span",{children:"×"}),e.jsx("span",{children:"All Adversaries"})]}),r&&r.length>0&&w&&e.jsxs("button",{style:S,onMouseEnter:C=>Object.assign(C.target.style,I),onMouseLeave:C=>Object.assign(C.target.style,S),onClick:C=>{C.stopPropagation(),s(!1),r.filter(N=>(N.hp||0)>=(N.hpMax||1)).forEach(N=>h(N.id))},children:[e.jsx("span",{children:"×"}),e.jsx("span",{children:"Dead Adversaries"})]}),t&&t.length>0&&e.jsxs("button",{style:S,onMouseEnter:C=>Object.assign(C.target.style,I),onMouseLeave:C=>Object.assign(C.target.style,S),onClick:C=>{C.stopPropagation(),s(!1),t.forEach(E=>d(E.id))},children:[e.jsx("span",{children:"×"}),e.jsx("span",{children:"All Environments"})]}),p&&p.length>0&&e.jsxs("button",{style:S,onMouseEnter:C=>Object.assign(C.target.style,I),onMouseLeave:C=>Object.assign(C.target.style,S),onClick:C=>{C.stopPropagation(),s(!1),p.forEach(E=>l(E.id))},children:[e.jsx("span",{children:"×"}),e.jsx("span",{children:"All Countdowns"})]})]})]})},lr=({adversaries:r,onSortAdversaries:t})=>{const[p,h]=v.useState(!1),d=()=>{if(!r||r.length===0)return;h(!0);const o=[...r].sort((a,n)=>{const i={Leader:1,Bruiser:2,Horde:3,Ranged:4,Standard:5,Other:6,Minion:7},c=i[a.type]||6,s=i[n.type]||6;if(c!==s)return c-s;const x=a.name||"",f=n.name||"",j=W=>{const S=W.match(/^(.*)\s\((\d+)\)$/);return S?{base:S[1],num:parseInt(S[2])}:{base:W,num:0}},w=j(x),y=j(f);return w.base<y.base?-1:w.base>y.base?1:w.num-y.num});t(o),setTimeout(()=>{h(!1)},500)},l=r&&r.length>0;return e.jsx("button",{style:{width:"48px",height:"48px",borderRadius:"50%",background:p?"var(--purple)":"var(--bg-secondary)",border:"1px solid var(--border)",color:p?"white":"var(--text-primary)",display:"flex",alignItems:"center",justifyContent:"center",cursor:l?"pointer":"not-allowed",boxShadow:"0 2px 8px rgba(0, 0, 0, 0.2)",transition:"all 0.2s ease",position:"relative",pointerEvents:"auto",opacity:l?1:.5},onClick:d,disabled:!l,title:l?"Sort adversaries by type and name":"No adversaries to sort",children:e.jsx(Oe,{size:20})})},dr=({adversaries:r,environments:t,countdowns:p,deleteAdversary:h,deleteEnvironment:d,deleteCountdown:l,isClearMode:o,setIsClearMode:a,sortAdversaries:n})=>{const[i,c]=v.useState(!1),[s,x]=v.useState(!1),[f,j]=v.useState(!1);v.useEffect(()=>{const E=N=>{N.target.closest(".floating-menu-container")||(c(!1),x(!1),j(!1),o&&a(!1))};return document.addEventListener("click",E),()=>document.removeEventListener("click",E)},[o,a]),v.useEffect(()=>{i||(x(!1),j(!1),o&&a(!1))},[i,o,a]);const w=E=>{x(E),E&&(j(!1),o&&a(!1))},y=E=>{j(E),E&&x(!1)},S={position:"fixed",bottom:window.matchMedia("(display-mode: standalone)").matches||window.navigator.standalone===!0||document.referrer.includes("android-app://")?"calc(60px + env(safe-area-inset-bottom) + 2rem)":"calc(60px + env(safe-area-inset-bottom) + 1rem)",right:"1rem",zIndex:1100,display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center",pointerEvents:"none",width:"56px",height:"56px"},I={width:"56px",height:"56px",borderRadius:"50%",background:i?"var(--red)":"var(--bg-secondary)",border:"2px solid var(--border)",color:i?"white":"var(--text-primary)",display:"flex",alignItems:"center",justifyContent:"center",cursor:"pointer",boxShadow:"0 4px 12px rgba(0, 0, 0, 0.3)",transition:"all 0.3s ease",pointerEvents:"auto"},C=(E,N)=>{const D=180+E*90/(N-1),$=70,T=D*Math.PI/180,L=Math.cos(T)*$,O=Math.sin(T)*$;return{width:"48px",height:"48px",borderRadius:"50%",background:"var(--bg-secondary)",border:"1px solid var(--border)",color:"var(--text-primary)",display:"flex",alignItems:"center",justifyContent:"center",cursor:"pointer",boxShadow:"0 2px 8px rgba(0, 0, 0, 0.2)",transition:"all 0.3s ease",position:"absolute",pointerEvents:"auto",transform:i?`translate(${L}px, ${O}px)`:"translate(0px, 0px)",opacity:i?1:0,visibility:i?"visible":"hidden"}};return e.jsxs("div",{className:"floating-menu-container",style:S,children:[e.jsxs("div",{style:{position:"absolute",top:"0",left:"0",width:"56px",height:"56px",pointerEvents:"none"},children:[e.jsx("div",{style:C(0,3),children:e.jsx(ir,{adversaries:r,environments:t,countdowns:p,deleteAdversary:h,deleteEnvironment:d,deleteCountdown:l,isClearMode:o,setIsClearMode:a,showFlyout:f,onFlyoutChange:y})}),e.jsx("div",{style:C(1,3),children:e.jsx(lr,{adversaries:r,onSortAdversaries:n})}),e.jsx("div",{style:C(2,3),children:e.jsx(ar,{showFlyout:s,onFlyoutChange:w})})]}),e.jsx("button",{style:I,onClick:E=>{E.stopPropagation(),c(!i)},title:i?"Close Menu":"Open Menu",children:i?e.jsx(we,{size:24}):e.jsx($e,{size:24})})]})},cr=({position:r="top",children:t,onClick:p,className:h="",style:d={}})=>{const l=r==="top",o=window.matchMedia("(display-mode: standalone)").matches||window.navigator.standalone===!0||document.referrer.includes("android-app://"),a={background:"var(--bg-primary)",borderTop:l?"none":"1px solid var(--border)",borderBottom:l?"1px solid var(--border)":"none",padding:l?"0.25rem 0":"0.5rem",paddingBottom:l?"0.25rem":o?"calc(0.5rem + env(safe-area-inset-bottom) + 1rem)":"calc(0.5rem + env(safe-area-inset-bottom))",position:"sticky",[l?"top":"bottom"]:0,zIndex:l?10:100,order:l?1:3,flexShrink:0,touchAction:"manipulation",userSelect:"none",display:"flex",flexDirection:l?"column":"row",justifyContent:l?"stretch":"center",alignItems:l?"stretch":"center",gap:l?"0":"1rem",height:l?"auto":"60px",...d};return e.jsx("div",{className:h,style:a,onClick:p,children:t})},fe=({side:r="left",children:t,className:p="",style:h={}})=>{const d=r==="left",l={flex:1,minWidth:0,background:"var(--bg-primary)",overflowY:"auto",overflowX:d?"auto":"hidden",display:d?"block":"flex",flexDirection:d?"initial":"column",height:"100%",padding:d?"1rem 0 1rem 0":"1rem 1rem 1rem 0",...h};return e.jsx("div",{className:p,style:l,children:t})},pr=({items:r,onDelete:t,onEdit:p,onToggleVisibility:h,onReorder:d,onItemSelect:l,selectedItem:o,selectedType:a,onApplyDamage:n,onApplyHealing:i,onApplyStressChange:c,onIncrement:s,onDecrement:x,isEditMode:f,isClearMode:j,elementType:w,adversaries:y=[]})=>{if(!r||r.length===0)return null;const W=S=>{const I=o&&o.id===S.id&&a===w;console.log("Card selection check:",{itemId:S.id,selectedItemId:o==null?void 0:o.id,selectedType:a,elementType:w,isSelected:I});const C={item:S,mode:"compact",onClick:()=>l(S,w),onDelete:j?t:void 0,dragAttributes:f?{draggable:!0}:null,dragListeners:f?{onDragStart:E=>{E.dataTransfer.setData("text/plain",S.id)}}:null,adversaries:y,isSelected:I,isEditMode:f||j};switch(w){case"adversaries":return e.jsx(Q,{...C,type:"adversary",onApplyDamage:n,onApplyHealing:i,onApplyStressChange:c},S.id);case"environments":return e.jsx(Q,{...C,type:"environment",onEdit:p},S.id);case"countdowns":return e.jsx(Q,{...C,type:"countdown",onIncrement:s,onDecrement:x},S.id);default:return null}};return e.jsx("div",{style:{display:"flex",flexDirection:"column",gap:"8px"},children:r.map(W)})},ur=({onItemSelect:r,selectedItem:t,selectedType:p,onOpenDatabase:h,isEditMode:d,isClearMode:l,showLongTermCountdowns:o,fear:a,updateFear:n,handleRollOutcome:i,handleActionRoll:c,setShowLongTermCountdowns:s,lastAddedItemType:x})=>{console.log("GameBoard received props:",{selectedItem:t,selectedType:p});const{adversaries:f,environments:j,updateAdversary:w,deleteAdversary:y,reorderAdversaries:W,updateEnvironment:S,deleteEnvironment:I,reorderEnvironments:C,countdowns:E,createCountdown:N,deleteCountdown:D,reorderCountdowns:$,incrementCountdown:T,decrementCountdown:L}=De();v.useState({adversary:!1,environment:!1,campaign:!1});const[O,P]=sr("sectionVisibility",{countdowns:!1,environments:!1,adversaries:!1});v.useEffect(()=>{x&&(x==="environment"?P(z=>({...z,environments:!0})):x==="adversary"?P(z=>({...z,adversaries:!0})):x==="countdown"&&P(z=>({...z,countdowns:!0})))},[x,P]);const V=(z,k)=>{},_=(z,k)=>{k==="environment"?I(z):k==="adversary"?y(z):k==="countdown"&&D(z),t&&t.id===z&&r(null,null)};return e.jsx("div",{style:{flex:1,overflowY:"auto"},children:e.jsxs("div",{children:[e.jsx(pr,{items:f,onDelete:z=>_(z,"adversary"),onEdit:z=>V(),onToggleVisibility:z=>{const k=f.find(M=>M.id===z);k&&w(z,{isVisible:!k.isVisible})},onReorder:W,onItemSelect:r,selectedItem:t,selectedType:p,onApplyDamage:(z,k,M,u)=>{const g=Math.min(u,M+k);w(z,{hp:g})},onApplyHealing:(z,k,M)=>{if(f.find(g=>g.id===z)){const g=Math.max(0,M-k);w(z,{hp:g})}},onApplyStressChange:(z,k)=>{const M=f.find(u=>u.id===z);if(M){let u=M.stress+k,g=M.hp||0;if(u>M.stressMax){const m=u-M.stressMax;u=M.stressMax,g=Math.min(M.hpMax,g+m)}else u<0&&(u=0);w(z,{stress:u,hp:g})}},isEditMode:d,isClearMode:l,elementType:"adversaries",adversaries:f}),e.jsx("div",{className:"border rounded-lg",style:{backgroundColor:"var(--bg-card)",borderRadius:"8px",padding:"12px",marginTop:"0.5rem",cursor:"pointer",transition:"all 0.1s ease",position:"relative",border:"2px dashed var(--border)",opacity:.8,background:"var(--bg-card)"},onClick:()=>h("adversaries"),onMouseEnter:z=>{z.target.style.opacity="1",z.target.style.borderColor="var(--border-hover)"},onMouseLeave:z=>{z.target.style.opacity="0.8",z.target.style.borderColor="var(--border)"},children:e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",gap:"0.5rem",position:"relative"},children:[e.jsxs("div",{style:{display:"flex",flexDirection:"column",alignItems:"flex-start",gap:"0.25rem"},children:[e.jsx("h4",{style:{fontSize:"16px",fontWeight:"600",color:"var(--text-secondary)",margin:0},children:"Add Adversary"}),e.jsx("span",{style:{fontSize:"0.75rem",fontWeight:500,color:"var(--text-secondary)",letterSpacing:"0.5px"},children:"Click to browse"})]}),e.jsx("div",{style:{display:"flex",alignItems:"center",justifyContent:"center",width:"32px",height:"32px",borderRadius:"50%",border:"1px dashed var(--text-secondary)",color:"var(--text-secondary)"},children:e.jsx(se,{size:16})})]})})]})})};function hr({headerSelector:r=".drawer-header",closeThreshold:t=100,snapThreshold:p=30,onClose:h}={}){const[d,l]=v.useState(null),[o,a]=v.useState(null),[n,i]=v.useState(0),[c,s]=v.useState(!1),x=v.useCallback(y=>{var C,E;const W=y.target;if(!(r?W.closest(r):!1))return;const I=((E=(C=y.targetTouches)==null?void 0:C[0])==null?void 0:E.clientY)??0;l(I),a(I),i(0),s(!1)},[r]),f=v.useCallback(y=>{var C,E;if(d==null)return;const W=((E=(C=y.targetTouches)==null?void 0:C[0])==null?void 0:E.clientY)??0,S=W-d,I=6;!c&&Math.abs(S)>I&&s(!0),c&&(y.preventDefault(),y.stopPropagation(),a(W),i(Math.max(0,S)))},[d,c]),j=v.useCallback(y=>{if(d==null||o==null)return;const W=o-d;c?(y.preventDefault(),y.stopPropagation(),W>t?(i(window.innerHeight),typeof h=="function"&&setTimeout(()=>h(),300)):W>p?(i(0),setTimeout(()=>{l(null),a(null),s(!1)},50)):(i(0),l(null),a(null),s(!1))):(i(0),l(null),a(null),s(!1))},[d,o,c,t,p,h]),w=v.useCallback(()=>{i(0),l(null),a(null)},[]);return{drawerOffset:n,setDrawerOffset:i,touchHandlers:{onTouchStart:x,onTouchMove:f,onTouchEnd:j},resetSwipeState:w}}const xr=({isOpen:r,onClose:t,children:p})=>{const{drawerOffset:h,setDrawerOffset:d,touchHandlers:l,resetSwipeState:o}=hr({headerSelector:".drawer-header",closeThreshold:100,snapThreshold:30,onClose:t});return v.useEffect(()=>{r||o()},[r,o]),e.jsxs("div",{className:`mobile-drawer ${r?"open":""}`,children:[e.jsx("div",{className:"drawer-backdrop",onClick:t}),e.jsxs("div",{className:"drawer-content",style:{transform:r?`translateY(${h}px)`:"translateY(100%)",transition:h?"none":"transform 0.25s cubic-bezier(0.4, 0.0, 0.2, 1)"},onTouchStart:a=>{l.onTouchStart(a)},onTouchMove:a=>{l.onTouchMove(a)},onTouchEnd:a=>{l.onTouchEnd(a)},onClick:a=>{a.stopPropagation()},children:[e.jsx("div",{className:"drawer-header",onClick:()=>{d(window.innerHeight),setTimeout(()=>{t()},300)},children:e.jsx("div",{className:"drawer-handle"})}),e.jsx("div",{className:"drawer-body",children:p})]})]})},gr=()=>e.jsx("div",{className:"pwa-install-prompt",style:{}}),fr="modulepreload",mr=function(r){return"/Daggerheart/"+r},me={},ye=function(t,p,h){if(!p||p.length===0)return t();const d=document.getElementsByTagName("link");return Promise.all(p.map(l=>{if(l=mr(l),l in me)return;me[l]=!0;const o=l.endsWith(".css"),a=o?'[rel="stylesheet"]':"";if(!!h)for(let c=d.length-1;c>=0;c--){const s=d[c];if(s.href===l&&(!o||s.rel==="stylesheet"))return}else if(document.querySelector(`link[href="${l}"]${a}`))return;const i=document.createElement("link");if(i.rel=o?"stylesheet":fr,o||(i.as="script",i.crossOrigin=""),i.href=l,document.head.appendChild(i),o)return new Promise((c,s)=>{i.addEventListener("load",c),i.addEventListener("error",()=>s(new Error(`Unable to preload CSS for ${l}`)))})})).then(()=>t()).catch(l=>{const o=new Event("vite:preloadError",{cancelable:!0});if(o.payload=l,window.dispatchEvent(o),!o.defaultPrevented)throw l})};let Me={adversaries:[]},Ae={environments:[]};const yr=async()=>{try{const r=await ye(()=>import("./adversaries-e62ea4d8.js"),[]);Me=(r==null?void 0:r.default)||r}catch(r){console.warn("Failed to load adversaries.json:",r)}try{const r=await ye(()=>import("./environments-5ca1c1e1.js"),[]);Ae=(r==null?void 0:r.default)||r}catch(r){console.warn("Failed to load environments.json:",r)}},vr=r=>{const[t,p]=v.useState(""),[h,d]=v.useState([{field:"tier",direction:"asc"},{field:"name",direction:"asc"}]),[l,o]=v.useState(null),[a,n]=v.useState([]),[i,c]=v.useState(!0),[s,x]=v.useState([]),[f,j]=v.useState([]),[w,y]=v.useState(!1),[W,S]=v.useState(!1),I=v.useRef(null),C=v.useRef(null);v.useEffect(()=>{(async()=>{await yr(),c(!1);let M=[];r==="adversary"?M=Me.adversaries||[]:r==="environment"&&(M=Ae.environments||[]),n(M)})()},[r]);const E=k=>{const M=a.map(u=>u[k]).filter(Boolean);return[...new Set(M)].sort((u,g)=>typeof u=="number"&&typeof g=="number"?u-g:String(u).localeCompare(String(g)))},N=E("tier"),D=E("type"),$=v.useMemo(()=>{let k=a.filter(M=>{var b,A;const u=M.name.toLowerCase().includes(t.toLowerCase())||((b=M.type)==null?void 0:b.toLowerCase().includes(t.toLowerCase()))||((A=M.description)==null?void 0:A.toLowerCase().includes(t.toLowerCase())),g=s.length===0||s.includes(M.tier.toString()),m=f.length===0||f.includes(M.type);return u&&g&&m});return k.sort((M,u)=>{for(const g of h){const{field:m,direction:b}=g;let A=M[m],R=u[m];if(m==="tier")A=parseInt(A)||0,R=parseInt(R)||0;else if(m==="difficulty"){const X=parseInt(A),Y=parseInt(R);!isNaN(X)&&!isNaN(Y)?(A=X,R=Y):!isNaN(X)&&isNaN(Y)?(A=X,R=999):isNaN(X)&&!isNaN(Y)?(A=999,R=Y):(A=String(A||"").toLowerCase(),R=String(R||"").toLowerCase())}else typeof A=="string"&&typeof R=="string"?(A=A.toLowerCase(),R=R.toLowerCase()):(A=String(A||"").toLowerCase(),R=String(R||"").toLowerCase());if(b==="asc"){if(A>R)return 1;if(A<R)return-1}else{if(A<R)return 1;if(A>R)return-1}}return 0}),k},[a,t,h,s,f]),T=k=>{d(M=>{const u=M.findIndex(g=>g.field===k);if(u>=0)if(u===0){const g=[...M];return g[0]={...g[0],direction:g[0].direction==="asc"?"desc":"asc"},g}else{const g=[...M];return g.splice(u,1)[0],[{field:k,direction:"asc"},...g]}else return[{field:k,direction:"asc"},...M]})},L=k=>{o(l===k?null:k)},O=k=>{x(k==="clear"?[]:M=>M.includes(k)?M.filter(u=>u!==k):[...M,k])},P=k=>{j(k==="clear"?[]:M=>M.includes(k)?M.filter(u=>u!==k):[...M,k])},V=s.length>0,_=f.length>0;return v.useEffect(()=>{const k=u=>{const g=u.target.closest(".filter-dropdown"),m=u.target.closest(".header-filter-icon");g||m||(y(!1),S(!1))},M=u=>{u.key==="Escape"&&(y(!1),S(!1))};return document.addEventListener("pointerdown",k,!0),document.addEventListener("mousedown",k,!0),document.addEventListener("touchstart",k,!0),document.addEventListener("click",k,!0),document.addEventListener("keydown",M,!0),()=>{document.removeEventListener("pointerdown",k,!0),document.removeEventListener("mousedown",k,!0),document.removeEventListener("touchstart",k,!0),document.removeEventListener("click",k,!0),document.removeEventListener("keydown",M,!0)}},[y,S]),{searchTerm:t,setSearchTerm:p,sortFields:h,handleSort:T,expandedCard:l,toggleExpanded:L,filteredAndSortedData:$,loading:i,selectedTiers:s,selectedTypes:f,showTierDropdown:w,setShowTierDropdown:y,showTypeDropdown:W,setShowTypeDropdown:S,tierFilterRef:I,typeFilterRef:C,uniqueTiers:N,uniqueTypes:D,handleTierSelect:O,handleTypeSelect:P,isTierFiltered:V,isTypeFiltered:_,getDropdownStyle:k=>{if(!k.current)return{};const M=k.current.getBoundingClientRect();return{position:"fixed",top:M.bottom+4,left:M.left-100,zIndex:99999}}}},br=({searchTerm:r,onSearchChange:t,type:p})=>e.jsx("div",{style:H.browserHeader,children:e.jsx("input",{type:"text",placeholder:"Search",value:r,onChange:h=>t(h.target.value),style:H.searchInput})}),jr=({sortFields:r,onSort:t,type:p,uniqueTiers:h,uniqueTypes:d,selectedTiers:l,selectedTypes:o,showTierDropdown:a,setShowTierDropdown:n,showTypeDropdown:i,setShowTypeDropdown:c,tierFilterRef:s,typeFilterRef:x,handleTierSelect:f,handleTypeSelect:j,isTierFiltered:w,isTypeFiltered:y,getDropdownStyle:W})=>{const[S,I]=v.useState(null),E=(()=>p==="adversary"?[{key:"name",label:"Name"},{key:"tier",label:"Tier",hasFilter:!0},{key:"type",label:"Type",hasFilter:!0},{key:"difficulty",label:"Diff"},{key:"action",label:""}]:p==="environment"?[{key:"name",label:"Name"},{key:"tier",label:"Tier",hasFilter:!0},{key:"type",label:"Type",hasFilter:!0},{key:"difficulty",label:"Diff"},{key:"action",label:""}]:[])(),N=(D,$,T,L,O,P,V,_)=>{if(!O)return null;const z=()=>{(D==="tier"||D==="type")&&L("clear")};return be.createPortal(e.jsxs("div",{className:"filter-dropdown",style:{...H.filterDropdown,...W(V),maxHeight:"60vh",overflow:"auto"},onMouseDown:k=>k.stopPropagation(),onClick:k=>k.stopPropagation(),children:[e.jsxs("div",{style:{...H.filterOption,...T.length===0?H.filterOptionSelected:{}},onClick:z,children:[e.jsx("span",{style:H.checkIcon,children:T.length===0?e.jsx(ue,{size:16}):e.jsx(he,{size:16})}),e.jsx("span",{style:H.filterLabel,children:"All"})]}),$.map(k=>{const M=T.includes(k.toString());return e.jsxs("div",{style:{...H.filterOption,...M?H.filterOptionSelected:{}},onClick:()=>L(k.toString()),children:[e.jsx("span",{style:H.checkIcon,children:M?e.jsx(ue,{size:16}):e.jsx(he,{size:16})}),e.jsx("span",{style:H.filterLabel,children:k})]},k)})]}),document.body)};return e.jsx("tr",{style:H.tableHeader,children:E.map(D=>e.jsxs("th",{style:{...H.tableHeaderCell,...S===D.key?H.tableHeaderCellHover:{},position:"relative",...D.key==="name"?{width:"auto",minWidth:"0"}:{},...D.key==="tier"?{width:"80px",minWidth:"80px",maxWidth:"80px"}:{},...D.key==="type"?{width:"100px",minWidth:"100px",maxWidth:"100px"}:{},...D.key==="difficulty"?{width:"40px",minWidth:"40px",maxWidth:"40px"}:{},...D.key==="action"?{width:"40px",minWidth:"40px",maxWidth:"40px"}:{}},onClick:()=>t(D.key),onMouseEnter:()=>I(D.key),onMouseLeave:()=>I(null),children:[D.hasFilter?e.jsxs("div",{style:H.headerWithFilter,children:[e.jsx("span",{style:{cursor:"pointer"},onClick:$=>{$.stopPropagation(),t(D.key)},children:D.label}),e.jsxs("button",{ref:D.key==="tier"?s:x,style:{...H.headerFilterIcon,...D.key==="tier"&&w?H.headerFilterIconActive:{},...D.key==="type"&&y?H.headerFilterIconActive:{}},className:"header-filter-icon",onClick:$=>{$.stopPropagation(),D.key==="tier"?(n(!a),c(!1)):D.key==="type"&&(c(!i),n(!1))},children:[e.jsx(Ve,{size:14}),D.key==="tier"&&w||D.key==="type"&&y?e.jsx("span",{style:H.filterActiveDot}):null]})]}):D.label,D.key==="tier"&&N("tier",h,l,f,a,n,s),D.key==="type"&&N("type",d,o,j,i,c,x)]},D.key))})},wr=({item:r,isExpanded:t,onToggleExpanded:p,onAdd:h,type:d})=>{const[l,o]=v.useState(!1),a=()=>{h(r)},n=()=>d==="adversary"?e.jsxs(e.Fragment,{children:[e.jsx("td",{style:{...H.rowCell,width:"auto",minWidth:"0",textAlign:"left"},children:r.name}),e.jsx("td",{style:{...H.rowCell,width:"80px",minWidth:"80px",maxWidth:"80px",textAlign:"center"},children:r.tier}),e.jsx("td",{style:{...H.rowCell,width:"100px",minWidth:"100px",maxWidth:"100px",textAlign:"center"},children:r.type}),e.jsx("td",{style:{...H.rowCell,width:"40px",minWidth:"40px",maxWidth:"40px",textAlign:"center"},children:r.difficulty})]}):d==="environment"?e.jsxs(e.Fragment,{children:[e.jsx("td",{style:{...H.rowCell,width:"auto",minWidth:"0",textAlign:"left"},children:r.name}),e.jsx("td",{style:{...H.rowCell,width:"80px",minWidth:"80px",maxWidth:"80px",textAlign:"center"},children:r.tier}),e.jsx("td",{style:{...H.rowCell,width:"100px",minWidth:"100px",maxWidth:"100px",textAlign:"center"},children:r.type}),e.jsx("td",{style:{...H.rowCell,width:"40px",minWidth:"40px",maxWidth:"40px",textAlign:"center"},children:r.difficulty})]}):null;return e.jsxs(e.Fragment,{children:[e.jsxs("tr",{style:{...H.row,...l?H.rowHover:{}},onClick:()=>p(r.id),onMouseEnter:()=>o(!0),onMouseLeave:()=>o(!1),children:[n(),e.jsx("td",{style:{width:"40px",minWidth:"40px",maxWidth:"40px",textAlign:"center",padding:"0",margin:"0",border:"none",verticalAlign:"middle",boxSizing:"border-box",overflow:"visible",textOverflow:"unset",whiteSpace:"nowrap"},children:e.jsx("button",{style:H.addButton,onClick:i=>{i.stopPropagation(),a()},onMouseEnter:i=>{i.target.style.background="var(--bg-secondary)"},onMouseLeave:i=>{i.target.style.background="var(--purple)"},children:"+"})})]}),t&&e.jsx("tr",{style:H.expandedRow,children:e.jsx("td",{colSpan:"5",style:H.expandedContent,children:e.jsx(Q,{item:r,type:d,mode:"expanded",onClick:()=>{},onDelete:()=>{}})})})]})},ve=({type:r,onAddItem:t,onCancel:p})=>{const{searchTerm:h,setSearchTerm:d,sortFields:l,handleSort:o,expandedCard:a,toggleExpanded:n,filteredAndSortedData:i,loading:c,selectedTiers:s,selectedTypes:x,showTierDropdown:f,setShowTierDropdown:j,showTypeDropdown:w,setShowTypeDropdown:y,tierFilterRef:W,typeFilterRef:S,uniqueTiers:I,uniqueTypes:C,handleTierSelect:E,handleTypeSelect:N,isTierFiltered:D,isTypeFiltered:$,getDropdownStyle:T}=vr(r);return c?e.jsx("div",{style:H.browser,children:e.jsx("div",{style:H.loading,children:"Loading..."})}):e.jsxs("div",{style:H.browserWrapper,children:[e.jsx(br,{searchTerm:h,onSearchChange:d,type:r}),e.jsx("div",{className:"browser-content",style:H.browserContent,children:e.jsxs("table",{style:H.browserTable,children:[e.jsx("thead",{children:e.jsx(jr,{sortFields:l,onSort:o,type:r,uniqueTiers:I,uniqueTypes:C,selectedTiers:s,selectedTypes:x,showTierDropdown:f,setShowTierDropdown:j,showTypeDropdown:w,setShowTypeDropdown:y,tierFilterRef:W,typeFilterRef:S,handleTierSelect:E,handleTypeSelect:N,isTierFiltered:D,isTypeFiltered:$,getDropdownStyle:T})}),e.jsx("tbody",{children:i.map(L=>e.jsx(wr,{item:L,isExpanded:a===L.id,onToggleExpanded:n,onAdd:t,type:r},L.id))})]})})]})},H={browserWrapper:{display:"flex",flexDirection:"column",background:"var(--bg-primary)",borderRadius:"var(--radius-md)",border:"1px solid var(--border)",overflow:"hidden",height:"100%",width:"100%",position:"relative"},browserContent:{flex:1,overflowY:"auto",overflowX:"visible",padding:0,width:"100%"},tableHeaderContainer:{flexShrink:0,position:"sticky",top:0,zIndex:15,backgroundColor:"var(--bg-secondary)"},browserTable:{width:"100%",minWidth:"100%",borderCollapse:"collapse",tableLayout:"fixed",background:"var(--bg-primary)",margin:0},browserHeader:{display:"flex",justifyContent:"space-between",alignItems:"center",padding:"16px",borderBottom:"1px solid var(--border)",backgroundColor:"var(--gray-900)",flexShrink:0,position:"sticky",top:0,zIndex:20},browserTitle:{margin:0,color:"var(--text-primary)",fontSize:"18px",fontWeight:"600"},closeButton:{background:"none",border:"none",color:"var(--text-primary)",fontSize:"24px",cursor:"pointer",padding:"4px 8px",borderRadius:"4px",transition:"background-color 0.2s"},searchInput:{flex:1,padding:"8px 12px",border:"1px solid var(--border)",borderRadius:"4px",backgroundColor:"var(--bg-primary)",color:"var(--text-primary)",fontSize:"14px",marginRight:"12px",transition:"all 0.2s ease"},searchInputFocus:{outline:"none",borderColor:"var(--purple)",boxShadow:"0 0 0 3px rgba(139, 92, 246, 0.1)"},tableHeader:{background:"var(--gray-900)",borderBottom:"1px solid var(--border)",boxShadow:"0 1px 0 var(--border)",position:"sticky",top:"0",zIndex:10},tableHeaderCell:{backgroundColor:"var(--gray-900)",fontWeight:"700",borderBottom:"1px solid var(--border)",cursor:"pointer",userSelect:"none",minWidth:"100px",whiteSpace:"nowrap",padding:"4px 4px",color:"var(--text-primary)",textShadow:"0 1px 2px rgba(0, 0, 0, 0.3)",boxShadow:"0 1px 0 var(--border)",transition:"background-color 0.2s",position:"sticky",top:"0",zIndex:10},tableHeaderCellHover:{backgroundColor:"var(--bg-hover)"},sortIndicator:{fontSize:"12px",color:"var(--text-secondary)"},tableBody:{flex:1,overflowY:"auto",padding:"8px",backgroundColor:"var(--bg-primary)"},row:{height:"35px",borderBottom:"1px solid var(--border)",transition:"background-color 0.2s ease",cursor:"pointer",backgroundColor:"var(--gray-900)"},rowHover:{backgroundColor:"var(--bg-secondary)"},expandedRow:{backgroundColor:"var(--bg-secondary)"},rowCell:{padding:"4px 4px",verticalAlign:"middle",color:"var(--text-primary)",whiteSpace:"nowrap",overflow:"hidden",textOverflow:"ellipsis",borderBottom:"1px solid var(--border)"},rowCellName:{fontWeight:"500",minWidth:"150px"},rowCellCenter:{textAlign:"center",justifyContent:"center",minWidth:"80px"},rowActions:{width:"80px",textAlign:"center",padding:"4px 8px",borderBottom:"1px solid var(--border)"},addButton:{width:"2rem",height:"2rem",border:"1px solid var(--purple)",borderRadius:"var(--radius-sm)",background:"var(--purple)",color:"white",cursor:"pointer",transition:"all 0.2s ease",display:"inline-flex",alignItems:"center",justifyContent:"center",fontSize:"16px",fontWeight:"500"},expandedContent:{padding:"0",backgroundColor:"var(--bg-secondary)",borderBottom:"1px solid var(--border)"},columnName:{width:"auto",minWidth:"0",overflow:"hidden",textOverflow:"ellipsis",paddingLeft:"8px",textAlign:"left"},columnTier:{width:"80px",textAlign:"center",overflow:"visible",textOverflow:"unset"},columnType:{width:"100px",overflow:"hidden",textOverflow:"ellipsis",textAlign:"center"},columnDifficulty:{width:"40px",textAlign:"center",overflow:"visible",textOverflow:"unset"},columnAction:{width:"32px",minWidth:"24px",maxWidth:"24px",textAlign:"center",padding:"0",margin:"0",border:"none",verticalAlign:"middle",color:"var(--text-primary)",whiteSpace:"nowrap",overflow:"visible",textOverflow:"unset"},loading:{display:"flex",justifyContent:"center",alignItems:"center",height:"200px",color:"var(--text-primary)",fontSize:"16px"},mobileBrowser:{width:"95vw",height:"90vh",maxWidth:"none"},mobileSearchInput:{fontSize:"16px"},headerWithFilter:{display:"flex",alignItems:"center",justifyContent:"center",gap:"4px",position:"relative"},headerFilterIcon:{background:"none",border:"none",color:"var(--text-secondary)",cursor:"pointer",padding:"2px 4px",borderRadius:"var(--radius-sm)",display:"flex",alignItems:"center",justifyContent:"center",transition:"all 0.2s ease",position:"relative"},headerFilterIconActive:{color:"var(--purple)"},filterIcon:{fontSize:"12px"},filterActiveDot:{position:"absolute",left:"50%",top:"2px",transform:"translateX(-50%)",width:"4px",height:"4px",borderRadius:"50%",background:"var(--purple)",pointerEvents:"none"},filterDropdown:{position:"absolute",top:"100%",left:"0",background:"var(--bg-secondary)",border:"1px solid var(--border)",borderRadius:"var(--radius-md)",boxShadow:"0 8px 24px rgba(0, 0, 0, 0.25)",zIndex:99999,marginTop:"4px",overflow:"hidden",width:"max-content",minWidth:"120px",maxWidth:"200px"},filterOption:{padding:"8px 12px",cursor:"pointer",color:"var(--text-primary)",fontSize:"14px",display:"flex",alignItems:"center",gap:"8px",borderBottom:"1px solid rgba(255,255,255,0.06)",transition:"background-color 0.2s ease",whiteSpace:"nowrap",overflow:"hidden",textOverflow:"ellipsis"},filterOptionSelected:{backgroundColor:"var(--bg-hover)"},checkIcon:{width:"16px",height:"16px",display:"inline-flex",alignItems:"center",justifyContent:"center",color:"var(--text-secondary)",fontSize:"12px"},filterLabel:{flex:1}};function Cr({selectedItem:r,selectedType:t,countdowns:p,adversaries:h,environments:d,setSelectedItem:l,handleCloseRightColumn:o}){v.useEffect(()=>{if(!r||!t)return;let a=!1;t==="adversaries"||t==="adversary"?a=h.some(n=>n.id===r.id):t==="environments"||t==="environment"?a=d.some(n=>n.id===r.id):(t==="countdowns"||t==="countdown")&&(a=p.some(n=>n.id===r.id)),a||o()},[r,t,p,h,d,l,o]),v.useEffect(()=>{if(!r||!t)return;let a=null;t==="adversaries"||t==="adversary"?a=h.find(n=>n.id===r.id):t==="environments"||t==="environment"?a=d.find(n=>n.id===r.id):(t==="countdowns"||t==="countdown")&&(a=p.find(n=>n.id===r.id)),a&&JSON.stringify(a)!==JSON.stringify(r)&&l(a)},[r,t,p,h,d,l])}class Sr extends ie.Component{constructor(t){super(t),this.state={hasError:!1,error:null}}static getDerivedStateFromError(t){return{hasError:!0,error:t}}componentDidCatch(t,p){console.error("ErrorBoundary caught an error:",t,p)}render(){var t;return this.state.hasError?e.jsxs("div",{className:"p-md text-red",children:[e.jsx("h3",{children:"Something went wrong:"}),e.jsx("pre",{children:(t=this.state.error)==null?void 0:t.toString()}),e.jsx("button",{className:"btn-base btn-text",onClick:()=>this.setState({hasError:!1,error:null}),children:"Try again"})]}):this.props.children}}const kr=()=>{const{adversaries:r,environments:t,countdowns:p,fear:h,updateFear:d,createAdversary:l,updateAdversary:o,deleteAdversary:a,reorderAdversaries:n,createEnvironment:i,updateEnvironment:c,deleteEnvironment:s,createCountdown:x,deleteCountdown:f,advanceCountdown:j}=De(),[w,y]=v.useState(null),[W,S]=v.useState(null),[I,C]=v.useState(null),[E,N]=v.useState("unified"),[D,$]=v.useState(!1),[T,L]=v.useState(!1),[O,P]=v.useState(!1),[V]=v.useState("left"),[_,z]=v.useState(!0);v.useState(!1);const[k,M]=v.useState(null),[u,g]=v.useState(!1),m=(F,q)=>{v.startTransition(()=>{w&&w.id===F.id&&W===q&&I==="item"?(y(null),S(null),C(null),D&&g(!1)):(y(F),S(q),C("item"),D&&g(!0))})},b=(F="unified")=>{let q=F;F==="adversaries"?q="adversary":F==="environments"&&(q="environment"),I==="database"&&E===q?v.startTransition(()=>{C(null),N("unified"),D&&g(!1)}):v.startTransition(()=>{N(q),C("database"),D&&g(!0)})},A=F=>{p.forEach(q=>{const U=Ze(q,F);if(U>0){const K=q.value||0;j(q.id,K+U)}})},R=()=>{p.forEach(F=>{const q=er(F);if(q>0){const U=F.value||0;j(F.id,U+q)}})},X=v.useCallback(()=>{C(null),y(null),S(null),D&&g(!1)},[D]);v.useEffect(()=>{const F=()=>{const K=D,G=window.matchMedia("(max-width: 800px)").matches;$(G),!K&&G&&(I==="database"||I==="creator"||I==="item")&&g(!0),K&&!G&&u&&g(!1)};F();const q=window.matchMedia("(max-width: 800px)"),U=()=>F();return q.addEventListener("change",U),()=>q.removeEventListener("change",U)},[D,I,u]),v.useEffect(()=>(u||D&&w?(document.body.classList.add("mobile-drawer-open"),document.documentElement.classList.add("mobile-drawer-open")):(document.body.classList.remove("mobile-drawer-open"),document.documentElement.classList.remove("mobile-drawer-open")),()=>{document.body.classList.remove("mobile-drawer-open"),document.documentElement.classList.remove("mobile-drawer-open")}),[D,u,w]),Cr({selectedItem:w,selectedType:W,countdowns:p,adversaries:r,environments:t,setSelectedItem:y,handleCloseRightColumn:X});const{handleAdversaryDamage:Y,handleAdversaryHealing:de,handleAdversaryStressChange:ce}=rr({adversaries:r,updateAdversary:o,deleteAdversary:a,selectedItem:w,setSelectedItem:y}),We=v.useCallback(F=>{const q={};F.forEach((J,G)=>{q[J.id]=G});const U=[...r],K=[];F.forEach(J=>{const G=U.find(Z=>Z.id===J.id);G&&K.push(G)}),K.forEach((J,G)=>{const Z=U.findIndex(ze=>ze.id===J.id);Z!==G&&Z!==-1&&n([Z,G])})},[r,n]);return e.jsxs("div",{className:"app",onClick:F=>{F.target===F.currentTarget&&X()},children:[e.jsx(cr,{position:"bottom",children:e.jsx(ee,{type:"fear",value:(h==null?void 0:h.value)||0,maxValue:12,onChange:d,showTooltip:!1,enableBoundaryClick:!0,clickContainerWidth:"100%",centerPips:!0})}),e.jsx(dr,{adversaries:r,environments:t,countdowns:p,deleteAdversary:a,deleteEnvironment:s,deleteCountdown:f,isClearMode:O,setIsClearMode:P,sortAdversaries:We}),e.jsxs("div",{className:"main-content",children:[e.jsx(fe,{side:"left",className:`${D&&V==="right"?"mobile-hidden":""}`,children:e.jsx(ur,{onItemSelect:m,selectedItem:w,selectedType:W,onOpenDatabase:b,isEditMode:T,onEditModeChange:L,isClearMode:O,showLongTermCountdowns:_,fear:h,updateFear:d,handleRollOutcome:A,handleActionRoll:R,setShowLongTermCountdowns:z,lastAddedItemType:k})}),e.jsxs(fe,{side:"right",className:`${D&&V==="left"?"mobile-hidden":""}`,style:I==="database"?{overflowY:"hidden"}:{},children:[I==="database"&&e.jsx("div",{className:"database-display",children:e.jsx(ve,{type:E,onAddItem:F=>{E==="adversary"?(l(F),M("adversary")):E==="environment"&&(i(F),M("environment"))},onCancel:X})}),I==="item"&&w&&e.jsx(Q,{type:W,item:w,mode:T?"edit":"expanded",onApplyDamage:Y,onApplyHealing:de,onApplyStressChange:ce,onUpdate:W==="adversaries"?o:W==="environments"?c:updateCountdown,adversaries:r}),!I&&e.jsx("div",{})]})]},`mobile-${D}`),D&&e.jsxs(xr,{isOpen:u,onClose:X,children:[I==="database"&&e.jsx("div",{className:"browser-container",children:e.jsx(ve,{type:E,onAddItem:F=>{E==="adversary"?(l(F),M("adversary")):E==="environment"&&(i(F),M("environment"))},onCancel:X})}),I==="item"&&w&&e.jsx("div",{className:"expanded-content",children:e.jsx(Q,{type:W,item:w,mode:T?"edit":"expanded",onApplyDamage:Y,onApplyHealing:de,onApplyStressChange:ce,onUpdate:W==="adversaries"?o:W==="environments"?c:updateCountdown,adversaries:r})})]}),e.jsx(gr,{})]})},Er=()=>e.jsx(Sr,{children:e.jsx(Ie,{children:e.jsx(kr,{})})});oe.createRoot(document.getElementById("root")).render(e.jsx(ie.StrictMode,{children:e.jsx(Ie,{children:e.jsx(Er,{})})}));
