import{r as j,a as fe,R as oe}from"./dndkit-57209f9c.js";import{F as Ee,f as Ie,a as Me,b as De,c as ae}from"./fa-b4bcccb0.js";import{D as re,A as me,H as J,C as ze,M as We,P as Q,a as Ae,T as Re,b as Le,F as Te,S as ie,c as le,d as Be,e as He,f as Ne,E as Pe,g as Fe}from"./lucide-77e708aa.js";(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const n of document.querySelectorAll('link[rel="modulepreload"]'))p(n);new MutationObserver(n=>{for(const a of n)if(a.type==="childList")for(const o of a.addedNodes)o.tagName==="LINK"&&o.rel==="modulepreload"&&p(o)}).observe(document,{childList:!0,subtree:!0});function i(n){const a={};return n.integrity&&(a.integrity=n.integrity),n.referrerPolicy&&(a.referrerPolicy=n.referrerPolicy),n.crossOrigin==="use-credentials"?a.credentials="include":n.crossOrigin==="anonymous"?a.credentials="omit":a.credentials="same-origin",a}function p(n){if(n.ep)return;n.ep=!0;const a=i(n);fetch(n.href,a)}})();var ye={exports:{}},Z={};/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Oe=j,$e=Symbol.for("react.element"),Ve=Symbol.for("react.fragment"),_e=Object.prototype.hasOwnProperty,Xe=Oe.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,qe={key:!0,ref:!0,__self:!0,__source:!0};function ve(r,t,i){var p,n={},a=null,o=null;i!==void 0&&(a=""+i),t.key!==void 0&&(a=""+t.key),t.ref!==void 0&&(o=t.ref);for(p in t)_e.call(t,p)&&!qe.hasOwnProperty(p)&&(n[p]=t[p]);if(r&&r.defaultProps)for(p in t=r.defaultProps,t)n[p]===void 0&&(n[p]=t[p]);return{$$typeof:$e,type:r,key:a,ref:o,props:n,_owner:Xe.current}}Z.Fragment=Ve;Z.jsx=ve;Z.jsxs=ve;ye.exports=Z;var e=ye.exports,te={},de=fe;te.createRoot=de.createRoot,te.hydrateRoot=de.hydrateRoot;const ce={fear:{icon:Ie,maxValue:12,containerStyle:{display:"flex",gap:"0.125rem",alignItems:"center",justifyContent:"center",width:"100%",height:"100%",padding:"0.125rem",maxWidth:"none"},pipStyle:{fontSize:"var(--text-lg)",fontWeight:600,transition:"color 0.3s ease",height:"1.5rem",width:"1.5rem",display:"inline-block",textAlign:"center",lineHeight:"1.5rem",flexShrink:0,imageRendering:"crisp-edges"},filledColor:"var(--purple)",emptyColor:"var(--gray-dark)",tooltipTitle:"Click anywhere in header to adjust fear:",tooltipInstructions:[{text:"Left of boundary:",description:"Click to decrease fear by 1"},{text:"Right of boundary:",description:"Click to increase fear by 1"}]},hp:{icon:Me,maxValue:20,containerStyle:{display:"inline-block",width:"auto",height:"100%",padding:"0.125rem",textAlign:"center"},pipStyle:{fontSize:"var(--text-sm)",fontWeight:600,transition:"color 0.3s ease",height:"1.5rem",width:"1.5rem",display:"inline-block",textAlign:"center",lineHeight:"1.5rem",flexShrink:0},filledColor:"var(--red)",emptyColor:"var(--text-secondary)",tooltipTitle:"Click anywhere to adjust HP:",tooltipInstructions:[{text:"Left of boundary:",description:"Click to decrease HP by 1"},{text:"Right of boundary:",description:"Click to increase HP by 1"}]},stress:{icon:De,maxValue:12,containerStyle:{display:"inline-block",width:"auto",height:"100%",padding:"0.125rem",textAlign:"center"},pipStyle:{fontSize:"var(--text-sm)",fontWeight:600,transition:"color 0.3s ease",height:"1.5rem",width:"1.5rem",display:"inline-block",textAlign:"center",lineHeight:"1.5rem",flexShrink:0},filledColor:"var(--gold)",emptyColor:"var(--text-secondary)",tooltipTitle:"Click anywhere to adjust stress:",tooltipInstructions:[{text:"Left of boundary:",description:"Click to decrease stress by 1"},{text:"Right of boundary:",description:"Click to increase stress by 1"}]},countdown:{icon:ae,maxValue:6,containerStyle:{display:"inline-block",width:"auto",height:"100%",padding:"0.125rem",textAlign:"center"},pipStyle:{fontSize:"var(--text-sm)",fontWeight:600,transition:"color 0.3s ease",height:"1.5rem",width:"1.5rem",display:"inline-block",textAlign:"center",lineHeight:"1.5rem",flexShrink:0},filledColor:"var(--text-secondary)",emptyColor:"var(--text-secondary)",tooltipTitle:"Click anywhere to adjust countdown:",tooltipInstructions:[{text:"Left of boundary:",description:"Click to decrease countdown by 1"},{text:"Right of boundary:",description:"Click to increase countdown by 1"}]},hpDots:{maxValue:20,containerStyle:{display:"flex",flexWrap:"wrap",gap:"1px",justifyContent:"center",alignItems:"center",maxWidth:"120px"},pipStyle:{width:"8px",height:"8px",borderRadius:"50%",border:"1px solid var(--border)",transition:"background-color 0.5s ease, border-color 0.5s ease, box-shadow 0.5s ease"},filledStyle:{background:"var(--red)",borderColor:"var(--red)",boxShadow:"0 0 4px rgba(239, 68, 68, 0.5)"},emptyStyle:{background:"var(--bg-primary)",borderColor:"var(--border)"},isDots:!0,tooltipTitle:"Click anywhere to adjust HP:",tooltipInstructions:[{text:"Left of boundary:",description:"Click to decrease HP by 1"},{text:"Right of boundary:",description:"Click to increase HP by 1"}]},stressDots:{maxValue:12,containerStyle:{display:"flex",flexWrap:"wrap",gap:"1px",justifyContent:"center",alignItems:"center",maxWidth:"120px"},pipStyle:{width:"8px",height:"8px",borderRadius:"50%",border:"1px solid var(--border)",transition:"background-color 0.5s ease, border-color 0.5s ease, box-shadow 0.5s ease"},filledStyle:{background:"var(--purple)",borderColor:"var(--purple)",boxShadow:"0 0 4px rgba(139, 92, 246, 0.5)"},emptyStyle:{background:"var(--bg-primary)",borderColor:"var(--border)"},isDots:!0,tooltipTitle:"Click anywhere to adjust stress:",tooltipInstructions:[{text:"Left of boundary:",description:"Click to decrease stress by 1"},{text:"Right of boundary:",description:"Click to increase stress by 1"}]},adversaryHP:{icon:re,maxValue:20,containerStyle:{display:"flex",gap:"0px",flexWrap:"wrap",alignContent:"flex-start",rowGap:"0.03125rem",maxWidth:"100%"},pipStyle:{fontSize:"var(--text-sm)",fontWeight:600,transition:"color 0.3s ease",cursor:"pointer",width:"1rem",height:"1rem",display:"flex",alignItems:"center",justifyContent:"center",flexShrink:0},filledColor:"var(--red)",emptyColor:"var(--gray-400)",tooltipTitle:"Click to adjust HP:",tooltipInstructions:[{text:"Filled pip:",description:"Click to heal (reduce damage)"},{text:"Empty pip:",description:"Click to take damage"}]},adversaryStress:{icon:me,maxValue:12,containerStyle:{display:"flex",gap:"0px",flexWrap:"wrap",alignContent:"flex-start",rowGap:"0.03125rem",maxWidth:"100%"},pipStyle:{fontSize:"var(--text-sm)",fontWeight:600,transition:"color 0.3s ease",cursor:"pointer",width:"1rem",height:"1rem",display:"flex",alignItems:"center",justifyContent:"center",flexShrink:0},filledColor:"var(--gold)",emptyColor:"var(--gray-400)",tooltipTitle:"Click to adjust stress:",tooltipInstructions:[{text:"Filled pip:",description:"Click to reduce stress"},{text:"Empty pip:",description:"Click to increase stress"}]},countdownDistributed:{icon:ae,maxValue:6,containerStyle:{display:"inline-block",width:"auto",height:"100%",padding:"0.125rem",textAlign:"center"},pipStyle:{fontSize:"var(--text-sm)",fontWeight:600,transition:"color 0.3s ease",height:"1.5rem",width:"1.5rem",display:"inline-block",textAlign:"center",lineHeight:"1.5rem",flexShrink:0},filledColor:"var(--text-secondary)",emptyColor:"var(--text-secondary)",tooltipTitle:"Countdown progress:",tooltipInstructions:[{text:"Progress:",description:"Current countdown value"}]}},K=({type:r="fear",value:t=0,maxValue:i,onChange:p,size:n="lg",showTooltip:a=!0,containerStyle:o={},pipStyle:c={},countdownType:d=null,distributedGroups:h=null,onPipClick:u=null,enableBoundaryClick:s=!1,clickContainerWidth:g="auto",centerPips:m=!0})=>{const[l,w]=j.useState(!1),f=ce[r]||ce.fear,k=i||f.maxValue,S=Math.max(0,Math.min(k,t));let I=f.filledColor;r==="countdown"&&d&&(["progress","dynamic-progress","simple-hope"].includes(d)?I="var(--gold)":["consequence","dynamic-consequence","simple-fear"].includes(d)?I="var(--purple)":["long-term","standard"].includes(d)&&(I="var(--text-secondary)"));const W=(A,R)=>{if(u)u(A,R);else if(p){const O=A+1;p(O)}},N=A=>{if(!s||!p||u)return;A.currentTarget.getBoundingClientRect();const R=A.currentTarget.querySelector(".pip-container");if(!R)return;const O=R.getBoundingClientRect(),V=A.clientX-O.left;if(V<0){S>0&&p(S-1);return}if(V>O.width){S<k&&p(S+1);return}const _=O.width,D=_*.05,F=_-2*D,C=V-D,M=S/k,x=F*M;C<x?S>0&&p(S-1):S<k&&p(S+1)},z=(()=>{if(!h||r!=="countdownDistributed")return[{start:0,end:k,groupIndex:0}];let A=0;return h.map((R,O)=>{const V={start:A,end:A+R,groupIndex:O};return A+=R,V})})(),$=()=>e.jsxs(e.Fragment,{children:[z.map(A=>e.jsx(oe.Fragment,{children:[...Array(A.end-A.start)].map((R,O)=>{const V=A.start+O,_=V<S;if(f.isDots)return e.jsx("div",{style:{...f.pipStyle,..._?f.filledStyle:f.emptyStyle,...c,cursor:p||u?"pointer":"default"},onClick:s?void 0:()=>W(V,_),title:`${V+1} of ${k}`},V);{const D=f.icon,F=D&&typeof D=="object"&&D.iconName,C=_?I:f.emptyColor;return e.jsx("span",{className:`fear-pip ${_?"filled":"empty"}`,style:{...f.pipStyle,color:C,cursor:p||u?"pointer":"default",...c},onClick:s?void 0:()=>W(V,_),title:`${V+1} of ${k}`,children:F?e.jsx(Ee,{icon:D,size:n}):e.jsx(D,{size:16})},V)}})},A.groupIndex)),a&&e.jsx("div",{style:{position:"relative",cursor:"help",pointerEvents:"none"},children:e.jsxs("div",{style:{position:"absolute",bottom:"100%",left:"50%",transform:l?"translateX(-50%) translateY(-5px)":"translateX(-50%)",background:"rgba(15, 23, 42, 0.95)",border:"1px solid var(--gray)",borderRadius:"var(--radius-md)",padding:"var(--space-md)",minWidth:"250px",zIndex:1e3,opacity:l?1:0,visibility:l?"visible":"hidden",transition:"all 0.2s ease",boxShadow:"0 10px 25px rgba(0, 0, 0, 0.5)"},children:[e.jsx("div",{style:{fontWeight:600,color:"var(--gray-200)",marginBottom:"0.75rem",fontSize:"var(--text-sm)"},children:f.tooltipTitle}),f.tooltipInstructions.map((A,R)=>e.jsxs("div",{style:{marginBottom:"0.5rem",fontSize:"0.8rem",color:"var(--gray-300)",lineHeight:1.4},children:[e.jsx("strong",{style:{color:"var(--gray-200)"},children:A.text})," ",A.description]},R))]})})]});return e.jsx("div",{style:{width:g,height:"100%",cursor:p||u?"pointer":"default",touchAction:"manipulation",userSelect:"none",display:m?"flex":"block",alignItems:m?"center":"stretch",justifyContent:m?"center":"flex-start",...o},onClick:A=>{A.stopPropagation(),A.preventDefault(),s&&N(A)},onMouseEnter:()=>w(a),onMouseLeave:()=>w(!1),children:e.jsx("div",{className:"pip-container",style:{...f.containerStyle,width:"auto",height:"100%",padding:"0.125rem",textAlign:"center"},children:$()})})};function se(r){const t=typeof crypto<"u"&&crypto.randomUUID?crypto.randomUUID():`${Date.now()}-${Math.random().toString(36).slice(2,10)}`;return r?`${r}-${t}`:t}const Ye=(r,t)=>({createAdversary:o=>{const c=se("adv"),d=r().adversaries||[],h=o.name||"Unknown",u=d.filter(m=>m.baseName===h);let s=1;if(u.length===0)s=1;else{const m=u.map(w=>w.duplicateNumber||1);let l=1;for(;m.includes(l);)l++;s=l}const g={...o,id:c,baseName:h,duplicateNumber:s,name:`${h} (${s})`,hp:0,stress:0,isVisible:!0};t(m=>({...m,adversaries:[...m.adversaries,g]}))},updateAdversary:(o,c)=>{t(d=>({...d,adversaries:d.adversaries.map(h=>{if(h.id===o){const u={...h,...c};if(c.baseName!==void 0){const s=c.baseName,g=u.duplicateNumber||1;u.name=g===1?s:`${s} (${g})`}return u}return h})}))},deleteAdversary:o=>{t(c=>({...c,adversaries:c.adversaries.filter(d=>d.id!==o)}))},reorderAdversaries:o=>{t(c=>{const[d,h]=o,u=[...c.adversaries],[s]=u.splice(d,1);return u.splice(h,0,s),{...c,adversaries:u}})}}),Ge=r=>({createCountdown:d=>{const h={id:se("countdown"),name:d.name||"Countdown",max:parseInt(d.max)||1,value:0,visible:!0,type:d.type||"standard",loop:d.loop||"none",source:d.source||"campaign"};r(u=>({...u,countdowns:[...u.countdowns,h]}))},updateCountdown:(d,h)=>{r(u=>({...u,countdowns:u.countdowns.map(s=>s.id===d?{...s,...h}:s)}))},deleteCountdown:d=>{r(h=>({...h,countdowns:h.countdowns.filter(u=>u.id!==d)}))},advanceCountdown:(d,h)=>{r(u=>({...u,countdowns:u.countdowns.map(s=>{if(s.id!==d)return s;let g=h;if(s.loop==="loop")g>s.max?g=(g-1)%s.max+1:g<0&&(g=s.max);else if(s.loop==="increasing"){if(g>s.max)return{...s,max:s.max+1,value:1};if(g<0)return{...s,max:Math.max(1,s.max-1),value:1};g=Math.max(0,g)}else if(s.loop==="decreasing"){if(g>s.max)return{...s,max:Math.max(1,s.max-1),value:1};if(g<0)return{...s,max:s.max+1,value:1};g=Math.min(s.max,g)}else g=Math.max(0,Math.min(g,s.max));return{...s,value:g}})}))},incrementCountdown:(d,h=1)=>{r(u=>({...u,countdowns:u.countdowns.map(s=>{if(s.id!==d)return s;let g=s.value+h;if(s.loop==="loop")g>s.max&&(g=(g-1)%s.max+1);else if(s.loop==="increasing"){if(g>s.max)return{...s,max:s.max+1,value:1}}else if(s.loop==="decreasing"){if(g>s.max)return{...s,max:Math.max(1,s.max-1),value:1}}else g=Math.min(g,s.max);return{...s,value:g}})}))},decrementCountdown:d=>{r(h=>({...h,countdowns:h.countdowns.map(u=>{if(u.id!==d)return u;let s=u.value-1;if(u.loop==="loop")s<0&&(s=u.max);else if(u.loop==="increasing"){if(s<0)return{...u,max:Math.max(1,u.max-1),value:u.max};s=Math.max(0,s)}else if(u.loop==="decreasing"){if(s<0)return{...u,max:u.max+1,value:1}}else s=Math.max(0,s);return{...u,value:s}})}))},reorderCountdowns:d=>{r(h=>{const[u,s]=d,g=[...h.countdowns],[m]=g.splice(u,1);return g.splice(s,0,m),{...h,countdowns:g}})}}),Ke=(r,t)=>({createEnvironment:o=>{const c=se("env"),h=(r().environments||[]).filter(g=>g.name.replace(/\s+\(\d+\)$/,"")===o.name);let u=o.name||"Unknown";if(h.length===0)u=o.name;else if(h.length===1){const g=h[0],m=g.name.replace(/\s+\(\d+\)$/,""),l=r().environments.map(w=>w.id===g.id?{...w,name:`${m} (1)`}:w);t(w=>({...w,environments:l})),u=`${o.name} (2)`}else{const g=h.map(l=>{const w=l.name.match(/\((\d+)\)$/);return w?parseInt(w[1]):null}).filter(l=>l!==null);let m=1;for(;g.includes(m);)m++;u=`${o.name} (${m})`}const s={...o,id:c,name:u,isVisible:!0};t(g=>({...g,environments:[...g.environments,s]}))},updateEnvironment:(o,c)=>{t(d=>({...d,environments:d.environments.map(h=>h.id===o?{...h,...c}:h)}))},deleteEnvironment:o=>{t(c=>({...c,environments:c.environments.filter(d=>d.id!==o)}))},reorderEnvironments:o=>{t(c=>{const[d,h]=o,u=[...c.environments],[s]=u.splice(d,1);return u.splice(h,0,s),{...c,environments:u}})}});function Ue(r,t){const i=(r==null?void 0:r.type)||"standard";if(i==="standard")return 1;if(i==="progress"||i==="dynamic-progress")switch(t){case"success-hope":return 2;case"success-fear":return 1;case"critical-success":return 3;default:return 0}if(i==="consequence"||i==="dynamic-consequence")switch(t){case"success-fear":return 1;case"failure-hope":return 2;case"failure-fear":return 3;default:return 0}return i==="simple-fear"?t==="simple-fear"||t==="success-fear"||t==="failure-fear"?1:0:i==="simple-hope"&&(t==="simple-hope"||t==="success-hope"||t==="failure-hope"||t==="critical-success")?1:0}function Je(r){return((r==null?void 0:r.type)||"standard")==="standard"?1:0}function Qe({adversaries:r,updateAdversary:t,deleteAdversary:i,selectedItem:p,setSelectedItem:n}){const a=j.useCallback((d,h,u,s)=>{var k,S;const g=r.find(I=>I.id===d);if(!g)return;const m=g.type==="Minion",l=(k=g.features)==null?void 0:k.find(I=>{var W;return(W=I.name)==null?void 0:W.startsWith("Minion (")}),w=l?parseInt(((S=l.name.match(/\((\d+)\)/))==null?void 0:S[1])||"1"):1;if(m){i(d);const I=Math.floor(h/w);if(I>0){const W=r.filter(N=>N.type==="Minion"&&N.id!==d&&N.name===g.name);for(let N=0;N<Math.min(I,W.length);N++)i(W[N].id)}return}const f=Math.min(u+h,s);p&&p.id===d&&n(I=>({...I,hp:f})),t(d,{hp:f})},[r,t,i,p,n]),o=j.useCallback((d,h,u)=>{const s=Math.max(0,u-h);p&&p.id===d&&n(g=>({...g,hp:s})),t(d,{hp:s})},[t,p,n]),c=j.useCallback((d,h,u,s)=>{const g=r.find(w=>w.id===d);if(!g)return;let m=u+h,l=g.hp||0;if(m>s){const w=m-s;m=s,l=Math.min(g.hpMax||0,l+w)}m=Math.max(0,m),p&&p.id===d&&n(w=>({...w,stress:m,hp:l})),t(d,{stress:m,hp:l})},[r,t,p,n]);return{handleAdversaryDamage:a,handleAdversaryHealing:o,handleAdversaryStressChange:c}}const B={transitions:{hoverIn:"all 0.1s ease",hoverOut:"all 0.3s ease",colorIn:"color 0.1s ease",colorOut:"color 0.3s ease",backgroundIn:"background-color 0.1s ease",backgroundOut:"background-color 0.3s ease"},card:{backgroundColor:"var(--bg-card)",borderRadius:"8px",padding:"12px",cursor:"pointer",transition:"all 0.1s ease",position:"relative"},cardHover:{backgroundColor:"var(--bg-card-hover)"},cardDead:{opacity:.6,backgroundColor:"var(--gray-800)",borderColor:"var(--border)"},cardAtMax:{backgroundColor:"var(--success)",borderColor:"var(--success)"},rowMain:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:"8px"},rowTitle:{fontSize:"16px",fontWeight:"600",color:"var(--text-primary)",margin:0},rowMeta:{display:"flex",gap:"8px",alignItems:"center"},cardActions:{display:"flex",justifyContent:"space-between",alignItems:"center",gap:"12px"},controlButtons:{display:"flex",gap:"8px",alignItems:"center"},pipSymbols:{display:"flex",gap:"4px",alignItems:"center",cursor:"pointer",padding:"2px"},pipSymbol:{fontSize:"16px",transition:"color 0.1s ease"},pipGroup:{display:"flex",gap:"4px",marginBottom:"4px"},badge:{padding:"2px 6px",borderRadius:"3px",fontSize:"10px",fontWeight:"600",textTransform:"uppercase"},typeBadge:{backgroundColor:"var(--purple)",color:"var(--text-primary)"},difficultyBadge:{backgroundColor:"var(--gray-500)",color:"var(--text-primary)",cursor:"pointer",transition:"background-color 0.1s ease"},tierBadge:{backgroundColor:"var(--info)",color:"var(--text-primary)"},inputBase:{padding:"8px",borderColor:"var(--gray-500)",backgroundColor:"var(--gray-900)",color:"var(--text-primary)",fontSize:"14px",transition:"all 0.2s ease"},inputBaseFocus:{outline:"none",borderColor:"var(--purple)",boxShadow:"0 0 0 2px rgba(79, 70, 229, 0.1)"},inputBaseDisabled:{opacity:.6,cursor:"not-allowed"},button:{backgroundColor:"var(--danger)",color:"var(--text-primary)",borderWidth:"0",borderStyle:"none",borderRadius:"4px",padding:"4px 8px",fontSize:"14px",cursor:"pointer",transition:"background-color 0.1s ease"},incrementButton:{backgroundColor:"var(--success)",color:"var(--text-primary)",borderWidth:"0",borderStyle:"none",borderRadius:"4px",padding:"4px 8px",fontSize:"14px",cursor:"pointer",transition:"background-color 0.1s ease"},decrementButton:{backgroundColor:"var(--warning)",color:"var(--text-primary)",borderWidth:"0",borderStyle:"none",borderRadius:"4px",padding:"4px 8px",fontSize:"14px",cursor:"pointer",transition:"background-color 0.1s ease"},damageInputPopup:{position:"absolute",top:0,left:0,right:0,bottom:0,backgroundColor:"rgba(0, 0, 0, 0.8)",display:"flex",alignItems:"center",justifyContent:"center",zIndex:1e3,borderRadius:"8px"},damageInputContent:{backgroundColor:"var(--gray-900)",borderWidth:"1px",borderStyle:"solid",borderColor:"var(--border)",borderRadius:"8px",padding:"16px",display:"flex",flexDirection:"column",gap:"12px",minWidth:"200px"},damageInput:{backgroundColor:"var(--gray-900)",borderWidth:"1px",borderStyle:"solid",borderColor:"var(--border)",borderRadius:"4px",padding:"8px",color:"var(--text-primary)",fontSize:"14px"},damageIndicators:{display:"flex",gap:"8px",alignItems:"center",justifyContent:"center"},damageDrop:{fontSize:"16px",color:"var(--text-secondary)",cursor:"pointer",transition:"color 0.1s ease"},applyButton:{backgroundColor:"var(--success)",color:"var(--text-primary)",borderWidth:"0",borderStyle:"none",borderRadius:"4px",padding:"4px 8px",fontSize:"14px",cursor:"pointer",transition:"background-color 0.1s ease"}},Ze=(r,t,i,p)=>{const[n,a]=j.useState(!1),[o,c]=j.useState(""),d=m=>{m.stopPropagation(),m.preventDefault();const l=r.hp||0,w=r.hpMax||1,f=m.currentTarget.getBoundingClientRect(),k=m.clientX-f.left,S=f.width/w;Math.floor(k/S)<l?i&&i(r.id,1,r.hp):t&&t(r.id,1,r.hp,r.hpMax)},h=m=>{m.stopPropagation(),m.preventDefault();const l=r.stress||0,w=r.stressMax||1,f=m.currentTarget.getBoundingClientRect(),k=m.clientX-f.left,S=f.width/w;Math.floor(k/S)<l?p&&p(r.id,-1,r.stress,r.stressMax):p&&p(r.id,1,r.stress,r.stressMax)},u=m=>{m.stopPropagation(),(r.thresholds&&r.thresholds.major&&r.thresholds.severe||r.type==="Minion")&&(a(!0),c(r.type==="Minion"?"1":""))},s=()=>{const m=parseInt(o);if(m>0){if(r.type==="Minion")t&&t(r.id,m,r.hp,r.hpMax);else{let l=0;m>=r.thresholds.severe?l=3:m>=r.thresholds.major?l=2:m>=1&&(l=1),t&&t(r.id,l,r.hp,r.hpMax)}a(!1),c("")}};return{showDamageInput:n,damageValue:o,setDamageValue:c,setShowDamageInput:a,handleHpClick:d,handleStressClick:h,handleDifficultyClick:u,applyDamage:s,handleKeyDown:m=>{m.key==="Enter"?s():m.key==="Escape"&&(a(!1),c(""))}}},er=(r,t,i)=>({renderDistributedPips:()=>{const n=r.max,a=[];for(let o=0;o<n;o+=5){const c=Math.min(5,n-o);a.push(c)}return a.map((o,c)=>e.jsx("div",{style:B.pipGroup,children:Array.from({length:o},(d,h)=>{const u=c*5+h;return e.jsx("span",{style:{...B.pipSymbol,color:u<(r.value||0)?"var(--red)":"var(--text-secondary)"},title:`${u+1} of ${r.max}`,children:u<(r.value||0)?"●":"○"},u)})},c))}}),G=({item:r,type:t,mode:i="compact",onClick:p,onDelete:n,onApplyDamage:a,onApplyHealing:o,onApplyStressChange:c,onUpdate:d,onIncrement:h,onDecrement:u,dragAttributes:s,dragListeners:g,adversaries:m=[],isSelected:l=!1,isEditMode:w=!1})=>{const f=Ze(r,a,o,c),k=er(r);(t==="adversary"||t==="adversaries")&&f.handleDifficultyClick;const[S,I]=j.useState(!1),W=()=>{I(!0)},N=()=>{I(!1)},P=(x=!1)=>{let v={...B.card};if(l?v.transition="none":v.transition=S?B.transitions.hoverIn:B.transitions.hoverOut,x){const{marginTop:y,...b}=v;v=b}return(S&&i!=="expanded"||l)&&(v={...v,...B.cardHover}),t==="adversary"&&(r.hp||0)>=(r.hpMax||1)&&(v={...v,...B.cardDead}),t==="countdown"&&(r.value||0)>=r.max&&(v={...v,...B.cardAtMax}),v},z=()=>{let x="border rounded-lg";return(S&&i!=="expanded"||l)&&(x+=" border-hover"),x},$=()=>{var x,v;if(t==="adversary"||t==="adversaries"){const y=r.baseName||((x=r.name)==null?void 0:x.replace(/\s+\(\d+\)$/,""))||"",b=r.duplicateNumber||((v=r.name)!=null&&v.match(/\((\d+)\)$/)?parseInt(r.name.match(/\((\d+)\)$/)[1]):1),E=[...m];return m.some(T=>T.id===r.id)||E.push(r),E.filter(T=>T.baseName===y).length>1?`${y} (${b})`:y}return r.name},A=()=>{const x=[];return r.type&&x.push(e.jsx("span",{style:{...B.badge,...B.typeBadge},children:r.type},"type")),t==="environment"&&r.tier&&x.push(e.jsxs("span",{style:{...B.badge,...B.tierBadge},children:["Tier ",r.tier]},"tier")),x},R=()=>e.jsxs("div",{style:B.cardActions,children:[e.jsxs("div",{style:B.controlButtons,children:[e.jsx("div",{style:{display:"flex",alignItems:"center"},children:e.jsx("div",{style:{display:"flex",gap:"0.25rem",alignItems:"center",cursor:"pointer",padding:"0.125rem",borderRadius:"0.5rem",transition:"all 0.2s ease"},onClick:t==="adversary"||t==="adversaries"?f.handleHpClick:void 0,onMouseEnter:x=>x.target.style.background="var(--gray-800)",onMouseLeave:x=>x.target.style.background="transparent",children:Array.from({length:r.hpMax||1},(x,v)=>e.jsx("span",{style:{fontSize:"1rem",transition:"color 0.1s ease",cursor:"pointer",color:v<(r.hp||0)?"var(--red)":"var(--text-secondary)"},title:v<(r.hp||0)?"Click to heal (reduce damage)":"Click to take damage",children:e.jsx(re,{size:16})},v))})}),r.stressMax>0&&e.jsx("div",{style:{display:"flex",alignItems:"center"},children:e.jsx("div",{style:{display:"flex",gap:"0.25rem",alignItems:"center",cursor:"pointer",padding:"0.125rem",borderRadius:"0.5rem",transition:"all 0.2s ease"},onClick:t==="adversary"||t==="adversaries"?f.handleStressClick:void 0,onMouseEnter:x=>x.target.style.background="var(--gray-800)",onMouseLeave:x=>x.target.style.background="transparent",children:Array.from({length:r.stressMax},(x,v)=>e.jsx("span",{style:{fontSize:"1rem",transition:"color 0.1s ease",cursor:"pointer",color:v<(r.stress||0)?"var(--gold)":"var(--text-secondary)"},title:v<(r.stress||0)?"Click to reduce stress":"Click to increase stress",children:e.jsx(me,{size:16})},v))})}),r.difficulty&&e.jsx("div",{style:{display:"flex",alignItems:"center",gap:"0.5rem"},children:e.jsx("div",{onClick:t==="adversary"||t==="adversaries"?f.handleDifficultyClick:void 0,style:{cursor:r.thresholds&&r.thresholds.major&&r.thresholds.severe||r.type==="Minion"?"pointer":"default"},title:r.thresholds&&r.thresholds.major&&r.thresholds.severe?`Click to enter damage (thresholds: ${r.thresholds.major}/${r.thresholds.severe})`:r.type==="Minion"?"Click to enter damage (minion mechanics)":"",children:e.jsx("div",{className:"border rounded-md",style:{display:"flex",alignItems:"center",gap:"0.25rem",background:"var(--gray-900)",borderColor:"var(--border)",padding:"0.25rem 0.5rem",transition:"all 0.2s ease"},onMouseEnter:x=>x.target.style.background="var(--gray-800)",onMouseLeave:x=>x.target.style.background="var(--gray-900)",children:e.jsx("span",{style:{fontSize:"0.875rem",fontWeight:600,color:"var(--text-primary)"},children:r.difficulty})})})})]}),e.jsx("div",{style:{display:"flex",alignItems:"center"},children:!1})]}),O=()=>null,V=()=>e.jsxs(e.Fragment,{children:[e.jsx("button",{style:B.decrementButton,onClick:x=>{x.stopPropagation(),x.preventDefault(),u&&u(r.id)},title:"Decrease progress",children:e.jsx(We,{size:16})}),e.jsx("button",{style:B.incrementButton,onClick:x=>{x.stopPropagation(),x.preventDefault(),h&&h(r.id)},title:r.value>=r.max?r.loop&&r.loop!=="none"?"Loop countdown":"Countdown at max":"Increase progress",children:r.value>=r.max?r.loop&&r.loop!=="none"?"⟳":e.jsx(Q,{size:16}):e.jsx(Q,{size:16})})]}),_=()=>{switch(t){case"adversary":return R();case"environment":return O();case"countdown":return V();default:return null}},D=()=>t==="countdown"?e.jsx("div",{style:B.pipSymbols,children:t==="countdown"?k.renderDistributedPips():null}):null,F=()=>t!=="adversary"||!f.showDamageInput||!(r.thresholds&&r.thresholds.major&&r.thresholds.severe||r.type==="Minion")?null:e.jsx("div",{style:B.damageInputPopup,onClick:x=>{x.stopPropagation(),x.target===x.currentTarget&&(t==="adversary"||t==="adversaries")&&(f.setShowDamageInput(!1),f.setDamageValue(""))},children:e.jsxs("div",{className:"border rounded-lg",style:{...B.damageInputContent,borderColor:"var(--border)"},onClick:x=>x.stopPropagation(),children:[e.jsx("input",{type:"number",inputMode:"numeric",enterKeyHint:"done",placeholder:"Damage",min:r.type==="Minion"?"1":"0",value:t==="adversary"||t==="adversaries"?f.damageValue:"",onChange:x=>{(t==="adversary"||t==="adversaries")&&f.setDamageValue(x.target.value)},onKeyDown:t==="adversary"||t==="adversaries"?f.handleKeyDown:void 0,className:"border rounded-sm",style:{...B.damageInput,borderColor:"var(--border)"},autoFocus:!0}),e.jsxs("div",{style:B.damageIndicators,children:[r.type==="Minion"?(()=>{var E,L;const x=parseInt(t==="adversary"||t==="adversaries"?f.damageValue:"0")||0,v=(E=r.features)==null?void 0:E.find(q=>{var T;return(T=q.name)==null?void 0:T.startsWith("Minion (")}),y=v?parseInt(((L=v.name.match(/\((\d+)\)/))==null?void 0:L[1])||"1"):1,b=Math.floor(x/y);return x>=y&&b>0?e.jsxs("span",{style:{...B.damageDrop,color:"var(--success)"},title:`${x} damage can defeat ${b+1} minion${b+1!==1?"s":""} (1 + ${b} additional)`,children:["+",b," additional minion(s)"]}):e.jsx("span",{style:B.damageDrop,title:`${x} damage defeats this minion only`,children:"+0 additional minion(s)"})})():[1,2,3].map(x=>{const v=parseInt(t==="adversary"||t==="adversaries"?f.damageValue:"0")||0;let y=!1;return x===1&&v>=1&&(y=!0),x===2&&v>=r.thresholds.major&&(y=!0),x===3&&v>=r.thresholds.severe&&(y=!0),e.jsx("span",{style:{...B.damageDrop,color:y?"var(--red)":"var(--text-secondary)"},onClick:b=>{b.stopPropagation(),(t==="adversary"||t==="adversaries")&&(x===1?f.setDamageValue("1"):x===2?f.setDamageValue(r.thresholds.major.toString()):x===3&&f.setDamageValue(r.thresholds.severe.toString()))},title:`Click to set damage to ${x===1?"1":x===2?r.thresholds.major:r.thresholds.severe}`,children:e.jsx(re,{size:16})},x)}),e.jsx("button",{style:{...B.applyButton,backgroundColor:!f.damageValue||parseInt(f.damageValue)<1?"var(--gray-600)":"var(--success)"},onClick:x=>{x.stopPropagation(),(t==="adversary"||t==="adversaries")&&f.applyDamage()},title:"Apply damage",disabled:!f.damageValue||parseInt(f.damageValue)<1,children:e.jsx(ze,{size:16})})]})]})}),C=()=>{const v=(r.hp||0)>=(r.hpMax||1),y=i==="edit";return e.jsxs("div",{className:z(),style:{...P(!0),padding:0,minHeight:"400px",opacity:v?.7:1,backgroundColor:v?"var(--gray-900)":P(!0).backgroundColor,borderColor:v?"color-mix(in srgb, var(--gray-600) 40%, transparent)":l?"var(--purple)":S&&i!=="expanded"?"var(--border-hover)":"var(--border)",borderWidth:"2px",display:"flex",flexDirection:"column",position:"relative"},...s,...g,onClick:p,...i!=="expanded"&&{onMouseEnter:W,onMouseLeave:N},children:[v&&e.jsxs(e.Fragment,{children:[e.jsx("div",{style:{position:"absolute",top:0,left:0,right:0,bottom:0,background:`repeating-linear-gradient(
                45deg,
                transparent,
                transparent 8px,
                var(--gray-600) 1px,
                var(--gray-600) 9px
              )`,pointerEvents:"none",zIndex:9999}}),e.jsx("div",{style:{position:"absolute",top:"50%",left:"50%",transform:"translate(-50%, -50%)",color:"var(--text-secondary)",fontSize:"1rem",fontWeight:600,textTransform:"uppercase",letterSpacing:"0.05em",zIndex:1e4,pointerEvents:"none",textShadow:"1px 1px 2px rgba(0, 0, 0, 0.5)",backgroundColor:"var(--gray-900)",padding:"0.25rem 0.5rem",borderRadius:"0.5rem",border:"0.5px solid var(--gray-600)"},children:"DEFEATED"})]}),e.jsx("div",{className:"border-b",style:{padding:"12px",flexShrink:0,backgroundColor:"var(--bg-card)",borderRadius:"8px 8px 0 0",position:"relative",zIndex:v?1:"auto",borderBottomColor:l?"var(--purple)":"var(--border)"},children:e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"0.5rem",position:"relative",zIndex:v?1:"auto"},children:[e.jsx("div",{style:{display:"flex",flexDirection:"column",alignItems:"flex-start",gap:"0.25rem",flex:"1 1 0%",minWidth:0},children:e.jsx("h4",{style:{...B.rowTitle,color:v?"color-mix(in srgb, var(--gray-400) 80%, transparent)":B.rowTitle.color},children:$()})}),e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"0.5rem",flex:"0 0 auto",minWidth:"fit-content"},children:[e.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:"0.125rem",alignItems:"flex-end"},children:[e.jsx(K,{type:"adversaryHP",value:r.hp||0,maxValue:r.hpMax||1,onChange:b=>{const E=r.hp||0;b>E?a&&a(r.id,b-E,r.hp,r.hpMax):b<E&&o&&o(r.id,E-b,r.hp)},containerStyle:{cursor:"pointer",padding:"0.0625rem",borderRadius:"0.125rem",transition:"all 0.2s ease"},pipStyle:{fontSize:"0.75rem"},showTooltip:!1,enableBoundaryClick:!0}),r.stressMax>0&&e.jsx(K,{type:"adversaryStress",value:r.stress||0,maxValue:r.stressMax,onChange:b=>{const E=r.stress||0,L=b-E;c&&c(r.id,L,r.stress)},containerStyle:{cursor:"pointer",padding:"0.0625rem",borderRadius:"0.125rem",transition:"all 0.2s ease"},pipStyle:{fontSize:"0.75rem"},showTooltip:!1,enableBoundaryClick:!0})]}),e.jsxs("div",{style:{display:"flex",flexDirection:"column",alignItems:"center",gap:"0.25rem"},children:[r.type&&e.jsx("span",{style:{fontSize:"0.625rem",fontWeight:500,color:v?"color-mix(in srgb, var(--gray-400) 80%, transparent)":"var(--text-secondary)",letterSpacing:"0.5px",textAlign:"center",lineHeight:1},children:r.type}),r.difficulty&&e.jsxs("div",{onClick:f.handleDifficultyClick,style:{cursor:r.thresholds&&r.thresholds.major&&r.thresholds.severe||r.type==="Minion"?"pointer":"default",display:"flex",alignItems:"center",justifyContent:"center",position:"relative"},title:r.thresholds&&r.thresholds.major&&r.thresholds.severe?`Click to enter damage (thresholds: ${r.thresholds.major}/${r.thresholds.severe})`:r.type==="Minion"?"Click to enter damage (minion mechanics)":"",children:[e.jsx(J,{size:32,strokeWidth:1,style:{color:"var(--text-secondary)",transform:"rotate(30deg)"}}),e.jsx("span",{style:{position:"absolute",fontSize:"0.75rem",fontWeight:600,color:"white",pointerEvents:"none"},children:r.difficulty})]})]}),!1]})]})}),e.jsxs("div",{style:{flex:1,overflowY:"auto",padding:"12px",borderRadius:"0 0 8px 8px",position:"relative",zIndex:v?1:"auto"},children:[(r.tier||r.type)&&e.jsx("div",{style:{marginBottom:"1rem",paddingBottom:"0.75rem",borderBottom:"1px solid var(--border)"},children:e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"0.5rem"},children:[r.tier&&e.jsxs("span",{style:{fontSize:"0.875rem",fontWeight:500,color:v?"color-mix(in srgb, var(--gray-400) 80%, transparent)":"var(--text-secondary)",letterSpacing:"0.5px",padding:"0.25rem 0.5rem",backgroundColor:"var(--gray-800)",borderRadius:"0.25rem",border:"1px solid var(--border)"},children:["Tier ",r.tier]}),r.type&&e.jsx("span",{style:{fontSize:"0.875rem",fontWeight:500,color:v?"color-mix(in srgb, var(--gray-400) 80%, transparent)":"var(--text-secondary)",letterSpacing:"0.5px",padding:"0.25rem 0.5rem",backgroundColor:"var(--gray-800)",borderRadius:"0.25rem",border:"1px solid var(--border)"},children:r.type})]})}),r.description&&e.jsxs("div",{style:{marginBottom:"1rem",paddingBottom:"0.75rem",borderBottom:"1px solid var(--border)"},children:[e.jsx("h3",{style:{fontSize:"1rem",fontWeight:600,color:"var(--text-primary)",margin:"0 0 0.5rem 0"},children:"Description"}),y?e.jsx("textarea",{style:{width:"100%",minHeight:"100px",padding:"0.5rem",border:"1px solid var(--border)",borderRadius:"0.5rem",backgroundColor:"var(--bg-secondary)",color:"white",fontSize:"0.875rem",lineHeight:1.5,resize:"vertical",fontFamily:"inherit"},value:r.description,onChange:b=>{d&&d(r.id,{description:b.target.value})},placeholder:"Enter adversary description..."}):e.jsx("p",{style:{fontSize:"0.875rem",lineHeight:1.5,color:"var(--text-secondary)",margin:0,whiteSpace:"pre-wrap"},children:r.description})]}),r.motives&&e.jsxs("div",{style:{marginBottom:"1rem",paddingBottom:"0.75rem",borderBottom:"1px solid var(--border)"},children:[e.jsx("h3",{style:{fontSize:"1rem",fontWeight:600,color:"var(--text-primary)",margin:"0 0 0.5rem 0"},children:"Motives"}),y?e.jsx("textarea",{style:{width:"100%",minHeight:"80px",padding:"0.5rem",border:"1px solid var(--border)",borderRadius:"0.5rem",backgroundColor:"var(--bg-secondary)",color:"white",fontSize:"0.875rem",lineHeight:1.5,resize:"vertical",fontFamily:"inherit"},value:r.motives,onChange:b=>{d&&d(r.id,{motives:b.target.value})},placeholder:"Enter adversary motives..."}):e.jsx("p",{style:{fontSize:"0.875rem",lineHeight:1.5,color:"var(--text-secondary)",margin:0,whiteSpace:"pre-wrap"},children:r.motives})]}),e.jsx("div",{style:{marginBottom:"1rem",paddingBottom:"0.75rem",borderBottom:"1px solid var(--border)"},children:e.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:"0.5rem",fontSize:"0.875rem"},children:[e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"1rem",flexWrap:"wrap"},children:[e.jsxs("span",{children:[e.jsx("strong",{children:"Difficulty:"})," ",r.difficulty]}),r.thresholds&&e.jsxs("span",{children:[e.jsx("strong",{children:"Thresholds:"})," ",r.thresholds.major,"/",r.thresholds.severe]}),e.jsxs("span",{children:[e.jsx("strong",{children:"HP:"})," ",r.hpMax]}),r.stressMax>0&&e.jsxs("span",{children:[e.jsx("strong",{children:"Stress:"})," ",r.stressMax]})]}),(r.atk!==void 0||r.weapon||r.damage)&&e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"1rem",flexWrap:"wrap"},children:[r.atk!==void 0&&e.jsxs("span",{children:[e.jsx("strong",{children:"ATK:"})," ",r.atk>=0?"+":"",r.atk]}),r.weapon&&e.jsxs("span",{children:[e.jsxs("strong",{children:[r.weapon,":"]})," ",r.range||"Melee"]}),r.damage&&e.jsxs("span",{children:[e.jsx("strong",{children:"Damage:"})," ",r.damage]})]}),r.experience&&r.experience.length>0&&e.jsxs("div",{children:[e.jsx("strong",{children:"Experience:"})," ",r.experience.map(b=>typeof b=="string"?b:`${b.name} ${b.modifier>=0?"+":""}${b.modifier}`).join(", ")]})]})}),r.features&&r.features.length>0&&e.jsxs("div",{style:{marginBottom:"1rem"},children:[r.features.filter(b=>b.type==="Passive").length>0&&e.jsxs("div",{style:{marginBottom:"1rem"},children:[e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"0.75rem",marginBottom:"0.75rem"},children:[e.jsx("h4",{style:{fontSize:"0.875rem",fontWeight:600,color:"white",margin:0,textTransform:"uppercase",letterSpacing:"0.5px"},children:"Passives"}),e.jsx("hr",{style:{flex:1,border:"none",borderTop:"1px solid var(--border)",margin:0}})]}),e.jsx("div",{style:{display:"flex",flexDirection:"column",gap:"0.5rem"},children:r.features.filter(b=>b.type==="Passive").map((b,E)=>e.jsxs("div",{style:{fontSize:"0.875rem",lineHeight:1.4,color:"var(--text-secondary)"},children:[e.jsx("span",{style:{fontWeight:600,color:"var(--text-primary)"},children:b.name}),b.description&&e.jsxs(e.Fragment,{children:[e.jsx("span",{children:" - "}),e.jsx("span",{children:b.description})]})]},E))})]}),r.features.filter(b=>b.type==="Action").length>0&&e.jsxs("div",{style:{marginBottom:"1rem"},children:[e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"0.75rem",marginBottom:"0.75rem"},children:[e.jsx("h4",{style:{fontSize:"0.875rem",fontWeight:600,color:"white",margin:0,textTransform:"uppercase",letterSpacing:"0.5px"},children:"Actions"}),e.jsx("hr",{style:{flex:1,border:"none",borderTop:"1px solid var(--border)",margin:0}})]}),e.jsx("div",{style:{display:"flex",flexDirection:"column",gap:"0.5rem"},children:r.features.filter(b=>b.type==="Action").map((b,E)=>e.jsxs("div",{style:{fontSize:"0.875rem",lineHeight:1.4,color:"var(--text-secondary)"},children:[e.jsx("span",{style:{fontWeight:600,color:"var(--text-primary)"},children:b.name}),b.description&&e.jsxs(e.Fragment,{children:[e.jsx("span",{children:" - "}),e.jsx("span",{children:b.description})]})]},E))})]}),r.features.filter(b=>b.type==="Reaction").length>0&&e.jsxs("div",{style:{marginBottom:"1rem"},children:[e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"0.75rem",marginBottom:"0.75rem"},children:[e.jsx("h4",{style:{fontSize:"0.875rem",fontWeight:600,color:"white",margin:0,textTransform:"uppercase",letterSpacing:"0.5px"},children:"Reactions"}),e.jsx("hr",{style:{flex:1,border:"none",borderTop:"1px solid var(--border)",margin:0}})]}),e.jsx("div",{style:{display:"flex",flexDirection:"column",gap:"0.5rem"},children:r.features.filter(b=>b.type==="Reaction").map((b,E)=>e.jsxs("div",{style:{fontSize:"0.875rem",lineHeight:1.4,color:"var(--text-secondary)"},children:[e.jsx("span",{style:{fontWeight:600,color:"var(--text-primary)"},children:b.name}),b.description&&e.jsxs(e.Fragment,{children:[e.jsx("span",{children:" - "}),e.jsx("span",{children:b.description})]})]},E))})]})]})]}),F()]})},M=()=>{const v=i==="edit";return e.jsxs("div",{className:z(),style:{...P(!0),padding:0,minHeight:"400px",display:"flex",flexDirection:"column",position:"relative"},...s,...g,onClick:p,...i!=="expanded"&&{onMouseEnter:W,onMouseLeave:N},children:[e.jsx("div",{className:"border-b",style:{padding:"12px",flexShrink:0,backgroundColor:"var(--bg-card)",borderRadius:"8px 8px 0 0",position:"relative"},children:e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",gap:"0.5rem"},children:[e.jsxs("div",{style:{display:"flex",flexDirection:"column",alignItems:"flex-start",gap:"0.25rem"},children:[e.jsx("h2",{style:{fontSize:"1rem",fontWeight:600,color:"var(--text-primary)",margin:0},children:r.name}),e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"0.25rem"},children:[r.tier&&e.jsxs("span",{style:{fontSize:"0.75rem",fontWeight:500,color:"var(--text-secondary)",letterSpacing:"0.5px"},children:["Tier ",r.tier]}),r.type&&e.jsx("span",{style:{fontSize:"0.75rem",fontWeight:500,color:"var(--text-secondary)",letterSpacing:"0.5px"},children:r.type})]})]}),e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"0.5rem"},children:[r.difficulty&&e.jsxs("div",{style:{display:"flex",alignItems:"center",justifyContent:"center",position:"relative"},children:[e.jsx(J,{size:32,strokeWidth:1,style:{color:"var(--text-secondary)"}}),e.jsx("span",{style:{position:"absolute",top:"50%",left:"50%",transform:"translate(-50%, -50%)",fontSize:"0.75rem",fontWeight:700,color:"white",pointerEvents:"none"},children:r.difficulty})]}),!1]})]})}),e.jsxs("div",{style:{flex:1,overflowY:"auto",padding:"12px",borderRadius:"0 0 8px 8px"},children:[r.description&&e.jsxs("div",{style:{marginBottom:"1rem",paddingBottom:"0.75rem",borderBottom:"1px solid var(--border)"},children:[e.jsx("h3",{style:{fontSize:"1rem",fontWeight:600,color:"var(--text-primary)",margin:"0 0 0.5rem 0"},children:"Description"}),v?e.jsx("textarea",{style:{width:"100%",minHeight:"100px",padding:"0.5rem",border:"1px solid var(--border)",borderRadius:"0.5rem",backgroundColor:"var(--bg-secondary)",color:"white",fontSize:"0.875rem",lineHeight:1.5,resize:"vertical",fontFamily:"inherit"},value:r.description,onChange:y=>{d&&d(r.id,{description:y.target.value})},placeholder:"Enter environment description..."}):e.jsx("p",{style:{fontSize:"0.875rem",lineHeight:1.5,color:"var(--text-secondary)",margin:0,whiteSpace:"pre-wrap"},children:r.description})]}),r.impulses&&e.jsxs("div",{style:{marginBottom:"1rem",paddingBottom:"0.75rem",borderBottom:"1px solid var(--border)"},children:[e.jsx("h3",{style:{fontSize:"1rem",fontWeight:600,color:"var(--text-primary)",margin:"0 0 0.5rem 0"},children:"Impulses"}),e.jsx("p",{style:{fontSize:"0.875rem",lineHeight:1.5,color:"var(--text-secondary)",margin:0,whiteSpace:"pre-wrap"},children:r.impulses})]}),e.jsxs("div",{style:{marginBottom:"1rem",paddingBottom:"0.75rem",borderBottom:"1px solid var(--border)"},children:[e.jsx("h3",{style:{fontSize:"1rem",fontWeight:600,color:"var(--text-primary)",margin:"0 0 0.5rem 0"},children:"Core Stats"}),e.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:"0.5rem",fontSize:"0.875rem"},children:[e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"1rem",flexWrap:"wrap"},children:[e.jsxs("span",{children:[e.jsx("strong",{children:"Difficulty:"})," ",r.difficulty||"~"]}),e.jsxs("span",{children:[e.jsx("strong",{children:"Type:"})," ",r.type]}),e.jsxs("span",{children:[e.jsx("strong",{children:"Tier:"})," ",r.tier]})]}),r.potentialAdversaries&&r.potentialAdversaries.length>0&&e.jsxs("div",{children:[e.jsx("strong",{children:"Potential Adversaries:"}),e.jsx("div",{style:{marginTop:"0.25rem",display:"flex",flexDirection:"column",gap:"0.125rem"},children:r.potentialAdversaries.map((y,b)=>e.jsxs("div",{style:{fontSize:"0.75rem",color:"var(--text-secondary)",marginLeft:"0.5rem"},children:["• ",y]},b))})]})]})]}),r.features&&r.features.length>0&&e.jsxs("div",{style:{marginBottom:"1rem"},children:[r.features.filter(y=>y.type==="Passive").length>0&&e.jsxs("div",{style:{marginBottom:"1rem"},children:[e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"0.75rem",marginBottom:"0.75rem"},children:[e.jsx("h4",{style:{fontSize:"0.875rem",fontWeight:600,color:"white",margin:0,textTransform:"uppercase",letterSpacing:"0.5px"},children:"Passives"}),e.jsx("hr",{style:{flex:1,border:"none",borderTop:"1px solid var(--border)",margin:0}})]}),e.jsx("div",{style:{display:"flex",flexDirection:"column",gap:"0.75rem"},children:r.features.filter(y=>y.type==="Passive").map((y,b)=>e.jsxs("div",{style:{fontSize:"0.875rem",lineHeight:1.4,color:"var(--text-secondary)"},children:[e.jsx("div",{style:{fontWeight:600,color:"white",marginBottom:"0.25rem"},children:y.name}),e.jsx("div",{style:{marginBottom:"0.25rem"},children:y.description}),y.details&&y.details.length>0&&e.jsxs("div",{style:{marginLeft:"0.5rem"},children:[e.jsx("strong",{children:"Details:"}),e.jsx("ul",{style:{margin:"0.25rem 0 0 0",paddingLeft:"1rem",fontSize:"0.75rem"},children:y.details.map((E,L)=>e.jsx("li",{children:E},L))})]}),y.prompts&&y.prompts.length>0&&e.jsxs("div",{style:{marginLeft:"0.5rem"},children:[e.jsx("strong",{children:"Prompts:"}),e.jsx("ul",{style:{margin:"0.25rem 0 0 0",paddingLeft:"1rem",fontSize:"0.75rem"},children:y.prompts.map((E,L)=>e.jsxs("li",{style:{fontStyle:"italic"},children:['"',E,'"']},L))})]})]},b))})]}),r.features.filter(y=>y.type==="Action").length>0&&e.jsxs("div",{style:{marginBottom:"1rem"},children:[e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"0.75rem",marginBottom:"0.75rem"},children:[e.jsx("h4",{style:{fontSize:"0.875rem",fontWeight:600,color:"white",margin:0,textTransform:"uppercase",letterSpacing:"0.5px"},children:"Actions"}),e.jsx("hr",{style:{flex:1,border:"none",borderTop:"1px solid var(--border)",margin:0}})]}),e.jsx("div",{style:{display:"flex",flexDirection:"column",gap:"0.75rem"},children:r.features.filter(y=>y.type==="Action").map((y,b)=>e.jsxs("div",{style:{fontSize:"0.875rem",lineHeight:1.4,color:"var(--text-secondary)"},children:[e.jsx("div",{style:{fontWeight:600,color:"white",marginBottom:"0.25rem"},children:y.name}),e.jsx("div",{style:{marginBottom:"0.25rem"},children:y.description}),y.details&&y.details.length>0&&e.jsxs("div",{style:{marginLeft:"0.5rem"},children:[e.jsx("strong",{children:"Details:"}),e.jsx("ul",{style:{margin:"0.25rem 0 0 0",paddingLeft:"1rem",fontSize:"0.75rem"},children:y.details.map((E,L)=>e.jsx("li",{children:E},L))})]}),y.prompts&&y.prompts.length>0&&e.jsxs("div",{style:{marginLeft:"0.5rem"},children:[e.jsx("strong",{children:"Prompts:"}),e.jsx("ul",{style:{margin:"0.25rem 0 0 0",paddingLeft:"1rem",fontSize:"0.75rem"},children:y.prompts.map((E,L)=>e.jsxs("li",{style:{fontStyle:"italic"},children:['"',E,'"']},L))})]})]},b))})]}),r.features.filter(y=>y.type==="Reaction").length>0&&e.jsxs("div",{style:{marginBottom:"1rem"},children:[e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"0.75rem",marginBottom:"0.75rem"},children:[e.jsx("h4",{style:{fontSize:"0.875rem",fontWeight:600,color:"white",margin:0,textTransform:"uppercase",letterSpacing:"0.5px"},children:"Reactions"}),e.jsx("hr",{style:{flex:1,border:"none",borderTop:"1px solid var(--border)",margin:0}})]}),e.jsx("div",{style:{display:"flex",flexDirection:"column",gap:"0.75rem"},children:r.features.filter(y=>y.type==="Reaction").map((y,b)=>e.jsxs("div",{style:{fontSize:"0.875rem",lineHeight:1.4,color:"var(--text-secondary)"},children:[e.jsx("div",{style:{fontWeight:600,color:"white",marginBottom:"0.25rem"},children:y.name}),e.jsx("div",{style:{marginBottom:"0.25rem"},children:y.description}),y.details&&y.details.length>0&&e.jsxs("div",{style:{marginLeft:"0.5rem"},children:[e.jsx("strong",{children:"Details:"}),e.jsx("ul",{style:{margin:"0.25rem 0 0 0",paddingLeft:"1rem",fontSize:"0.75rem"},children:y.details.map((E,L)=>e.jsx("li",{children:E},L))})]}),y.prompts&&y.prompts.length>0&&e.jsxs("div",{style:{marginLeft:"0.5rem"},children:[e.jsx("strong",{children:"Prompts:"}),e.jsx("ul",{style:{margin:"0.25rem 0 0 0",paddingLeft:"1rem",fontSize:"0.75rem"},children:y.prompts.map((E,L)=>e.jsxs("li",{style:{fontStyle:"italic"},children:['"',E,'"']},L))})]})]},b))})]})]})]})]})};if((i==="expanded"||i==="edit")&&(t==="adversary"||t==="adversaries"))return C();if((i==="expanded"||i==="edit")&&(t==="environment"||t==="environments"))return M();if(i!=="compact"&&!(t==="adversary"||t==="adversaries"||t==="environment"||t==="environments"))return e.jsxs("div",{className:z(),style:P(!0),children:[e.jsxs("div",{style:B.rowMain,children:[e.jsx("h4",{style:B.rowTitle,children:$()}),e.jsx("div",{style:B.rowMeta,children:A()})]}),e.jsxs("p",{style:{color:"var(--text-secondary)",fontSize:"12px",margin:0},children:["Expanded view coming soon for ",t]})]});if(t==="adversary"||t==="adversaries"){const v=(r.hp||0)>=(r.hpMax||1);return e.jsxs("div",{className:z(),style:{...P(),opacity:v?.7:1,backgroundColor:v?"var(--gray-900)":P().backgroundColor,borderColor:v?"color-mix(in srgb, var(--gray-600) 40%, transparent)":l?"var(--purple)":S&&i!=="expanded"?"var(--border-hover)":"var(--border)",paddingLeft:"0.75rem",position:"relative"},onClick:p,...i!=="expanded"&&{onMouseEnter:W,onMouseLeave:N},...s,...g,children:[v&&e.jsxs(e.Fragment,{children:[e.jsx("div",{style:{position:"absolute",top:0,left:0,right:0,bottom:0,background:`repeating-linear-gradient(
                45deg,
                transparent,
                transparent 8px,
                var(--gray-600) 1px,
                var(--gray-600) 9px
              )`,pointerEvents:"none",zIndex:9999}}),e.jsx("div",{style:{position:"absolute",top:"50%",left:"50%",transform:"translate(-50%, -50%)",color:"var(--text-secondary)",fontSize:"1rem",fontWeight:600,textTransform:"uppercase",letterSpacing:"0.05em",zIndex:1e4,pointerEvents:"none",textShadow:"1px 1px 2px rgba(0, 0, 0, 0.5)",backgroundColor:"var(--gray-900)",padding:"0.25rem 0.5rem",borderRadius:"0.5rem",border:"0.5px solid var(--gray-600)"},children:"DEFEATED"})]}),!1,e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"0.5rem",position:"relative",zIndex:v?1:"auto"},children:[e.jsx("div",{style:{display:"flex",flexDirection:"column",alignItems:"flex-start",gap:"0.25rem",flex:"1 1 0%",minWidth:0},children:e.jsx("h4",{style:{...B.rowTitle,color:v?"color-mix(in srgb, var(--gray-400) 80%, transparent)":B.rowTitle.color},children:$()})}),e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"0.5rem",flex:"0 0 auto",minWidth:"fit-content"},children:[e.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:"0.125rem",alignItems:"flex-end"},children:[e.jsx(K,{type:"adversaryHP",value:r.hp||0,maxValue:r.hpMax||1,onChange:y=>{const b=r.hp||0;y>b?a&&a(r.id,y-b,r.hp,r.hpMax):y<b&&o&&o(r.id,b-y,r.hp)},containerStyle:{cursor:"pointer",padding:"0.0625rem",borderRadius:"0.125rem",transition:"all 0.2s ease"},pipStyle:{fontSize:"0.75rem"},showTooltip:!1,enableBoundaryClick:!0}),r.stressMax>0&&e.jsx(K,{type:"adversaryStress",value:r.stress||0,maxValue:r.stressMax,onChange:y=>{const b=r.stress||0,E=y-b;c&&c(r.id,E,r.stress)},containerStyle:{cursor:"pointer",padding:"0.0625rem",borderRadius:"0.125rem",transition:"all 0.2s ease"},pipStyle:{fontSize:"0.75rem"},showTooltip:!1,enableBoundaryClick:!0})]}),e.jsxs("div",{style:{display:"flex",flexDirection:"column",alignItems:"center",gap:"0.25rem"},children:[r.type&&e.jsx("span",{style:{fontSize:"0.625rem",fontWeight:500,color:v?"color-mix(in srgb, var(--gray-400) 80%, transparent)":"var(--text-secondary)",letterSpacing:"0.5px",textAlign:"center",lineHeight:1},children:r.type}),r.difficulty&&e.jsxs("div",{onClick:f.handleDifficultyClick,style:{cursor:r.thresholds&&r.thresholds.major&&r.thresholds.severe||r.type==="Minion"?"pointer":"default",display:"flex",alignItems:"center",justifyContent:"center",position:"relative"},title:r.thresholds&&r.thresholds.major&&r.thresholds.severe?`Click to enter damage (thresholds: ${r.thresholds.major}/${r.thresholds.severe})`:r.type==="Minion"?"Click to enter damage (minion mechanics)":"",children:[e.jsx(J,{size:32,strokeWidth:1,style:{color:"var(--text-secondary)",transform:"rotate(30deg)"}}),e.jsx("span",{style:{position:"absolute",fontSize:"0.75rem",fontWeight:600,color:"white",pointerEvents:"none"},children:r.difficulty})]})]}),console.log("Delete button check:",{onDelete:!!n,isEditMode:w,shouldShow:n&&w}),n&&w&&e.jsx("button",{className:"border rounded-md",style:{background:"var(--red)",borderColor:"var(--red)",padding:"0.25rem",minWidth:"1.5rem",height:"1.5rem",display:"flex",alignItems:"center",justifyContent:"center",cursor:"pointer",transition:"all 0.1s ease",color:"white",fontSize:"1rem"},onClick:y=>{y.stopPropagation(),y.preventDefault(),n&&n(r.id)},onMouseEnter:y=>y.target.style.background="var(--red-dark)",onMouseLeave:y=>y.target.style.background="var(--red)",title:"Delete item",children:"×"})]})]}),F()]})}return t==="environment"||t==="environments"?e.jsxs("div",{className:z(),style:{...P(),paddingLeft:"0.75rem",position:"relative"},onClick:p,...i!=="expanded"&&{onMouseEnter:W,onMouseLeave:N},...s,...g,children:[!1,e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",gap:"0.5rem",position:"relative"},children:[e.jsxs("div",{style:{display:"flex",flexDirection:"column",alignItems:"flex-start",gap:"0.25rem"},children:[e.jsx("h4",{style:B.rowTitle,children:$()}),r.type&&e.jsx("span",{style:{fontSize:"0.75rem",fontWeight:500,color:"var(--text-secondary)",letterSpacing:"0.5px"},children:r.type})]}),e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"0.5rem"},children:[r.difficulty&&e.jsxs("div",{style:{display:"flex",alignItems:"center",justifyContent:"center",position:"relative"},children:[e.jsx(J,{size:32,strokeWidth:1,style:{color:"var(--text-secondary)"}}),e.jsx("span",{style:{position:"absolute",top:"50%",left:"50%",transform:"translate(-50%, -50%)",fontSize:"0.75rem",fontWeight:700,color:"white",pointerEvents:"none"},children:r.difficulty})]}),r.type&&e.jsx("div",{style:{display:"flex",flexDirection:"column",alignItems:"center",gap:"0.125rem"},children:e.jsx("span",{style:{fontSize:"0.625rem",fontWeight:500,color:isDead?"color-mix(in srgb, var(--gray-400) 80%, transparent)":"var(--text-secondary)",letterSpacing:"0.5px",textAlign:"center",lineHeight:1},children:r.type})}),console.log("Delete button check:",{onDelete:!!n,isEditMode:w,shouldShow:n&&w}),n&&w&&e.jsx("button",{className:"border rounded-md",style:{background:"var(--red)",borderColor:"var(--red)",padding:"0.25rem",minWidth:"1.5rem",height:"1.5rem",display:"flex",alignItems:"center",justifyContent:"center",cursor:"pointer",transition:"all 0.1s ease",color:"white",fontSize:"1rem"},onClick:v=>{v.stopPropagation(),v.preventDefault(),n&&n(r.id)},onMouseEnter:v=>v.target.style.background="var(--red-dark)",onMouseLeave:v=>v.target.style.background="var(--red)",title:"Delete environment",children:"×"})]})]})]}):e.jsxs("div",{className:z(),style:P(),onClick:p,onMouseEnter:()=>I(!0),onMouseLeave:()=>I(!1),...s,...g,children:[e.jsxs("div",{style:B.rowMain,children:[e.jsx("h4",{style:B.rowTitle,children:$()}),e.jsx("div",{style:B.rowMeta,children:A()})]}),D(),e.jsxs("div",{style:B.cardActions,children:[e.jsx("div",{style:B.controlButtons,children:_()}),e.jsx("div",{style:{display:"flex",alignItems:"center"},children:!1})]}),F()]})},be=j.createContext();function ne(r){if(typeof localStorage>"u")return null;try{const t=localStorage.getItem(r);return t==null?null:JSON.parse(t)}catch{return null}}function je(r,t){if(!(typeof localStorage>"u"))try{localStorage.setItem(r,JSON.stringify(t))}catch{}}const we=({children:r})=>{const[t,i]=j.useState({fear:{value:0,visible:!1},countdowns:[],adversaries:[],environments:[]});j.useEffect(()=>{var O,V,_;const R=ne("daggerheart-game-state");if(R)try{(((O=R.adversaries)==null?void 0:O.length)>0||((V=R.environments)==null?void 0:V.length)>0||((_=R.countdowns)==null?void 0:_.length)>0)&&i(R)}catch(D){console.error("Failed to load saved state:",D)}},[]),j.useEffect(()=>{je("daggerheart-game-state",t)},[t]);const p=R=>{i(O=>({...O,fear:{...O.fear,value:R}}))},n=()=>{i(R=>({...R,fear:{...R.fear,visible:!R.fear.visible}}))},a=j.useRef(t);j.useEffect(()=>{a.current=t},[t]);const o=()=>a.current,c=Ge(i),d=Ye(o,i),h=Ke(o,i),{createCountdown:u,updateCountdown:s,deleteCountdown:g,advanceCountdown:m,incrementCountdown:l,decrementCountdown:w,reorderCountdowns:f}=c,{createAdversary:k,updateAdversary:S,deleteAdversary:I,reorderAdversaries:W}=d,{createEnvironment:N,updateEnvironment:P,deleteEnvironment:z,reorderEnvironments:$}=h,A={gameState:t,updateFear:p,toggleFearVisibility:n,createCountdown:u,updateCountdown:s,deleteCountdown:g,advanceCountdown:m,incrementCountdown:l,decrementCountdown:w,reorderCountdowns:f,createAdversary:k,updateAdversary:S,deleteAdversary:I,reorderAdversaries:W,createEnvironment:N,updateEnvironment:P,deleteEnvironment:z,reorderEnvironments:$};return e.jsx(be.Provider,{value:A,children:r})},Ce=()=>{const r=j.useContext(be);if(!r)return console.warn("useGameState: Context not available yet, returning defaults"),{fear:{value:0,visible:!1},countdowns:[],adversaries:[],environments:[],updateFear:()=>{},toggleFearVisibility:()=>{},createCountdown:()=>{},updateCountdown:()=>{},deleteCountdown:()=>{},advanceCountdown:()=>{},incrementCountdown:()=>{},decrementCountdown:()=>{},reorderCountdowns:()=>{},createAdversary:()=>{},updateAdversary:()=>{},deleteAdversary:()=>{},reorderAdversaries:()=>{},createEnvironment:()=>{},updateEnvironment:()=>{},deleteEnvironment:()=>{},reorderEnvironments:()=>{},hasCountdowns:!1,hasAdversaries:!1,hasEnvironments:!1,getCountdownById:()=>null,getAdversaryById:()=>null,getEnvironmentById:()=>null};const{gameState:t,...i}=r;if(!t)return console.warn("useGameState: gameState not available, returning defaults"),{fear:{value:0,visible:!1},countdowns:[],adversaries:[],environments:[],updateFear:()=>{},toggleFearVisibility:()=>{},createCountdown:()=>{},updateCountdown:()=>{},deleteCountdown:()=>{},advanceCountdown:()=>{},incrementCountdown:()=>{},decrementCountdown:()=>{},reorderCountdowns:()=>{},createAdversary:()=>{},updateAdversary:()=>{},deleteAdversary:()=>{},reorderAdversaries:()=>{},createEnvironment:()=>{},updateEnvironment:()=>{},deleteEnvironment:()=>{},reorderEnvironments:()=>{},hasCountdowns:!1,hasAdversaries:!1,hasEnvironments:!1,getCountdownById:()=>null,getAdversaryById:()=>null,getEnvironmentById:()=>null};const{fear:p,countdowns:n,adversaries:a,environments:o}=t;return{gameState:t,fear:p,countdowns:n,adversaries:a,environments:o,...i,hasCountdowns:n.length>0,hasAdversaries:a.length>0,hasEnvironments:o.length>0,getCountdownById:c=>n.find(d=>d.id===c),getAdversaryById:c=>a.find(d=>d.id===c),getEnvironmentById:c=>o.find(d=>d.id===c)}},rr=(r,t)=>{const[i,p]=j.useState(()=>{const n=ne(r);return n??t});return j.useEffect(()=>{const n=ne(r);p(n??t)},[r]),j.useEffect(()=>{je(r,i)},[r,i]),[i,p]},tr="/Daggerheart/assets/daggerheart-logo-fe7815ad.svg",nr=()=>{const[r,t]=j.useState(!1),[i,p]=j.useState(!1);return j.useEffect(()=>{const n=a=>{a.target.closest(".help-button")||t(!1)};return document.addEventListener("click",n),()=>document.removeEventListener("click",n)},[]),j.useEffect(()=>{const n=window.matchMedia("(max-width: 800px)"),a=o=>p(o.matches);return p(n.matches),n.addEventListener("change",a),()=>n.removeEventListener("change",a)},[]),e.jsxs("div",{className:"help-button",style:{position:"relative",display:"flex",alignItems:"center",justifyContent:"center",padding:"0.5rem",color:"var(--text-primary)",borderRadius:"var(--radius-md)",cursor:"pointer",transition:"background-color 0.2s ease",minWidth:"44px",minHeight:"44px",backgroundColor:r?"var(--purple)":"transparent"},onMouseEnter:n=>{r||(n.target.style.backgroundColor="var(--gray-dark)")},onMouseLeave:n=>{r||(n.target.style.backgroundColor="transparent")},onClick:n=>{n.stopPropagation(),t(!r)},title:"Help & Info",children:[e.jsx("div",{style:{width:"20px",height:"20px",display:"flex",alignItems:"center",justifyContent:"center",color:"inherit"},children:e.jsx(Ae,{size:20})}),e.jsxs("div",{style:{position:"absolute",bottom:"100%",left:i?"auto":"50%",right:i?"0":"auto",transform:i?"none":"translateX(-50%)",background:"var(--bg-primary)",border:"1px solid var(--border)",borderRadius:"var(--radius-md)",boxShadow:"0 4px 12px rgba(0, 0, 0, 0.3)",zIndex:1e3,opacity:r?1:0,visibility:r?"visible":"hidden",transition:"opacity 0.2s ease, visibility 0.2s ease, transform 0.2s ease",pointerEvents:r?"auto":"none",minWidth:"280px",maxWidth:i?"calc(100vw - 2rem)":"320px",marginBottom:i?"0.5rem":"0"},children:[e.jsxs("div",{style:{padding:"0.75rem",borderTop:"1px solid rgba(255, 255, 255, 0.1)",borderBottom:"1px solid rgba(255, 255, 255, 0.1)",background:"var(--bg-primary)",maxWidth:"280px"},children:[e.jsx("img",{src:tr,alt:"Daggerheart Community Content Logo",style:{width:"100%",maxWidth:"200px",height:"auto",margin:"0 auto 0.75rem auto",display:"block"},onError:n=>{console.error("Failed to load Daggerheart logo:",n.target.src),n.target.style.display="none";const a=document.createElement("div");a.style.cssText="text-align: center; margin-bottom: 0.75rem; font-size: 1.5rem; font-weight: bold; color: var(--purple);",a.textContent="⚔️ DAGGERHEART ⚔️",n.target.parentNode.insertBefore(a,n.target)},onLoad:()=>{}}),e.jsxs("div",{style:{fontSize:"0.7rem",lineHeight:1.3,color:"var(--text-secondary)",textAlign:"left",wordWrap:"break-word",overflowWrap:"break-word"},children:[e.jsx("p",{children:"This product includes materials from the Daggerheart System Reference Document 1.0, © Critical Role, LLC, under the terms of the Darrington Press Community Gaming (DPCGL) License."}),e.jsxs("p",{children:["More information can be found at ",e.jsx("a",{href:"https://www.daggerheart.com",target:"_blank",rel:"noopener noreferrer",children:"daggerheart.com"})]}),e.jsx("p",{children:e.jsx("em",{children:"This project is unofficial and not endorsed by Darrington Press or Critical Role."})})]})]}),e.jsx("button",{style:{display:"flex",alignItems:"center",justifyContent:"flex-start",padding:"0.25rem 1rem",color:"var(--text-primary)",border:"none",background:"none",width:"100%",textAlign:"left",cursor:"pointer",transition:"background-color 0.2s ease",fontSize:"0.875rem",minHeight:"32px",borderBottom:"1px solid rgba(255, 255, 255, 0.1)"},onMouseEnter:n=>{n.target.style.backgroundColor="var(--gray-dark)"},onMouseLeave:n=>{n.target.style.backgroundColor="transparent"},onClick:n=>{n.stopPropagation(),t(!1),window.open("https://github.com/Splinter714/Daggerheart","_blank")},children:e.jsx("div",{style:{display:"flex",alignItems:"center",justifyContent:"center",gap:"0.25rem"},children:e.jsx("span",{children:"GitHub"})})}),e.jsx("div",{style:{display:"flex",alignItems:"center",justifyContent:"flex-start",padding:"0.25rem 1rem",color:"var(--text-secondary)",border:"none",background:"none",width:"100%",textAlign:"left",cursor:"default",fontSize:"0.875rem",minHeight:"32px"},children:e.jsx("div",{style:{display:"flex",alignItems:"center",justifyContent:"center",gap:"0.25rem"},children:e.jsxs("span",{children:["Version ","0.2.5 (247b56b)"]})})})]})]})},or=({adversaries:r,environments:t,countdowns:i,deleteAdversary:p,deleteEnvironment:n,deleteCountdown:a})=>{const[o,c]=j.useState(!1);j.useEffect(()=>{const l=w=>{w.target.closest(".delete-clear-container")||c(!1)};return document.addEventListener("click",l),()=>document.removeEventListener("click",l)},[]);const d=((r==null?void 0:r.length)||0)>0||((t==null?void 0:t.length)||0)>0||((i==null?void 0:i.length)||0)>0,h=(r||[]).some(l=>(l.hp||0)>=(l.hpMax||1)),u={position:"absolute",bottom:"100%",left:"50%",transform:"translateX(-50%)",backgroundColor:"var(--bg-secondary)",border:"1px solid var(--border)",borderRadius:"var(--radius-md)",padding:"0.5rem",minWidth:"200px",boxShadow:"0 4px 12px rgba(0, 0, 0, 0.3)",zIndex:1e3,display:o?"block":"none"},s={background:"none",border:"none",color:d?"var(--text-primary)":"var(--text-secondary)",cursor:d?"pointer":"not-allowed",padding:"0.5rem",borderRadius:"var(--radius-sm)",display:"flex",alignItems:"center",justifyContent:"center",transition:"all 0.2s",opacity:d?1:.5},g={background:"none",border:"none",color:"var(--text-primary)",cursor:"pointer",padding:"0.5rem",borderRadius:"var(--radius-sm)",width:"100%",textAlign:"left",display:"flex",alignItems:"center",gap:"0.5rem",transition:"background-color 0.2s"},m={backgroundColor:"var(--bg-hover)"};return e.jsxs("div",{className:"delete-clear-container",style:{position:"relative"},children:[e.jsx("button",{style:s,onClick:l=>{l.stopPropagation(),d&&c(!o)},title:d?"Clear Items":"Nothing to clear",children:e.jsx(Re,{size:20})}),e.jsxs("div",{style:u,children:[r&&r.length>0&&e.jsxs("button",{style:g,onMouseEnter:l=>Object.assign(l.target.style,m),onMouseLeave:l=>Object.assign(l.target.style,g),onClick:l=>{l.stopPropagation(),c(!1),r.forEach(w=>p(w.id))},children:[e.jsx("span",{children:"×"}),e.jsx("span",{children:"All Adversaries"})]}),r&&r.length>0&&h&&e.jsxs("button",{style:g,onMouseEnter:l=>Object.assign(l.target.style,m),onMouseLeave:l=>Object.assign(l.target.style,g),onClick:l=>{l.stopPropagation(),c(!1),r.filter(f=>(f.hp||0)>=(f.hpMax||1)).forEach(f=>p(f.id))},children:[e.jsx("span",{children:"×"}),e.jsx("span",{children:"Dead Adversaries"})]}),t&&t.length>0&&e.jsxs("button",{style:g,onMouseEnter:l=>Object.assign(l.target.style,m),onMouseLeave:l=>Object.assign(l.target.style,g),onClick:l=>{l.stopPropagation(),c(!1),t.forEach(w=>n(w.id))},children:[e.jsx("span",{children:"×"}),e.jsx("span",{children:"All Environments"})]}),i&&i.length>0&&e.jsxs("button",{style:g,onMouseEnter:l=>Object.assign(l.target.style,m),onMouseLeave:l=>Object.assign(l.target.style,g),onClick:l=>{l.stopPropagation(),c(!1),i.forEach(w=>a(w.id))},children:[e.jsx("span",{children:"×"}),e.jsx("span",{children:"All Countdowns"})]})]})]})},sr=({isEditMode:r,setIsEditMode:t,style:i={}})=>{const p={backgroundColor:r?"var(--purple)":"transparent",border:r?"1px solid var(--purple)":"1px solid transparent",borderRadius:"var(--radius-md)",padding:"0.75rem",cursor:"pointer",transition:"all 0.2s ease",display:"flex",alignItems:"center",justifyContent:"center",gap:"0.5rem",color:r?"#fff":"var(--text-primary)",fontSize:"0.875rem",fontWeight:600,minWidth:"40px",...i},n=()=>{t(!r)};return e.jsx("button",{style:p,onClick:n,title:r?"Exit Edit Mode":"Enter Edit Mode",onMouseEnter:a=>{r||(a.target.style.backgroundColor="var(--bg-secondary)",a.target.style.borderColor="var(--border)")},onMouseLeave:a=>{r||(a.target.style.backgroundColor="transparent",a.target.style.borderColor="transparent")},children:e.jsx(Le,{size:16})})},pe=({position:r="top",children:t,onClick:i,className:p="",style:n={}})=>{const a=r==="top",o={background:"var(--bg-primary)",borderTop:a?"none":"1px solid var(--border)",borderBottom:a?"1px solid var(--border)":"none",padding:a?"0.25rem 0":"0.5rem",position:"sticky",[a?"top":"bottom"]:0,zIndex:a?10:100,order:a?1:3,flexShrink:0,touchAction:"manipulation",userSelect:"none",display:"flex",flexDirection:a?"column":"row",justifyContent:a?"stretch":"center",alignItems:a?"stretch":"center",height:a?"auto":"100%",...n};return e.jsx("div",{className:p,style:o,onClick:i,children:t})},ue=({side:r="left",children:t,className:i="",style:p={}})=>{const n=r==="left",a={flex:1,minWidth:0,background:"var(--bg-primary)",overflowY:"auto",overflowX:n?"auto":"hidden",display:n?"block":"flex",flexDirection:n?"initial":"column",height:"100%",padding:n?"1rem 0.5rem 1rem 1rem":"1rem 1rem 1rem 0.5rem",...p};return e.jsx("div",{className:i,style:a,children:t})},ar=({items:r,onDelete:t,onEdit:i,onToggleVisibility:p,onReorder:n,onItemSelect:a,selectedItem:o,selectedType:c,onApplyDamage:d,onApplyHealing:h,onApplyStressChange:u,onIncrement:s,onDecrement:g,isEditMode:m,elementType:l,adversaries:w=[]})=>{if(!r||r.length===0)return null;const f=k=>{const S=o&&o.id===k.id&&c===l;console.log("Card selection check:",{itemId:k.id,selectedItemId:o==null?void 0:o.id,selectedType:c,elementType:l,isSelected:S});const I={item:k,mode:"compact",onClick:()=>a(k,l),onDelete:t,dragAttributes:m?{draggable:!0}:null,dragListeners:m?{onDragStart:W=>{W.dataTransfer.setData("text/plain",k.id)}}:null,adversaries:w,isSelected:S,isEditMode:m};switch(l){case"adversaries":return e.jsx(G,{...I,type:"adversary",onApplyDamage:d,onApplyHealing:h,onApplyStressChange:u},k.id);case"environments":return e.jsx(G,{...I,type:"environment",onEdit:i},k.id);case"countdowns":return e.jsx(G,{...I,type:"countdown",onIncrement:s,onDecrement:g},k.id);default:return null}};return e.jsx("div",{style:{display:"flex",flexDirection:"column",gap:"8px"},children:r.map(f)})},ir=({onItemSelect:r,selectedItem:t,selectedType:i,onOpenDatabase:p,isEditMode:n,showLongTermCountdowns:a,fear:o,updateFear:c,handleRollOutcome:d,handleActionRoll:h,setShowLongTermCountdowns:u,lastAddedItemType:s})=>{console.log("GameBoard received props:",{selectedItem:t,selectedType:i});const{adversaries:g,environments:m,updateAdversary:l,deleteAdversary:w,reorderAdversaries:f,updateEnvironment:k,deleteEnvironment:S,reorderEnvironments:I,countdowns:W,createCountdown:N,deleteCountdown:P,reorderCountdowns:z,incrementCountdown:$,decrementCountdown:A}=Ce();j.useState({adversary:!1,environment:!1,campaign:!1});const[R,O]=rr("sectionVisibility",{countdowns:!1,environments:!1,adversaries:!1});j.useEffect(()=>{s&&(s==="environment"?O(D=>({...D,environments:!0})):s==="adversary"?O(D=>({...D,adversaries:!0})):s==="countdown"&&O(D=>({...D,countdowns:!0})))},[s,O]);const V=(D,F)=>{},_=(D,F)=>{F==="environment"?S(D):F==="adversary"?w(D):F==="countdown"&&P(D),t&&t.id===D&&r(null,null)};return e.jsx("div",{style:{flex:1,overflowY:"auto"},children:e.jsxs("div",{style:{marginBottom:"0.75rem"},children:[e.jsx(ar,{items:g,onDelete:D=>_(D,"adversary"),onEdit:D=>V(),onToggleVisibility:D=>{const F=g.find(C=>C.id===D);F&&l(D,{isVisible:!F.isVisible})},onReorder:f,onItemSelect:r,selectedItem:t,selectedType:i,onApplyDamage:(D,F,C,M)=>{const x=Math.min(M,C+F);l(D,{hp:x})},onApplyHealing:(D,F,C)=>{if(g.find(x=>x.id===D)){const x=Math.max(0,C-F);l(D,{hp:x})}},onApplyStressChange:(D,F)=>{const C=g.find(M=>M.id===D);if(C){let M=C.stress+F,x=C.hp||0;if(M>C.stressMax){const v=M-C.stressMax;M=C.stressMax,x=Math.min(C.hpMax,x+v)}else M<0&&(M=0);l(D,{stress:M,hp:x})}},isEditMode:n,elementType:"adversaries",adversaries:g}),e.jsx("div",{className:"border rounded-lg",style:{backgroundColor:"var(--bg-card)",borderRadius:"8px",padding:"12px",marginTop:"0.5rem",cursor:"pointer",transition:"all 0.1s ease",position:"relative",border:"2px dashed var(--border)",opacity:.8,background:"var(--bg-card)"},onClick:()=>p("adversaries"),onMouseEnter:D=>{D.target.style.opacity="1",D.target.style.borderColor="var(--border-hover)"},onMouseLeave:D=>{D.target.style.opacity="0.8",D.target.style.borderColor="var(--border)"},children:e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",gap:"0.5rem",position:"relative"},children:[e.jsxs("div",{style:{display:"flex",flexDirection:"column",alignItems:"flex-start",gap:"0.25rem"},children:[e.jsx("h4",{style:{fontSize:"16px",fontWeight:"600",color:"var(--text-secondary)",margin:0},children:"Add Adversary"}),e.jsx("span",{style:{fontSize:"0.75rem",fontWeight:500,color:"var(--text-secondary)",letterSpacing:"0.5px"},children:"Click to browse"})]}),e.jsx("div",{style:{display:"flex",alignItems:"center",justifyContent:"center",width:"32px",height:"32px",borderRadius:"50%",border:"1px dashed var(--text-secondary)",color:"var(--text-secondary)"},children:e.jsx(Q,{size:16})})]})})]})})};function lr({headerSelector:r=".drawer-header",closeThreshold:t=100,snapThreshold:i=30,onClose:p}={}){const[n,a]=j.useState(null),[o,c]=j.useState(null),[d,h]=j.useState(0),[u,s]=j.useState(!1),g=j.useCallback(f=>{var W,N;const k=f.target;if(!(r?k.closest(r):!1))return;const I=((N=(W=f.targetTouches)==null?void 0:W[0])==null?void 0:N.clientY)??0;a(I),c(I),h(0),s(!1)},[r]),m=j.useCallback(f=>{var W,N;if(n==null)return;const k=((N=(W=f.targetTouches)==null?void 0:W[0])==null?void 0:N.clientY)??0,S=k-n,I=6;!u&&Math.abs(S)>I&&s(!0),u&&(f.preventDefault(),f.stopPropagation(),c(k),h(Math.max(0,S)))},[n,u]),l=j.useCallback(f=>{if(n==null||o==null)return;const k=o-n;u?(f.preventDefault(),f.stopPropagation(),k>t?(h(window.innerHeight),typeof p=="function"&&setTimeout(()=>p(),300)):k>i?(h(0),setTimeout(()=>{a(null),c(null),s(!1)},50)):(h(0),a(null),c(null),s(!1))):(h(0),a(null),c(null),s(!1))},[n,o,u,t,i,p]),w=j.useCallback(()=>{h(0),a(null),c(null)},[]);return{drawerOffset:d,setDrawerOffset:h,touchHandlers:{onTouchStart:g,onTouchMove:m,onTouchEnd:l},resetSwipeState:w}}const dr=({isOpen:r,onClose:t,children:i})=>{const{drawerOffset:p,setDrawerOffset:n,touchHandlers:a,resetSwipeState:o}=lr({headerSelector:".drawer-header",closeThreshold:100,snapThreshold:30,onClose:t});return j.useEffect(()=>{r||o()},[r,o]),e.jsxs("div",{className:`mobile-drawer ${r?"open":""}`,children:[e.jsx("div",{className:"drawer-backdrop",onClick:t}),e.jsxs("div",{className:"drawer-content",style:{transform:r?`translateY(${p}px)`:"translateY(100%)",transition:p?"none":"transform 0.25s cubic-bezier(0.4, 0.0, 0.2, 1)"},onTouchStart:c=>{a.onTouchStart(c)},onTouchMove:c=>{a.onTouchMove(c)},onTouchEnd:c=>{a.onTouchEnd(c)},onClick:c=>{c.stopPropagation()},children:[e.jsx("div",{className:"drawer-header",onClick:()=>{n(window.innerHeight),setTimeout(()=>{t()},300)},children:e.jsx("div",{className:"drawer-handle"})}),e.jsx("div",{className:"drawer-body",children:i})]})]})},cr=()=>e.jsx("div",{className:"pwa-install-prompt",style:{}}),pr="modulepreload",ur=function(r){return"/Daggerheart/"+r},xe={},he=function(t,i,p){if(!i||i.length===0)return t();const n=document.getElementsByTagName("link");return Promise.all(i.map(a=>{if(a=ur(a),a in xe)return;xe[a]=!0;const o=a.endsWith(".css"),c=o?'[rel="stylesheet"]':"";if(!!p)for(let u=n.length-1;u>=0;u--){const s=n[u];if(s.href===a&&(!o||s.rel==="stylesheet"))return}else if(document.querySelector(`link[href="${a}"]${c}`))return;const h=document.createElement("link");if(h.rel=o?"stylesheet":pr,o||(h.as="script",h.crossOrigin=""),h.href=a,document.head.appendChild(h),o)return new Promise((u,s)=>{h.addEventListener("load",u),h.addEventListener("error",()=>s(new Error(`Unable to preload CSS for ${a}`)))})})).then(()=>t()).catch(a=>{const o=new Event("vite:preloadError",{cancelable:!0});if(o.payload=a,window.dispatchEvent(o),!o.defaultPrevented)throw a})};let Se={adversaries:[]},ke={environments:[]};const xr=async()=>{try{const r=await he(()=>import("./adversaries-e62ea4d8.js"),[]);Se=(r==null?void 0:r.default)||r}catch(r){console.warn("Failed to load adversaries.json:",r)}try{const r=await he(()=>import("./environments-5ca1c1e1.js"),[]);ke=(r==null?void 0:r.default)||r}catch(r){console.warn("Failed to load environments.json:",r)}},hr=r=>{const[t,i]=j.useState(""),[p,n]=j.useState([{field:"name",direction:"asc"}]),[a,o]=j.useState(null),[c,d]=j.useState([]),[h,u]=j.useState(!0),[s,g]=j.useState([]),[m,l]=j.useState([]),[w,f]=j.useState(!1),[k,S]=j.useState(!1),I=j.useRef(null),W=j.useRef(null);j.useEffect(()=>{(async()=>{await xr(),u(!1);let M=[];r==="adversary"?M=Se.adversaries||[]:r==="environment"&&(M=ke.environments||[]),d(M)})()},[r]);const N=C=>{const M=c.map(x=>x[C]).filter(Boolean);return[...new Set(M)].sort((x,v)=>typeof x=="number"&&typeof v=="number"?x-v:String(x).localeCompare(String(v)))},P=N("tier"),z=N("type"),$=j.useMemo(()=>{let C=c.filter(M=>{var b,E;const x=M.name.toLowerCase().includes(t.toLowerCase())||((b=M.type)==null?void 0:b.toLowerCase().includes(t.toLowerCase()))||((E=M.description)==null?void 0:E.toLowerCase().includes(t.toLowerCase())),v=s.length===0||s.includes(M.tier.toString()),y=m.length===0||m.includes(M.type);return x&&v&&y});return C.sort((M,x)=>{for(const v of p){const{field:y,direction:b}=v;let E=M[y],L=x[y];if(y==="tier")E=parseInt(E)||0,L=parseInt(L)||0;else if(y==="difficulty"){const q=parseInt(E),T=parseInt(L);!isNaN(q)&&!isNaN(T)?(E=q,L=T):!isNaN(q)&&isNaN(T)?(E=q,L=999):isNaN(q)&&!isNaN(T)?(E=999,L=T):(E=String(E||"").toLowerCase(),L=String(L||"").toLowerCase())}else typeof E=="string"&&typeof L=="string"?(E=E.toLowerCase(),L=L.toLowerCase()):(E=String(E||"").toLowerCase(),L=String(L||"").toLowerCase());if(b==="asc"){if(E>L)return 1;if(E<L)return-1}else{if(E<L)return 1;if(E>L)return-1}}return 0}),C},[c,t,p,s,m]),A=C=>{n(M=>{const x=M.findIndex(v=>v.field===C);if(x>=0)if(x===0){const v=[...M];return v[0]={...v[0],direction:v[0].direction==="asc"?"desc":"asc"},v}else{const v=[...M];return v.splice(x,1)[0],[{field:C,direction:"asc"},...v]}else return[{field:C,direction:"asc"},...M]})},R=C=>{o(a===C?null:C)},O=C=>{g(C==="clear"?[]:M=>M.includes(C)?M.filter(x=>x!==C):[...M,C])},V=C=>{l(C==="clear"?[]:M=>M.includes(C)?M.filter(x=>x!==C):[...M,C])},_=s.length>0,D=m.length>0;return j.useEffect(()=>{const C=x=>{const v=x.target.closest(".filter-dropdown"),y=x.target.closest(".header-filter-icon");v||y||(f(!1),S(!1))},M=x=>{x.key==="Escape"&&(f(!1),S(!1))};return document.addEventListener("pointerdown",C,!0),document.addEventListener("mousedown",C,!0),document.addEventListener("touchstart",C,!0),document.addEventListener("click",C,!0),document.addEventListener("keydown",M,!0),()=>{document.removeEventListener("pointerdown",C,!0),document.removeEventListener("mousedown",C,!0),document.removeEventListener("touchstart",C,!0),document.removeEventListener("click",C,!0),document.removeEventListener("keydown",M,!0)}},[f,S]),{searchTerm:t,setSearchTerm:i,sortFields:p,handleSort:A,expandedCard:a,toggleExpanded:R,filteredAndSortedData:$,loading:h,selectedTiers:s,selectedTypes:m,showTierDropdown:w,setShowTierDropdown:f,showTypeDropdown:k,setShowTypeDropdown:S,tierFilterRef:I,typeFilterRef:W,uniqueTiers:P,uniqueTypes:z,handleTierSelect:O,handleTypeSelect:V,isTierFiltered:_,isTypeFiltered:D,getDropdownStyle:C=>{if(!C.current)return{};const M=C.current.getBoundingClientRect();return{position:"fixed",top:M.bottom+4,left:M.left,zIndex:99999}}}},gr=({searchTerm:r,onSearchChange:t,type:i})=>e.jsx("div",{style:H.browserHeader,children:e.jsx("input",{type:"text",placeholder:"Search",value:r,onChange:p=>t(p.target.value),style:H.searchInput})}),fr=({sortFields:r,onSort:t,type:i,uniqueTiers:p,uniqueTypes:n,selectedTiers:a,selectedTypes:o,showTierDropdown:c,setShowTierDropdown:d,showTypeDropdown:h,setShowTypeDropdown:u,tierFilterRef:s,typeFilterRef:g,handleTierSelect:m,handleTypeSelect:l,isTierFiltered:w,isTypeFiltered:f,getDropdownStyle:k})=>{const[S,I]=j.useState(null),N=(()=>i==="adversary"?[{key:"name",label:"Name"},{key:"tier",label:"Tier",hasFilter:!0},{key:"type",label:"Type",hasFilter:!0},{key:"difficulty",label:"Diff"},{key:"action",label:""}]:i==="environment"?[{key:"name",label:"Name"},{key:"tier",label:"Tier",hasFilter:!0},{key:"type",label:"Type",hasFilter:!0},{key:"difficulty",label:"Diff"},{key:"action",label:""}]:[])(),P=(z,$,A,R,O,V,_,D)=>{if(!O)return null;const F=()=>{(z==="tier"||z==="type")&&R("clear")};return fe.createPortal(e.jsxs("div",{className:"filter-dropdown",style:{...H.filterDropdown,...k(_),maxHeight:"60vh",overflow:"auto"},onMouseDown:C=>C.stopPropagation(),onClick:C=>C.stopPropagation(),children:[e.jsxs("div",{style:{...H.filterOption,...A.length===0?H.filterOptionSelected:{}},onClick:F,children:[e.jsx("span",{style:H.checkIcon,children:A.length===0?e.jsx(ie,{size:16}):e.jsx(le,{size:16})}),e.jsx("span",{style:H.filterLabel,children:"All"})]}),$.map(C=>{const M=A.includes(C.toString());return e.jsxs("div",{style:{...H.filterOption,...M?H.filterOptionSelected:{}},onClick:()=>R(C.toString()),children:[e.jsx("span",{style:H.checkIcon,children:M?e.jsx(ie,{size:16}):e.jsx(le,{size:16})}),e.jsx("span",{style:H.filterLabel,children:C})]},C)})]}),document.body)};return e.jsx("tr",{style:H.tableHeader,children:N.map(z=>e.jsxs("th",{style:{...H.tableHeaderCell,...S===z.key?H.tableHeaderCellHover:{},position:"relative",...z.key==="name"?{width:"auto",minWidth:"0"}:{},...z.key==="tier"?{width:"80px",minWidth:"80px",maxWidth:"80px"}:{},...z.key==="type"?{width:"100px",minWidth:"100px",maxWidth:"100px"}:{},...z.key==="difficulty"?{width:"40px",minWidth:"40px",maxWidth:"40px"}:{},...z.key==="action"?{width:"40px",minWidth:"40px",maxWidth:"40px"}:{}},onClick:()=>t(z.key),onMouseEnter:()=>I(z.key),onMouseLeave:()=>I(null),children:[z.hasFilter?e.jsxs("div",{style:H.headerWithFilter,children:[e.jsx("span",{style:{cursor:"pointer"},onClick:$=>{$.stopPropagation(),t(z.key)},children:z.label}),e.jsxs("button",{ref:z.key==="tier"?s:g,style:{...H.headerFilterIcon,...z.key==="tier"&&w?H.headerFilterIconActive:{},...z.key==="type"&&f?H.headerFilterIconActive:{}},className:"header-filter-icon",onClick:$=>{$.stopPropagation(),z.key==="tier"?(d(!c),u(!1)):z.key==="type"&&(u(!h),d(!1))},children:[e.jsx(Te,{size:14}),z.key==="tier"&&w||z.key==="type"&&f?e.jsx("span",{style:H.filterActiveDot}):null]})]}):z.label,z.key==="tier"&&P("tier",p,a,m,c,d,s),z.key==="type"&&P("type",n,o,l,h,u,g)]},z.key))})},mr=({item:r,isExpanded:t,onToggleExpanded:i,onAdd:p,type:n})=>{const[a,o]=j.useState(!1),c=()=>{p(r)},d=()=>n==="adversary"?e.jsxs(e.Fragment,{children:[e.jsx("td",{style:{...H.rowCell,width:"auto",minWidth:"0",textAlign:"left"},children:r.name}),e.jsx("td",{style:{...H.rowCell,width:"80px",minWidth:"80px",maxWidth:"80px",textAlign:"center"},children:r.tier}),e.jsx("td",{style:{...H.rowCell,width:"100px",minWidth:"100px",maxWidth:"100px",textAlign:"center"},children:r.type}),e.jsx("td",{style:{...H.rowCell,width:"40px",minWidth:"40px",maxWidth:"40px",textAlign:"center"},children:r.difficulty})]}):n==="environment"?e.jsxs(e.Fragment,{children:[e.jsx("td",{style:{...H.rowCell,width:"auto",minWidth:"0",textAlign:"left"},children:r.name}),e.jsx("td",{style:{...H.rowCell,width:"80px",minWidth:"80px",maxWidth:"80px",textAlign:"center"},children:r.tier}),e.jsx("td",{style:{...H.rowCell,width:"100px",minWidth:"100px",maxWidth:"100px",textAlign:"center"},children:r.type}),e.jsx("td",{style:{...H.rowCell,width:"40px",minWidth:"40px",maxWidth:"40px",textAlign:"center"},children:r.difficulty})]}):null;return e.jsxs(e.Fragment,{children:[e.jsxs("tr",{style:{...H.row,...a?H.rowHover:{}},onClick:()=>i(r.id),onMouseEnter:()=>o(!0),onMouseLeave:()=>o(!1),children:[d(),e.jsx("td",{style:{width:"40px",minWidth:"40px",maxWidth:"40px",textAlign:"center",padding:"0",margin:"0",border:"none",verticalAlign:"middle",boxSizing:"border-box",overflow:"visible",textOverflow:"unset",whiteSpace:"nowrap"},children:e.jsx("button",{style:H.addButton,onClick:h=>{h.stopPropagation(),c()},onMouseEnter:h=>{h.target.style.background="var(--gray-700)"},onMouseLeave:h=>{h.target.style.background="var(--purple)"},children:"+"})})]}),t&&e.jsx("tr",{style:H.expandedRow,children:e.jsx("td",{colSpan:"5",style:H.expandedContent,children:e.jsx(G,{item:r,type:n,mode:"expanded",onClick:()=>{},onDelete:()=>{}})})})]})},ge=({type:r,onAddItem:t,onCancel:i})=>{const{searchTerm:p,setSearchTerm:n,sortFields:a,handleSort:o,expandedCard:c,toggleExpanded:d,filteredAndSortedData:h,loading:u,selectedTiers:s,selectedTypes:g,showTierDropdown:m,setShowTierDropdown:l,showTypeDropdown:w,setShowTypeDropdown:f,tierFilterRef:k,typeFilterRef:S,uniqueTiers:I,uniqueTypes:W,handleTierSelect:N,handleTypeSelect:P,isTierFiltered:z,isTypeFiltered:$,getDropdownStyle:A}=hr(r);return u?e.jsx("div",{style:H.browser,children:e.jsx("div",{style:H.loading,children:"Loading..."})}):e.jsxs("div",{style:H.browserWrapper,children:[e.jsx(gr,{searchTerm:p,onSearchChange:n,type:r}),e.jsx("div",{className:"browser-content",style:H.browserContent,children:e.jsxs("table",{style:H.browserTable,children:[e.jsx("thead",{children:e.jsx(fr,{sortFields:a,onSort:o,type:r,uniqueTiers:I,uniqueTypes:W,selectedTiers:s,selectedTypes:g,showTierDropdown:m,setShowTierDropdown:l,showTypeDropdown:w,setShowTypeDropdown:f,tierFilterRef:k,typeFilterRef:S,handleTierSelect:N,handleTypeSelect:P,isTierFiltered:z,isTypeFiltered:$,getDropdownStyle:A})}),e.jsx("tbody",{children:h.map(R=>e.jsx(mr,{item:R,isExpanded:c===R.id,onToggleExpanded:d,onAdd:t,type:r},R.id))})]})})]})},H={browserWrapper:{display:"flex",flexDirection:"column",background:"var(--bg-primary)",borderRadius:"var(--radius-md)",border:"1px solid var(--border)",overflow:"hidden",height:"100%",width:"100%",position:"relative"},browserContent:{flex:1,overflowY:"auto",overflowX:"visible",padding:0,width:"100%"},tableHeaderContainer:{flexShrink:0,position:"sticky",top:0,zIndex:15,backgroundColor:"var(--gray-800)"},browserTable:{width:"100%",minWidth:"100%",borderCollapse:"collapse",tableLayout:"fixed",background:"var(--bg-primary)",margin:0},browserHeader:{display:"flex",justifyContent:"space-between",alignItems:"center",padding:"16px",borderBottom:"1px solid var(--border)",backgroundColor:"var(--bg-secondary)",flexShrink:0,position:"sticky",top:0,zIndex:20},browserTitle:{margin:0,color:"var(--text-primary)",fontSize:"18px",fontWeight:"600"},closeButton:{background:"none",border:"none",color:"var(--text-primary)",fontSize:"24px",cursor:"pointer",padding:"4px 8px",borderRadius:"4px",transition:"background-color 0.2s"},searchInput:{flex:1,padding:"8px 12px",border:"1px solid var(--border)",borderRadius:"4px",backgroundColor:"var(--bg-primary)",color:"var(--text-primary)",fontSize:"14px",marginRight:"12px",transition:"all 0.2s ease"},searchInputFocus:{outline:"none",borderColor:"var(--purple)",boxShadow:"0 0 0 3px rgba(139, 92, 246, 0.1)"},tableHeader:{background:"var(--gray-800)",borderBottom:"1px solid var(--border)",boxShadow:"0 1px 0 var(--border)",position:"sticky",top:"0",zIndex:10},tableHeaderCell:{backgroundColor:"var(--gray-800)",fontWeight:"700",borderBottom:"1px solid var(--border)",cursor:"pointer",userSelect:"none",minWidth:"100px",whiteSpace:"nowrap",padding:"4px 4px",color:"var(--text-primary)",textShadow:"0 1px 2px rgba(0, 0, 0, 0.3)",boxShadow:"0 1px 0 var(--border)",transition:"background-color 0.2s",position:"sticky",top:"0",zIndex:10},tableHeaderCellHover:{backgroundColor:"var(--bg-hover)"},sortIndicator:{fontSize:"12px",color:"var(--text-secondary)"},tableBody:{flex:1,overflowY:"auto",padding:"8px",backgroundColor:"var(--gray-800)"},row:{height:"35px",borderBottom:"1px solid var(--border)",transition:"background-color 0.2s ease",cursor:"pointer"},rowHover:{backgroundColor:"var(--bg-hover)"},expandedRow:{backgroundColor:"var(--bg-secondary)"},rowCell:{padding:"4px 4px",verticalAlign:"middle",color:"var(--text-primary)",whiteSpace:"nowrap",overflow:"hidden",textOverflow:"ellipsis",borderBottom:"1px solid var(--border)"},rowCellName:{fontWeight:"500",minWidth:"150px"},rowCellCenter:{textAlign:"center",justifyContent:"center",minWidth:"80px"},rowActions:{width:"80px",textAlign:"center",padding:"4px 8px",borderBottom:"1px solid var(--border)"},addButton:{width:"1.5rem",height:"1.5rem",border:"1px solid var(--purple)",borderRadius:"var(--radius-sm)",background:"var(--purple)",color:"white",cursor:"pointer",transition:"all 0.2s ease",display:"inline-flex",alignItems:"center",justifyContent:"center",fontSize:"14px",fontWeight:"500"},expandedContent:{padding:"16px",backgroundColor:"var(--bg-secondary)",borderBottom:"1px solid var(--border)"},columnName:{width:"auto",minWidth:"0",overflow:"hidden",textOverflow:"ellipsis",paddingLeft:"8px",textAlign:"left"},columnTier:{width:"80px",textAlign:"center",overflow:"visible",textOverflow:"unset"},columnType:{width:"100px",overflow:"hidden",textOverflow:"ellipsis",textAlign:"center"},columnDifficulty:{width:"40px",textAlign:"center",overflow:"visible",textOverflow:"unset"},columnAction:{width:"24px",minWidth:"24px",maxWidth:"24px",textAlign:"center",padding:"0",margin:"0",border:"none",verticalAlign:"middle",color:"var(--text-primary)",whiteSpace:"nowrap",overflow:"visible",textOverflow:"unset"},loading:{display:"flex",justifyContent:"center",alignItems:"center",height:"200px",color:"var(--text-primary)",fontSize:"16px"},mobileBrowser:{width:"95vw",height:"90vh",maxWidth:"none"},mobileSearchInput:{fontSize:"16px"},headerWithFilter:{display:"flex",alignItems:"center",justifyContent:"center",gap:"4px",position:"relative"},headerFilterIcon:{background:"none",border:"none",color:"var(--text-secondary)",cursor:"pointer",padding:"2px 4px",borderRadius:"var(--radius-sm)",display:"flex",alignItems:"center",justifyContent:"center",transition:"all 0.2s ease",position:"relative"},headerFilterIconActive:{color:"var(--purple)"},filterIcon:{fontSize:"12px"},filterActiveDot:{position:"absolute",left:"50%",top:"2px",transform:"translateX(-50%)",width:"4px",height:"4px",borderRadius:"50%",background:"var(--purple)",pointerEvents:"none"},filterDropdown:{position:"absolute",top:"100%",left:"0",background:"var(--bg-secondary)",border:"1px solid var(--border)",borderRadius:"var(--radius-md)",boxShadow:"0 8px 24px rgba(0, 0, 0, 0.25)",zIndex:99999,marginTop:"4px",overflow:"hidden",width:"max-content",minWidth:"120px",maxWidth:"200px"},filterOption:{padding:"8px 12px",cursor:"pointer",color:"var(--text-primary)",fontSize:"14px",display:"flex",alignItems:"center",gap:"8px",borderBottom:"1px solid rgba(255,255,255,0.06)",transition:"background-color 0.2s ease",whiteSpace:"nowrap",overflow:"hidden",textOverflow:"ellipsis"},filterOptionSelected:{backgroundColor:"var(--bg-hover)"},checkIcon:{width:"16px",height:"16px",display:"inline-flex",alignItems:"center",justifyContent:"center",color:"var(--text-secondary)",fontSize:"12px"},filterLabel:{flex:1}},yr=({isOpen:r,onClose:t,triggerPosition:i={x:0,y:0},items:p=[],radius:n=80,angleOffset:a=-90})=>{const o=j.useRef(null),[c,d]=j.useState({x:0,y:0}),[h,u]=j.useState(n);if(j.useEffect(()=>{if(!r||!o.current)return;o.current;const m=window.innerWidth,l=window.innerHeight,w={left:i.x-n,right:i.x+n,top:i.y-n,bottom:i.y+n};let f=i.x,k=i.y,S=n;w.left<0?f=n+10:w.right>m&&(f=m-n-10),w.top<0?k=n+10:w.bottom>l&&(k=l-n-10);const I=Math.min(f,m-f)-10,W=Math.min(k,l-k)-10,N=Math.min(I,W);N<n&&(S=Math.max(N,40)),d({x:f,y:k}),u(S)},[r,i,n]),j.useEffect(()=>{if(!r)return;const m=w=>{o.current&&!o.current.contains(w.target)&&t()},l=w=>{w.key==="Escape"&&t()};return document.addEventListener("mousedown",m),document.addEventListener("keydown",l),()=>{document.removeEventListener("mousedown",m),document.removeEventListener("keydown",l)}},[r,t]),!r)return null;const s=360/p.length,g=a;return e.jsxs("div",{ref:o,className:"radial-menu",style:{position:"fixed",left:c.x,top:c.y,transform:"translate(-50%, -50%)",zIndex:1e3,pointerEvents:"auto"},children:[e.jsx("div",{className:"radial-menu-center"}),p.map((m,l)=>{const f=(g+l*s)*Math.PI/180,k=Math.cos(f)*h,S=Math.sin(f)*h;return e.jsx("button",{className:"radial-menu-item",style:{position:"absolute",left:"50%",top:"50%",transform:`translate(calc(-50% + ${k}px), calc(-50% + ${S}px))`,width:"48px",height:"48px",borderRadius:"50%",border:"none",background:"var(--bg-secondary)",color:"var(--text-primary)",cursor:"pointer",display:"flex",alignItems:"center",justifyContent:"center",boxShadow:"0 4px 12px rgba(0, 0, 0, 0.3)",transition:"all 0.2s ease",fontSize:"18px",zIndex:1001},onClick:I=>{I.stopPropagation(),m.onClick&&m.onClick(),t()},onMouseEnter:I=>{I.target.style.background="var(--purple)",I.target.style.transform=`translate(calc(-50% + ${k}px), calc(-50% + ${S}px)) scale(1.1)`},onMouseLeave:I=>{I.target.style.background="var(--bg-secondary)",I.target.style.transform=`translate(calc(-50% + ${k}px), calc(-50% + ${S}px)) scale(1)`},title:m.title||m.label,children:m.icon||m.label},l)})]})},vr=()=>{const[r,t]=j.useState(!1),[i,p]=j.useState({x:0,y:0}),n=o=>{o.preventDefault(),p({x:o.clientX,y:o.clientY}),t(!0)},a=[{icon:e.jsx(Q,{size:20}),label:"Add",title:"Add new item",onClick:()=>console.log("Add clicked")},{icon:e.jsx(Be,{size:20}),label:"Edit",title:"Edit item",onClick:()=>console.log("Edit clicked")},{icon:e.jsx(He,{size:20}),label:"Copy",title:"Copy item",onClick:()=>console.log("Copy clicked")},{icon:e.jsx(Ne,{size:20}),label:"Share",title:"Share item",onClick:()=>console.log("Share clicked")},{icon:e.jsx(Pe,{size:20}),label:"View",title:"View details",onClick:()=>console.log("View clicked")},{icon:e.jsx(Fe,{size:20}),label:"Settings",title:"Item settings",onClick:()=>console.log("Settings clicked")}];return e.jsxs("div",{style:{width:"100vw",height:"100vh",background:"var(--bg-primary)",display:"flex",alignItems:"center",justifyContent:"center",flexDirection:"column",gap:"2rem",padding:"2rem",boxSizing:"border-box"},onContextMenu:n,children:[e.jsx("h1",{style:{color:"var(--text-primary)",textAlign:"center"},children:"Radial Menu Demo"}),e.jsxs("div",{style:{background:"var(--bg-secondary)",padding:"2rem",borderRadius:"8px",border:"1px solid var(--border)",textAlign:"center",maxWidth:"400px"},children:[e.jsx("p",{style:{color:"var(--text-secondary)",marginBottom:"1rem"},children:"Right-click anywhere on this page to open the radial menu."}),e.jsx("p",{style:{color:"var(--text-secondary)",fontSize:"0.9rem"},children:"The menu will automatically position itself to stay within the viewport bounds."})]}),e.jsxs("div",{style:{display:"grid",gridTemplateColumns:"repeat(auto-fit, minmax(200px, 1fr))",gap:"1rem",width:"100%",maxWidth:"800px"},children:[e.jsxs("div",{style:{background:"var(--bg-card)",padding:"1rem",borderRadius:"8px",border:"1px solid var(--border)",cursor:"pointer",transition:"border-color 0.2s ease"},onContextMenu:n,onMouseEnter:o=>o.target.style.borderColor="var(--border-hover)",onMouseLeave:o=>o.target.style.borderColor="var(--border)",children:[e.jsx("h3",{style:{color:"var(--text-primary)",margin:"0 0 0.5rem 0"},children:"Card 1"}),e.jsx("p",{style:{color:"var(--text-secondary)",margin:0},children:"Right-click me for radial menu"})]}),e.jsxs("div",{style:{background:"var(--bg-card)",padding:"1rem",borderRadius:"8px",border:"1px solid var(--border)",cursor:"pointer",transition:"border-color 0.2s ease"},onContextMenu:n,onMouseEnter:o=>o.target.style.borderColor="var(--border-hover)",onMouseLeave:o=>o.target.style.borderColor="var(--border)",children:[e.jsx("h3",{style:{color:"var(--text-primary)",margin:"0 0 0.5rem 0"},children:"Card 2"}),e.jsx("p",{style:{color:"var(--text-secondary)",margin:0},children:"Right-click me for radial menu"})]}),e.jsxs("div",{style:{background:"var(--bg-card)",padding:"1rem",borderRadius:"8px",border:"1px solid var(--border)",cursor:"pointer",transition:"border-color 0.2s ease"},onContextMenu:n,onMouseEnter:o=>o.target.style.borderColor="var(--border-hover)",onMouseLeave:o=>o.target.style.borderColor="var(--border)",children:[e.jsx("h3",{style:{color:"var(--text-primary)",margin:"0 0 0.5rem 0"},children:"Card 3"}),e.jsx("p",{style:{color:"var(--text-secondary)",margin:0},children:"Right-click me for radial menu"})]}),e.jsxs("div",{style:{background:"var(--bg-card)",padding:"1rem",borderRadius:"8px",border:"1px solid var(--border)",cursor:"pointer",transition:"border-color 0.2s ease"},onContextMenu:n,onMouseEnter:o=>o.target.style.borderColor="var(--border-hover)",onMouseLeave:o=>o.target.style.borderColor="var(--border)",children:[e.jsx("h3",{style:{color:"var(--text-primary)",margin:"0 0 0.5rem 0"},children:"Card 4"}),e.jsx("p",{style:{color:"var(--text-secondary)",margin:0},children:"Right-click me for radial menu"})]})]}),e.jsx(yr,{isOpen:r,onClose:()=>t(!1),triggerPosition:i,items:a,radius:80,angleOffset:-90})]})};function br({selectedItem:r,selectedType:t,countdowns:i,adversaries:p,environments:n,setSelectedItem:a,handleCloseRightColumn:o}){j.useEffect(()=>{if(!r||!t)return;let c=!1;t==="adversaries"||t==="adversary"?c=p.some(d=>d.id===r.id):t==="environments"||t==="environment"?c=n.some(d=>d.id===r.id):(t==="countdowns"||t==="countdown")&&(c=i.some(d=>d.id===r.id)),c||o()},[r,t,i,p,n,a,o]),j.useEffect(()=>{if(!r||!t)return;let c=null;t==="adversaries"||t==="adversary"?c=p.find(d=>d.id===r.id):t==="environments"||t==="environment"?c=n.find(d=>d.id===r.id):(t==="countdowns"||t==="countdown")&&(c=i.find(d=>d.id===r.id)),c&&JSON.stringify(c)!==JSON.stringify(r)&&a(c)},[r,t,i,p,n,a])}class jr extends oe.Component{constructor(t){super(t),this.state={hasError:!1,error:null}}static getDerivedStateFromError(t){return{hasError:!0,error:t}}componentDidCatch(t,i){console.error("ErrorBoundary caught an error:",t,i)}render(){var t;return this.state.hasError?e.jsxs("div",{className:"p-md text-red",children:[e.jsx("h3",{children:"Something went wrong:"}),e.jsx("pre",{children:(t=this.state.error)==null?void 0:t.toString()}),e.jsx("button",{className:"btn-base btn-text",onClick:()=>this.setState({hasError:!1,error:null}),children:"Try again"})]}):this.props.children}}const wr=()=>{const{adversaries:r,environments:t,countdowns:i,fear:p,updateFear:n,createAdversary:a,updateAdversary:o,deleteAdversary:c,createEnvironment:d,updateEnvironment:h,deleteEnvironment:u,createCountdown:s,deleteCountdown:g,advanceCountdown:m}=Ce(),[l,w]=j.useState(null),[f,k]=j.useState(null),[S,I]=j.useState(null),[W,N]=j.useState("unified"),[P,z]=j.useState(!1),[$,A]=j.useState(!1),[R]=j.useState("left"),[O,V]=j.useState(!0);j.useState(!1);const[_,D]=j.useState(null),[F,C]=j.useState(!1),M=(T,X)=>{j.startTransition(()=>{l&&l.id===T.id&&f===X&&S==="item"?(w(null),k(null),I(null),P&&C(!1)):(w(T),k(X),I("item"),P&&C(!0))})},x=(T="unified")=>{let X=T;T==="adversaries"?X="adversary":T==="environments"&&(X="environment"),S==="database"&&W===X?j.startTransition(()=>{I(null),N("unified"),P&&C(!1)}):j.startTransition(()=>{N(X),I("database"),P&&C(!0)})},v=T=>{i.forEach(X=>{const Y=Ue(X,T);if(Y>0){const U=X.value||0;m(X.id,U+Y)}})},y=()=>{i.forEach(T=>{const X=Je(T);if(X>0){const Y=T.value||0;m(T.id,Y+X)}})},b=j.useCallback(()=>{I(null),w(null),k(null),P&&C(!1)},[P]);j.useEffect(()=>{const T=()=>{const U=P,ee=window.matchMedia("(max-width: 800px)").matches;z(ee),!U&&ee&&(S==="database"||S==="creator"||S==="item")&&C(!0),U&&!ee&&F&&C(!1)};T();const X=window.matchMedia("(max-width: 800px)"),Y=()=>T();return X.addEventListener("change",Y),()=>X.removeEventListener("change",Y)},[P,S,F]),j.useEffect(()=>(F||P&&l?(document.body.classList.add("mobile-drawer-open"),document.documentElement.classList.add("mobile-drawer-open")):(document.body.classList.remove("mobile-drawer-open"),document.documentElement.classList.remove("mobile-drawer-open")),()=>{document.body.classList.remove("mobile-drawer-open"),document.documentElement.classList.remove("mobile-drawer-open")}),[P,F,l]),br({selectedItem:l,selectedType:f,countdowns:i,adversaries:r,environments:t,setSelectedItem:w,handleCloseRightColumn:b});const{handleAdversaryDamage:E,handleAdversaryHealing:L,handleAdversaryStressChange:q}=Qe({adversaries:r,updateAdversary:o,deleteAdversary:c,selectedItem:l,setSelectedItem:w});return e.jsxs("div",{className:"app",onClick:T=>{T.target===T.currentTarget&&b()},children:[e.jsx(pe,{position:"top",style:{display:"flex",alignItems:"center",justifyContent:"center",height:"var(--topbar-height)",touchAction:"manipulation",userSelect:"none"},children:e.jsx(K,{type:"fear",value:(p==null?void 0:p.value)||0,maxValue:12,onChange:n,showTooltip:!1,enableBoundaryClick:!0,clickContainerWidth:"100%",centerPips:!0})}),e.jsx("div",{className:"bottom-bar-container",children:e.jsxs(pe,{position:"bottom",children:[e.jsx(sr,{isEditMode:$,setIsEditMode:A}),e.jsx(or,{adversaries:r,environments:t,countdowns:i,deleteAdversary:c,deleteEnvironment:u,deleteCountdown:g}),e.jsx(nr,{})]})}),e.jsxs("div",{className:"main-content",children:[e.jsx(ue,{side:"left",className:`${P&&R==="right"?"mobile-hidden":""}`,children:e.jsx(ir,{onItemSelect:M,selectedItem:l,selectedType:f,onOpenDatabase:x,isEditMode:$,onEditModeChange:A,showLongTermCountdowns:O,fear:p,updateFear:n,handleRollOutcome:v,handleActionRoll:y,setShowLongTermCountdowns:V,lastAddedItemType:_})}),e.jsxs(ue,{side:"right",className:`${P&&R==="left"?"mobile-hidden":""}`,style:S==="database"?{overflowY:"hidden"}:{},children:[S==="database"&&e.jsx("div",{className:"database-display",children:e.jsx(ge,{type:W,onAddItem:T=>{W==="adversary"?(a(T),D("adversary")):W==="environment"&&(d(T),D("environment"))},onCancel:b})}),S==="item"&&l&&e.jsx(G,{type:f,item:l,mode:$?"edit":"expanded",onApplyDamage:E,onApplyHealing:L,onApplyStressChange:q,onUpdate:f==="adversaries"?o:f==="environments"?h:updateCountdown,adversaries:r}),!S&&e.jsx("div",{})]})]},`mobile-${P}`),P&&e.jsxs(dr,{isOpen:F,onClose:b,children:[S==="database"&&e.jsx("div",{className:"browser-container",children:e.jsx(ge,{type:W,onAddItem:T=>{W==="adversary"?(a(T),D("adversary")):W==="environment"&&(d(T),D("environment"))},onCancel:b})}),S==="item"&&l&&e.jsx("div",{className:"expanded-content",children:e.jsx(G,{type:f,item:l,mode:$?"edit":"expanded",onApplyDamage:E,onApplyHealing:L,onApplyStressChange:q,onUpdate:f==="adversaries"?o:f==="environments"?h:updateCountdown,adversaries:r})})]}),e.jsx(cr,{}),e.jsx(vr,{})]})},Cr=()=>e.jsx(jr,{children:e.jsx(we,{children:e.jsx(wr,{})})});te.createRoot(document.getElementById("root")).render(e.jsx(oe.StrictMode,{children:e.jsx(we,{children:e.jsx(Cr,{})})}));
