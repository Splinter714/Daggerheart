import{r as j,a as me,R as ie}from"./dndkit-57209f9c.js";import{F as Ce,f as Se,a as ke,b as Ie,c as se}from"./fa-b4bcccb0.js";import{D as K,A as ge,C as We,T as Ee,a as ze,S as Te,M as Ae,X as fe,E as De,H as re,L as Be,b as Re,c as Le,F as Me,d as ae,e as le}from"./lucide-76f808be.js";(function(){const n=document.createElement("link").relList;if(n&&n.supports&&n.supports("modulepreload"))return;for(const y of document.querySelectorAll('link[rel="modulepreload"]'))u(y);new MutationObserver(y=>{for(const l of y)if(l.type==="childList")for(const x of l.addedNodes)x.tagName==="LINK"&&x.rel==="modulepreload"&&u(x)}).observe(document,{childList:!0,subtree:!0});function c(y){const l={};return y.integrity&&(l.integrity=y.integrity),y.referrerPolicy&&(l.referrerPolicy=y.referrerPolicy),y.crossOrigin==="use-credentials"?l.credentials="include":y.crossOrigin==="anonymous"?l.credentials="omit":l.credentials="same-origin",l}function u(y){if(y.ep)return;y.ep=!0;const l=c(y);fetch(y.href,l)}})();var ye={exports:{}},te={};/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Ne=j,Pe=Symbol.for("react.element"),Fe=Symbol.for("react.fragment"),He=Object.prototype.hasOwnProperty,Oe=Ne.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,$e={key:!0,ref:!0,__self:!0,__source:!0};function ve(t,n,c){var u,y={},l=null,x=null;c!==void 0&&(l=""+c),n.key!==void 0&&(l=""+n.key),n.ref!==void 0&&(x=n.ref);for(u in n)He.call(n,u)&&!$e.hasOwnProperty(u)&&(y[u]=n[u]);if(t&&t.defaultProps)for(u in n=t.defaultProps,n)y[u]===void 0&&(y[u]=n[u]);return{$$typeof:Pe,type:t,key:l,ref:x,props:y,_owner:Oe.current}}te.Fragment=Fe;te.jsx=ve;te.jsxs=ve;ye.exports=te;var e=ye.exports,oe={},de=me;oe.createRoot=de.createRoot,oe.hydrateRoot=de.hydrateRoot;function ne(t){const n=typeof crypto<"u"&&crypto.randomUUID?crypto.randomUUID():`${Date.now()}-${Math.random().toString(36).slice(2,10)}`;return t?`${t}-${n}`:n}const be=j.createContext();function Ve(t){if(typeof localStorage>"u")return null;try{const n=localStorage.getItem(t);return n==null?null:JSON.parse(n)}catch{return null}}function _e(t,n){if(!(typeof localStorage>"u"))try{localStorage.setItem(t,JSON.stringify(n))}catch{}}const Xe=({children:t})=>{const[n,c]=j.useState({fear:{value:0,visible:!1},countdowns:[],adversaries:[],environments:[]});j.useEffect(()=>{var g,d,s;const a=Ve("daggerheart-game-state");if(a)try{(((g=a.adversaries)==null?void 0:g.length)>0||((d=a.environments)==null?void 0:d.length)>0||((s=a.countdowns)==null?void 0:s.length)>0)&&c(a)}catch(i){console.error("Failed to load saved state:",i)}},[]),j.useEffect(()=>{_e("daggerheart-game-state",n)},[n]);const u=a=>{c(g=>({...g,fear:{...g.fear,value:a}}))},y=()=>{c(a=>({...a,fear:{...a.fear,visible:!a.fear.visible}}))},l=j.useRef(n);j.useEffect(()=>{l.current=n},[n]);const T={gameState:n,updateFear:u,toggleFearVisibility:y,createCountdown:a=>{const g={id:ne("countdown"),name:a.name||"Countdown",max:parseInt(a.max)||1,value:0,visible:!0,type:a.type||"standard",loop:a.loop||"none",source:a.source||"campaign"};c(d=>({...d,countdowns:[...d.countdowns,g]}))},updateCountdown:(a,g)=>{c(d=>({...d,countdowns:d.countdowns.map(s=>s.id===a?{...s,...g}:s)}))},deleteCountdown:a=>{c(g=>({...g,countdowns:g.countdowns.filter(d=>d.id!==a)}))},advanceCountdown:(a,g)=>{c(d=>({...d,countdowns:d.countdowns.map(s=>{if(s.id!==a)return s;let i=g;if(s.loop==="loop")i>s.max?i=(i-1)%s.max+1:i<0&&(i=s.max);else if(s.loop==="increasing"){if(i>s.max)return{...s,max:s.max+1,value:1};if(i<0)return{...s,max:Math.max(1,s.max-1),value:1};i=Math.max(0,i)}else if(s.loop==="decreasing"){if(i>s.max)return{...s,max:Math.max(1,s.max-1),value:1};if(i<0)return{...s,max:s.max+1,value:1};i=Math.min(s.max,i)}else i=Math.max(0,Math.min(i,s.max));return{...s,value:i}})}))},incrementCountdown:(a,g=1)=>{c(d=>({...d,countdowns:d.countdowns.map(s=>{if(s.id!==a)return s;let i=s.value+g;if(s.loop==="loop")i>s.max&&(i=(i-1)%s.max+1);else if(s.loop==="increasing"){if(i>s.max)return{...s,max:s.max+1,value:1}}else if(s.loop==="decreasing"){if(i>s.max)return{...s,max:Math.max(1,s.max-1),value:1}}else i=Math.min(i,s.max);return{...s,value:i}})}))},decrementCountdown:a=>{c(g=>({...g,countdowns:g.countdowns.map(d=>{if(d.id!==a)return d;let s=d.value-1;if(d.loop==="loop")s<0&&(s=d.max);else if(d.loop==="increasing"){if(s<0)return{...d,max:Math.max(1,d.max-1),value:d.max};s=Math.max(0,s)}else if(d.loop==="decreasing"){if(s<0)return{...d,max:d.max+1,value:1}}else s=Math.max(0,s);return{...d,value:s}})}))},reorderCountdowns:a=>{c(g=>{const[d,s]=a,i=[...g.countdowns],[f]=i.splice(d,1);return i.splice(s,0,f),{...g,countdowns:i}})},createAdversary:a=>{const g=ne("adv"),d=n.adversaries||[],s=a.name||"Unknown",i=d.filter(r=>r.baseName===s);let f=1;if(i.length===0)f=1;else{const r=i.map(m=>m.duplicateNumber||1);let p=1;for(;r.includes(p);)p++;f=p}const o={...a,id:g,baseName:s,duplicateNumber:f,name:`${s} (${f})`,hp:0,stress:0,isVisible:!0};c(r=>({...r,adversaries:[...r.adversaries,o]}))},updateAdversary:(a,g)=>{c(d=>({...d,adversaries:d.adversaries.map(s=>{if(s.id===a){const i={...s,...g};if(g.baseName!==void 0){const f=g.baseName,o=i.duplicateNumber||1;i.name=o===1?f:`${f} (${o})`}return i}return s})}))},deleteAdversary:a=>{c(g=>({...g,adversaries:g.adversaries.filter(d=>d.id!==a)}))},reorderAdversaries:a=>{c(g=>{const[d,s]=a,i=[...g.adversaries],[f]=i.splice(d,1);return i.splice(s,0,f),{...g,adversaries:i}})},bulkReorderAdversaries:a=>{c(g=>({...g,adversaries:a}))},createEnvironment:a=>{const g=ne("env"),s=(n.environments||[]).filter(o=>o.name.replace(/\s+\(\d+\)$/,"")===a.name);let i=a.name||"Unknown";if(s.length===0)i=a.name;else if(s.length===1){const o=s[0],r=o.name.replace(/\s+\(\d+\)$/,""),p=n.environments.map(m=>m.id===o.id?{...m,name:`${r} (1)`}:m);c(m=>({...m,environments:p})),i=`${a.name} (2)`}else{const o=s.map(p=>{const m=p.name.match(/\((\d+)\)$/);return m?parseInt(m[1]):null}).filter(p=>p!==null);let r=1;for(;o.includes(r);)r++;i=`${a.name} (${r})`}const f={...a,id:g,name:i,isVisible:!0};c(o=>({...o,environments:[...o.environments,f]}))},updateEnvironment:(a,g)=>{c(d=>({...d,environments:d.environments.map(s=>s.id===a?{...s,...g}:s)}))},deleteEnvironment:a=>{c(g=>({...g,environments:g.environments.filter(d=>d.id!==a)}))},reorderEnvironments:a=>{c(g=>{const[d,s]=a,i=[...g.environments],[f]=i.splice(d,1);return i.splice(s,0,f),{...g,environments:i}})}};return e.jsx(be.Provider,{value:T,children:t})},Ge=()=>{const t=j.useContext(be);if(!t)return console.warn("useGameState: Context not available yet, returning defaults"),{fear:{value:0,visible:!1},countdowns:[],adversaries:[],environments:[],updateFear:()=>{},toggleFearVisibility:()=>{},createCountdown:()=>{},updateCountdown:()=>{},deleteCountdown:()=>{},advanceCountdown:()=>{},incrementCountdown:()=>{},decrementCountdown:()=>{},reorderCountdowns:()=>{},createAdversary:()=>{},updateAdversary:()=>{},deleteAdversary:()=>{},reorderAdversaries:()=>{},createEnvironment:()=>{},updateEnvironment:()=>{},deleteEnvironment:()=>{},reorderEnvironments:()=>{},hasCountdowns:!1,hasAdversaries:!1,hasEnvironments:!1,getCountdownById:()=>null,getAdversaryById:()=>null,getEnvironmentById:()=>null};const{gameState:n,...c}=t;if(!n)return console.warn("useGameState: gameState not available, returning defaults"),{fear:{value:0,visible:!1},countdowns:[],adversaries:[],environments:[],updateFear:()=>{},toggleFearVisibility:()=>{},createCountdown:()=>{},updateCountdown:()=>{},deleteCountdown:()=>{},advanceCountdown:()=>{},incrementCountdown:()=>{},decrementCountdown:()=>{},reorderCountdowns:()=>{},createAdversary:()=>{},updateAdversary:()=>{},deleteAdversary:()=>{},reorderAdversaries:()=>{},createEnvironment:()=>{},updateEnvironment:()=>{},deleteEnvironment:()=>{},reorderEnvironments:()=>{},hasCountdowns:!1,hasAdversaries:!1,hasEnvironments:!1,getCountdownById:()=>null,getAdversaryById:()=>null,getEnvironmentById:()=>null};const{fear:u,countdowns:y,adversaries:l,environments:x}=n;return{gameState:n,fear:u,countdowns:y,adversaries:l,environments:x,...c,hasCountdowns:y.length>0,hasAdversaries:l.length>0,hasEnvironments:x.length>0,getCountdownById:b=>y.find(h=>h.id===b),getAdversaryById:b=>l.find(h=>h.id===b),getEnvironmentById:b=>x.find(h=>h.id===b)}},ce={fear:{icon:Se,maxValue:12,containerStyle:{display:"flex",gap:"0.125rem",alignItems:"center",justifyContent:"center",width:"100%",height:"100%",padding:"0.125rem",maxWidth:"none"},pipStyle:{fontSize:"var(--text-lg)",fontWeight:600,transition:"color 0.3s ease",height:"1.5rem",width:"1.5rem",display:"inline-block",textAlign:"center",lineHeight:"1.5rem",flexShrink:0,imageRendering:"crisp-edges"},filledColor:"var(--purple)",emptyColor:"var(--gray-dark)",tooltipTitle:"Click anywhere in header to adjust fear:",tooltipInstructions:[{text:"Left of boundary:",description:"Click to decrease fear by 1"},{text:"Right of boundary:",description:"Click to increase fear by 1"}]},hp:{icon:ke,maxValue:20,containerStyle:{display:"inline-block",width:"auto",height:"100%",padding:"0.125rem",textAlign:"center"},pipStyle:{fontSize:"var(--text-sm)",fontWeight:600,transition:"color 0.3s ease",height:"1.5rem",width:"1.5rem",display:"inline-block",textAlign:"center",lineHeight:"1.5rem",flexShrink:0},filledColor:"var(--red)",emptyColor:"var(--text-secondary)",tooltipTitle:"Click anywhere to adjust HP:",tooltipInstructions:[{text:"Left of boundary:",description:"Click to decrease HP by 1"},{text:"Right of boundary:",description:"Click to increase HP by 1"}]},stress:{icon:Ie,maxValue:12,containerStyle:{display:"inline-block",width:"auto",height:"100%",padding:"0.125rem",textAlign:"center"},pipStyle:{fontSize:"var(--text-sm)",fontWeight:600,transition:"color 0.3s ease",height:"1.5rem",width:"1.5rem",display:"inline-block",textAlign:"center",lineHeight:"1.5rem",flexShrink:0},filledColor:"var(--gold)",emptyColor:"var(--text-secondary)",tooltipTitle:"Click anywhere to adjust stress:",tooltipInstructions:[{text:"Left of boundary:",description:"Click to decrease stress by 1"},{text:"Right of boundary:",description:"Click to increase stress by 1"}]},countdown:{icon:se,maxValue:6,containerStyle:{display:"inline-block",width:"auto",height:"100%",padding:"0.125rem",textAlign:"center"},pipStyle:{fontSize:"var(--text-sm)",fontWeight:600,transition:"color 0.3s ease",height:"1.5rem",width:"1.5rem",display:"inline-block",textAlign:"center",lineHeight:"1.5rem",flexShrink:0},filledColor:"var(--text-secondary)",emptyColor:"var(--text-secondary)",tooltipTitle:"Click anywhere to adjust countdown:",tooltipInstructions:[{text:"Left of boundary:",description:"Click to decrease countdown by 1"},{text:"Right of boundary:",description:"Click to increase countdown by 1"}]},hpDots:{maxValue:20,containerStyle:{display:"flex",flexWrap:"wrap",gap:"1px",justifyContent:"center",alignItems:"center",maxWidth:"120px"},pipStyle:{width:"8px",height:"8px",borderRadius:"50%",border:"1px solid var(--border)",transition:"background-color 0.5s ease, border-color 0.5s ease, box-shadow 0.5s ease"},filledStyle:{background:"var(--red)",borderColor:"var(--red)",boxShadow:"0 0 4px rgba(239, 68, 68, 0.5)"},emptyStyle:{background:"var(--bg-primary)",borderColor:"var(--border)"},isDots:!0,tooltipTitle:"Click anywhere to adjust HP:",tooltipInstructions:[{text:"Left of boundary:",description:"Click to decrease HP by 1"},{text:"Right of boundary:",description:"Click to increase HP by 1"}]},stressDots:{maxValue:12,containerStyle:{display:"flex",flexWrap:"wrap",gap:"1px",justifyContent:"center",alignItems:"center",maxWidth:"120px"},pipStyle:{width:"8px",height:"8px",borderRadius:"50%",border:"1px solid var(--border)",transition:"background-color 0.5s ease, border-color 0.5s ease, box-shadow 0.5s ease"},filledStyle:{background:"var(--purple)",borderColor:"var(--purple)",boxShadow:"0 0 4px rgba(139, 92, 246, 0.5)"},emptyStyle:{background:"var(--bg-primary)",borderColor:"var(--border)"},isDots:!0,tooltipTitle:"Click anywhere to adjust stress:",tooltipInstructions:[{text:"Left of boundary:",description:"Click to decrease stress by 1"},{text:"Right of boundary:",description:"Click to increase stress by 1"}]},adversaryHP:{icon:K,maxValue:20,containerStyle:{display:"flex",gap:"0px",flexWrap:"wrap",alignContent:"flex-start",rowGap:"0.03125rem",maxWidth:"100%"},pipStyle:{fontSize:"var(--text-sm)",fontWeight:600,transition:"none",cursor:"pointer",width:"1rem",height:"1rem",display:"flex",alignItems:"center",justifyContent:"center",flexShrink:0},filledColor:"var(--red)",emptyColor:"var(--gray-400)",tooltipTitle:"Click to adjust HP:",tooltipInstructions:[{text:"Filled pip:",description:"Click to heal (reduce damage)"},{text:"Empty pip:",description:"Click to take damage"}]},adversaryStress:{icon:ge,maxValue:12,containerStyle:{display:"flex",gap:"0px",flexWrap:"wrap",alignContent:"flex-start",rowGap:"0.03125rem",maxWidth:"100%"},pipStyle:{fontSize:"var(--text-sm)",fontWeight:600,transition:"none",cursor:"pointer",width:"1rem",height:"1rem",display:"flex",alignItems:"center",justifyContent:"center",flexShrink:0},filledColor:"var(--gold)",emptyColor:"var(--gray-400)",tooltipTitle:"Click to adjust stress:",tooltipInstructions:[{text:"Filled pip:",description:"Click to reduce stress"},{text:"Empty pip:",description:"Click to increase stress"}]},countdownDistributed:{icon:se,maxValue:6,containerStyle:{display:"inline-block",width:"auto",height:"100%",padding:"0.125rem",textAlign:"center"},pipStyle:{fontSize:"var(--text-sm)",fontWeight:600,transition:"color 0.3s ease",height:"1.5rem",width:"1.5rem",display:"inline-block",textAlign:"center",lineHeight:"1.5rem",flexShrink:0},filledColor:"var(--text-secondary)",emptyColor:"var(--text-secondary)",tooltipTitle:"Countdown progress:",tooltipInstructions:[{text:"Progress:",description:"Current countdown value"}]}},qe=({type:t="fear",value:n=0,maxValue:c,onChange:u,size:y="lg",showTooltip:l=!0,containerStyle:x={},pipStyle:b={},countdownType:h=null,distributedGroups:I=null,onPipClick:S=null,enableBoundaryClick:z=!1,clickContainerWidth:N="auto",centerPips:C=!0})=>{const[v,R]=j.useState(!1),W=ce[t]||ce.fear,L=c||W.maxValue,E=Math.max(0,Math.min(L,n));let D=W.filledColor;t==="countdown"&&h&&(["progress","dynamic-progress","simple-hope"].includes(h)?D="var(--gold)":["consequence","dynamic-consequence","simple-fear"].includes(h)?D="var(--purple)":["long-term","standard"].includes(h)&&(D="var(--text-secondary)"));const k=(d,s)=>{if(S)S(d,s);else if(u){const i=d+1;u(i)}},F=d=>{if(!z||!u||S)return;d.currentTarget.getBoundingClientRect();const s=d.currentTarget.querySelector(".pip-container");if(!s)return;const i=s.getBoundingClientRect(),f=d.clientX-i.left;if(f<0){E>0&&u(E-1);return}if(f>i.width){E<L&&u(E+1);return}const o=i.width,r=o*.05,p=o-2*r,m=f-r,V=E/L,H=p*V;m<H?E>0&&u(E-1):E<L&&u(E+1)},a=(()=>{if(!I||t!=="countdownDistributed")return[{start:0,end:L,groupIndex:0}];let d=0;return I.map((s,i)=>{const f={start:d,end:d+s,groupIndex:i};return d+=s,f})})(),g=()=>e.jsxs(e.Fragment,{children:[a.map(d=>e.jsx(ie.Fragment,{children:[...Array(d.end-d.start)].map((s,i)=>{const f=d.start+i,o=f<E;if(W.isDots)return e.jsx("div",{style:{...W.pipStyle,...o?W.filledStyle:W.emptyStyle,...b,cursor:u||S?"pointer":"default"},onClick:z?void 0:()=>k(f,o),title:`${f+1} of ${L}`},f);{const r=W.icon,p=r&&typeof r=="object"&&r.iconName,m=o?D:W.emptyColor;return e.jsx("span",{className:`fear-pip ${o?"filled":"empty"}`,style:{...W.pipStyle,color:m,cursor:u||S?"pointer":"default",...b},onClick:z?void 0:()=>k(f,o),title:`${f+1} of ${L}`,children:p?e.jsx(Ce,{icon:r,size:y}):e.jsx(r,{size:16})},f)}})},d.groupIndex)),l&&e.jsx("div",{style:{position:"relative",cursor:"help",pointerEvents:"none"},children:e.jsxs("div",{style:{position:"absolute",bottom:"100%",left:"50%",transform:v?"translateX(-50%) translateY(-5px)":"translateX(-50%)",background:"rgba(15, 23, 42, 0.95)",border:"1px solid var(--gray)",borderRadius:"var(--radius-md)",padding:"var(--space-md)",minWidth:"250px",zIndex:1e3,opacity:v?1:0,visibility:v?"visible":"hidden",transition:"all 0.2s ease",boxShadow:"0 10px 25px rgba(0, 0, 0, 0.5)"},children:[e.jsx("div",{style:{fontWeight:600,color:"var(--gray-200)",marginBottom:"0.75rem",fontSize:"var(--text-sm)"},children:W.tooltipTitle}),W.tooltipInstructions.map((d,s)=>e.jsxs("div",{style:{marginBottom:"0.5rem",fontSize:"0.8rem",color:"var(--gray-300)",lineHeight:1.4},children:[e.jsx("strong",{style:{color:"var(--gray-200)"},children:d.text})," ",d.description]},s))]})})]});return e.jsx("div",{style:{width:N,height:"100%",cursor:u||S?"pointer":"default",touchAction:"manipulation",userSelect:"none",display:C?"flex":"block",alignItems:C?"center":"stretch",justifyContent:C?"center":"flex-start",...x},onClick:d=>{d.stopPropagation(),d.preventDefault(),z&&F(d)},onMouseEnter:()=>R(l),onMouseLeave:()=>R(!1),children:e.jsx("div",{className:"pip-container",style:{...W.containerStyle,width:"auto",height:"100%",padding:"0.125rem",textAlign:"center"},children:g()})})},Ye="/Daggerheart/assets/daggerheart-logo-fe7815ad.svg",Ue=({showFlyout:t,onFlyoutChange:n})=>{const[c,u]=j.useState(!1),[y,l]=j.useState(!1),x=t!==void 0?t:c,b=n||u;return j.useEffect(()=>{const h=I=>{I.target.closest(".help-button")||b(!1)};return document.addEventListener("click",h),()=>document.removeEventListener("click",h)},[b]),j.useEffect(()=>{const h=window.matchMedia("(max-width: 800px)"),I=S=>l(S.matches);return l(h.matches),h.addEventListener("change",I),()=>h.removeEventListener("change",I)},[]),e.jsxs("div",{className:"help-button",style:{position:"relative",display:"flex",alignItems:"center",justifyContent:"center",padding:"0.5rem",color:x?"white":"var(--text-primary)",borderRadius:"50%",cursor:"pointer",transition:"all 0.2s ease",minWidth:"44px",minHeight:"44px",backgroundColor:x?"var(--purple)":"transparent"},onMouseEnter:h=>{x||(h.currentTarget.style.backgroundColor="var(--bg-secondary)")},onMouseLeave:h=>{x||(h.currentTarget.style.backgroundColor="transparent")},onClick:h=>{h.stopPropagation(),b(!x)},title:"Help & Info",children:[e.jsx("div",{style:{width:"20px",height:"20px",display:"flex",alignItems:"center",justifyContent:"center",color:"inherit",backgroundColor:"transparent",border:"none",outline:"none"},children:e.jsx(We,{size:20})}),e.jsxs("div",{style:{position:"absolute",top:"50%",right:"100%",left:"auto",transform:"translateY(-50%)",background:"var(--bg-primary)",border:"1px solid var(--border)",borderRadius:"var(--radius-md)",boxShadow:"0 4px 12px rgba(0, 0, 0, 0.3)",zIndex:1e3,opacity:x?1:0,visibility:x?"visible":"hidden",transition:"opacity 0.2s ease, visibility 0.2s ease, transform 0.2s ease",pointerEvents:x?"auto":"none",minWidth:"280px",maxWidth:y?"calc(100vw - 2rem)":"320px",marginRight:"0.5rem"},children:[e.jsxs("div",{style:{padding:"0.75rem",borderTop:"1px solid rgba(255, 255, 255, 0.1)",borderBottom:"1px solid rgba(255, 255, 255, 0.1)",background:"var(--bg-primary)",maxWidth:"280px"},children:[e.jsx("img",{src:Ye,alt:"Daggerheart Community Content Logo",style:{width:"100%",maxWidth:"200px",height:"auto",margin:"0 auto 0.75rem auto",display:"block"},onError:h=>{console.error("Failed to load Daggerheart logo:",h.target.src),h.target.style.display="none";const I=document.createElement("div");I.style.cssText="text-align: center; margin-bottom: 0.75rem; font-size: 1.5rem; font-weight: bold; color: var(--purple);",I.textContent="⚔️ DAGGERHEART ⚔️",h.target.parentNode.insertBefore(I,h.target)},onLoad:()=>{}}),e.jsxs("div",{style:{fontSize:"0.7rem",lineHeight:1.3,color:"var(--text-secondary)",textAlign:"left",wordWrap:"break-word",overflowWrap:"break-word"},children:[e.jsx("p",{children:"This product includes materials from the Daggerheart System Reference Document 1.0, © Critical Role, LLC, under the terms of the Darrington Press Community Gaming (DPCGL) License."}),e.jsxs("p",{children:["More information can be found at ",e.jsx("a",{href:"https://www.daggerheart.com",target:"_blank",rel:"noopener noreferrer",children:"daggerheart.com"})]}),e.jsx("p",{children:e.jsx("em",{children:"This project is unofficial and not endorsed by Darrington Press or Critical Role."})})]})]}),e.jsx("button",{style:{display:"flex",alignItems:"center",justifyContent:"flex-start",padding:"0.25rem 1rem",color:"var(--text-primary)",border:"none",background:"none",width:"100%",textAlign:"left",cursor:"pointer",transition:"background-color 0.2s ease",fontSize:"0.875rem",minHeight:"32px",borderBottom:"1px solid rgba(255, 255, 255, 0.1)"},onMouseEnter:h=>{h.target.style.backgroundColor="var(--gray-dark)"},onMouseLeave:h=>{h.target.style.backgroundColor="transparent"},onClick:h=>{h.stopPropagation(),b(!1),window.open("https://github.com/Splinter714/Daggerheart","_blank")},children:e.jsx("div",{style:{display:"flex",alignItems:"center",justifyContent:"center",gap:"0.25rem"},children:e.jsx("span",{children:"GitHub"})})}),e.jsx("div",{style:{display:"flex",alignItems:"center",justifyContent:"flex-start",padding:"0.25rem 1rem",color:"var(--text-secondary)",border:"none",background:"none",width:"100%",textAlign:"left",cursor:"default",fontSize:"0.875rem",minHeight:"32px"},children:e.jsx("div",{style:{display:"flex",alignItems:"center",justifyContent:"center",gap:"0.25rem"},children:e.jsxs("span",{children:["Version ","0.2.56 (5d983b9)"]})})})]})]})},Ke=({adversaries:t,environments:n,countdowns:c,deleteAdversary:u,deleteEnvironment:y,deleteCountdown:l,isClearMode:x,setIsClearMode:b,showFlyout:h,onFlyoutChange:I})=>{const[S,z]=j.useState(!1),N=h!==void 0?h:S,C=I||z,v=((t==null?void 0:t.length)||0)>0||((n==null?void 0:n.length)||0)>0||((c==null?void 0:c.length)||0)>0,R=(t||[]).some(k=>(k.hp||0)>=(k.hpMax||1));j.useEffect(()=>{const k=F=>{F.target.closest(".delete-clear-container")||(C(!1),x&&b(!1))};return document.addEventListener("click",k),()=>document.removeEventListener("click",k)},[x,C]),j.useEffect(()=>{x&&!v&&(b(!1),C(!1))},[x,v,b,C]);const W={position:"absolute",top:"50%",right:"100%",left:"auto",transform:"translateY(-50%)",backgroundColor:"var(--bg-secondary)",border:"1px solid var(--border)",borderRadius:"var(--radius-md)",padding:"0.5rem",minWidth:"200px",boxShadow:"0 4px 12px rgba(0, 0, 0, 0.3)",zIndex:1e3,display:N?"block":"none",marginRight:"0.5rem"},L={background:x||N?"var(--red)":"none",border:"none",color:x||N?"white":v?"var(--text-primary)":"var(--text-secondary)",cursor:v?"pointer":"not-allowed",padding:"0.5rem",borderRadius:"50%",display:"flex",alignItems:"center",justifyContent:"center",transition:"all 0.2s",opacity:v?1:.5,minWidth:"44px",minHeight:"44px"},E={background:"none",border:"none",color:"var(--text-primary)",cursor:"pointer",padding:"0.5rem",borderRadius:"var(--radius-sm)",width:"100%",textAlign:"left",display:"flex",alignItems:"center",gap:"0.5rem",transition:"background-color 0.2s"},D={backgroundColor:"var(--bg-hover)"};return e.jsxs("div",{className:"delete-clear-container",style:{position:"relative"},children:[e.jsx("button",{style:L,onClick:k=>{k.stopPropagation(),v&&(x?(b(!1),C(!1)):(b(!0),C(!0)))},title:v?x?"Clear Items":"Enter Clear Mode":"Nothing to clear",children:e.jsx(Ee,{size:20})}),e.jsxs("div",{style:W,children:[t&&t.length>0&&e.jsxs("button",{style:E,onMouseEnter:k=>Object.assign(k.target.style,D),onMouseLeave:k=>Object.assign(k.target.style,E),onClick:k=>{k.stopPropagation(),z(!1),t.forEach(F=>u(F.id))},children:[e.jsx("span",{children:"×"}),e.jsx("span",{children:"All Adversaries"})]}),t&&t.length>0&&R&&e.jsxs("button",{style:E,onMouseEnter:k=>Object.assign(k.target.style,D),onMouseLeave:k=>Object.assign(k.target.style,E),onClick:k=>{k.stopPropagation(),z(!1),t.filter(T=>(T.hp||0)>=(T.hpMax||1)).forEach(T=>u(T.id))},children:[e.jsx("span",{children:"×"}),e.jsx("span",{children:"Dead Adversaries"})]}),n&&n.length>0&&e.jsxs("button",{style:E,onMouseEnter:k=>Object.assign(k.target.style,D),onMouseLeave:k=>Object.assign(k.target.style,E),onClick:k=>{k.stopPropagation(),z(!1),n.forEach(F=>y(F.id))},children:[e.jsx("span",{children:"×"}),e.jsx("span",{children:"All Environments"})]}),c&&c.length>0&&e.jsxs("button",{style:E,onMouseEnter:k=>Object.assign(k.target.style,D),onMouseLeave:k=>Object.assign(k.target.style,E),onClick:k=>{k.stopPropagation(),z(!1),c.forEach(F=>l(F.id))},children:[e.jsx("span",{children:"×"}),e.jsx("span",{children:"All Countdowns"})]})]})]})},Qe=({adversaries:t,onSortAdversaries:n})=>{const[c,u]=j.useState(!1),y=()=>{if(!t||t.length===0)return;u(!0);const x=[...t].sort((b,h)=>{const I={Solo:1,Bruiser:2,Leader:3,Horde:4,Standard:5,Ranged:6,Skulk:7,Support:8,Minion:9,Social:10},S=I[b.type]||999,z=I[h.type]||999;if(S!==z)return S-z;const N=b.name||"",C=h.name||"",v=L=>{const E=L.match(/^(.*)\s\((\d+)\)$/);return E?{base:E[1],num:parseInt(E[2])}:{base:L,num:0}},R=v(N),W=v(C);return R.base<W.base?-1:R.base>W.base?1:R.num-W.num});n(x),setTimeout(()=>{u(!1)},500)},l=t&&t.length>0;return e.jsx("button",{style:{width:"48px",height:"48px",borderRadius:"50%",background:c?"var(--purple)":"var(--bg-secondary)",border:"1px solid var(--border)",color:c?"white":"var(--text-primary)",display:"flex",alignItems:"center",justifyContent:"center",cursor:l?"pointer":"not-allowed",boxShadow:"0 2px 8px rgba(0, 0, 0, 0.2)",transition:"all 0.2s ease",position:"relative",pointerEvents:"auto",opacity:l?1:.5},onClick:y,disabled:!l,title:l?"Sort adversaries by type and name":"No adversaries to sort",children:e.jsx(ze,{size:20})})},Je=({adversaries:t,environments:n,countdowns:c,deleteAdversary:u,deleteEnvironment:y,deleteCountdown:l,isClearMode:x,setIsClearMode:b,sortAdversaries:h,onOpenDatabase:I})=>{const[S,z]=j.useState(!1),[N,C]=j.useState(!1),[v,R]=j.useState(!1);j.useEffect(()=>{const T=a=>{a.target.closest(".floating-menu-container")||(z(!1),C(!1),R(!1),x&&b(!1))};return document.addEventListener("click",T),()=>document.removeEventListener("click",T)},[x,b]),j.useEffect(()=>{S||(C(!1),R(!1),x&&b(!1))},[S,x,b]);const W=T=>{C(T),T&&(R(!1),x&&b(!1))},L=T=>{R(T),T&&C(!1)},D={position:"fixed",bottom:window.matchMedia("(display-mode: standalone)").matches||window.navigator.standalone===!0||document.referrer.includes("android-app://")?"calc(60px + env(safe-area-inset-bottom) + 2rem)":"calc(60px + env(safe-area-inset-bottom) + 1rem)",right:"1rem",zIndex:1100,display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center",pointerEvents:"none",width:"56px",height:"56px"},k={width:"56px",height:"56px",borderRadius:"50%",background:S?"var(--red)":"var(--bg-secondary)",border:"2px solid var(--border)",color:S?"white":"var(--text-primary)",display:"flex",alignItems:"center",justifyContent:"center",cursor:"pointer",boxShadow:"0 4px 12px rgba(0, 0, 0, 0.3)",transition:"all 0.3s ease",pointerEvents:"auto"},F=(T,a)=>{const g=135+T*135/(a-1),d=70,s=g*Math.PI/180,i=Math.cos(s)*d,f=Math.sin(s)*d;return{width:"48px",height:"48px",borderRadius:"50%",background:"var(--bg-secondary)",border:"1px solid var(--border)",color:"var(--text-primary)",display:"flex",alignItems:"center",justifyContent:"center",cursor:"pointer",boxShadow:"0 2px 8px rgba(0, 0, 0, 0.2)",transition:"all 0.3s ease",position:"absolute",pointerEvents:"auto",transform:S?`translate(${i}px, ${f}px)`:"translate(0px, 0px)",opacity:S?1:0,visibility:S?"visible":"hidden"}};return e.jsxs("div",{className:"floating-menu-container",style:D,children:[e.jsxs("div",{style:{position:"absolute",top:"0",left:"0",width:"56px",height:"56px",pointerEvents:"none"},children:[e.jsx("div",{style:F(0,5),children:e.jsx("button",{onClick:T=>{T.stopPropagation(),I("adversaries"),z(!1)},style:{width:"100%",height:"100%",background:"none",border:"none",color:"inherit",cursor:"pointer",display:"flex",alignItems:"center",justifyContent:"center"},title:"Browse Adversaries",children:e.jsx(Te,{size:20})})}),e.jsx("div",{style:F(1,5),children:e.jsx("button",{onClick:T=>{T.stopPropagation(),I("environments"),z(!1)},style:{width:"100%",height:"100%",background:"none",border:"none",color:"inherit",cursor:"pointer",display:"flex",alignItems:"center",justifyContent:"center"},title:"Browse Environments",children:e.jsx(Ae,{size:20})})}),e.jsx("div",{style:F(2,5),children:e.jsx(Ke,{adversaries:t,environments:n,countdowns:c,deleteAdversary:u,deleteEnvironment:y,deleteCountdown:l,isClearMode:x,setIsClearMode:b,showFlyout:v,onFlyoutChange:L})}),e.jsx("div",{style:F(3,5),children:e.jsx(Qe,{adversaries:t,onSortAdversaries:h})}),e.jsx("div",{style:F(4,5),children:e.jsx(Ue,{showFlyout:N,onFlyoutChange:W})})]}),e.jsx("button",{style:k,onClick:T=>{T.stopPropagation(),z(!S)},title:S?"Close Menu":"Open Menu",children:S?e.jsx(fe,{size:24}):e.jsx(De,{size:24})})]})},Ze=({position:t="top",children:n,onClick:c,className:u="",style:y={}})=>{const l=t==="top",x=window.matchMedia("(display-mode: standalone)").matches||window.navigator.standalone===!0||document.referrer.includes("android-app://"),b={background:"var(--bg-primary)",borderTop:l?"none":"1px solid var(--border)",borderBottom:l?"1px solid var(--border)":"none",padding:l?"0.25rem 0":"0.5rem",paddingBottom:l?"0.25rem":x?"calc(0.5rem + env(safe-area-inset-bottom) + 1rem)":"calc(0.5rem + env(safe-area-inset-bottom))",position:l?"relative":"sticky",[l?"top":"bottom"]:0,zIndex:l?10:100,order:l?1:3,flexShrink:0,touchAction:"manipulation",userSelect:"none",display:"flex",flexDirection:l?"column":"row",justifyContent:l?"stretch":"center",alignItems:l?"stretch":"center",gap:l?"0":"1rem",height:l?"auto":"60px",...y};return e.jsx("div",{className:u,style:b,onClick:c,children:n})},pe=({value:t})=>e.jsxs("div",{style:{position:"relative",display:"flex",alignItems:"center",justifyContent:"center",width:"36px",height:"24px"},children:[e.jsx("svg",{width:"32",height:"24",viewBox:"0 0 32 24",fill:"none",stroke:"var(--text-secondary)",strokeWidth:"1",strokeLinecap:"round",strokeLinejoin:"round",style:{position:"absolute"},children:e.jsx("path",{d:"M2 2h20l4 10-4 10H2l4-10-4-10z"})}),e.jsx("span",{style:{position:"absolute",fontSize:"0.7rem",fontWeight:500,color:"var(--text-primary)",textAlign:"center",zIndex:1,left:"45%",top:"50%",transform:"translate(-50%, -50%)"},children:t})]}),_={transitions:{hoverIn:"all 0.1s ease",hoverOut:"all 0.3s ease"},card:{backgroundColor:"var(--bg-card)",borderRadius:"8px",padding:"12px",cursor:"pointer",transition:"all 0.1s ease",position:"relative"},cardHover:{backgroundColor:"var(--bg-card-hover)"},cardDead:{opacity:.6,backgroundColor:"var(--gray-800)",borderColor:"var(--border)"},cardAtMax:{backgroundColor:"var(--success)",borderColor:"var(--success)"},rowMain:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:"8px"},rowTitle:{fontSize:"16px",fontWeight:"600",color:"var(--text-primary)",margin:0},rowMeta:{display:"flex",gap:"8px",alignItems:"center"},badge:{padding:"2px 6px",borderRadius:"3px",fontSize:"10px",fontWeight:"600",textTransform:"uppercase"},typeBadge:{backgroundColor:"var(--purple)",color:"var(--text-primary)"},tierBadge:{backgroundColor:"var(--info)",color:"var(--text-primary)"},damageInputPopup:{position:"absolute",top:0,left:0,right:0,bottom:0,backgroundColor:"rgba(0, 0, 0, 0.8)",display:"flex",alignItems:"center",justifyContent:"center",zIndex:1e3,borderRadius:"8px"},damageInputContent:{backgroundColor:"var(--gray-900)",borderWidth:"1px",borderStyle:"solid",borderColor:"var(--border)",borderRadius:"8px",padding:"8px",display:"flex",flexDirection:"row",gap:"8px",minWidth:"200px",alignItems:"center",position:"absolute",right:"1rem",top:"50%",transform:"translateY(-50%)"},damageInput:{backgroundColor:"var(--gray-900)",borderWidth:"1px",borderStyle:"solid",borderColor:"var(--border)",borderRadius:"4px",padding:"4px 6px",color:"var(--text-primary)",fontSize:"12px",width:"80px",textAlign:"center"},damageIndicators:{display:"flex",gap:"8px",alignItems:"center",justifyContent:"center"},damageDrop:{fontSize:"16px",color:"var(--text-secondary)",cursor:"pointer",transition:"color 0.1s ease"},applyButton:{backgroundColor:"var(--gray-600)",color:"white",borderWidth:"0",borderStyle:"none",borderRadius:"4px",padding:"4px 8px",fontSize:"14px",cursor:"pointer",transition:"background-color 0.1s ease",display:"flex",alignItems:"center",justifyContent:"center",minWidth:"32px",minHeight:"32px"}},et=(t,n,c,u)=>{const[y,l]=j.useState(!1),[x,b]=j.useState("");j.useEffect(()=>{if(y){const C=v=>{v.target.closest(".damage-input-popup")||(l(!1),b(""))};return document.addEventListener("click",C),()=>document.removeEventListener("click",C)}},[y]);const h=C=>{C.stopPropagation(),C.preventDefault();const v=t.hp||0,R=t.hpMax||1,W=C.currentTarget.getBoundingClientRect(),L=C.clientX-W.left,E=W.width/R;Math.floor(L/E)<v?c&&c(t.id,1,t.hp):n&&n(t.id,1,t.hp,t.hpMax)},I=C=>{C.stopPropagation(),C.preventDefault();const v=t.stress||0,R=t.stressMax||1,W=C.currentTarget.getBoundingClientRect(),L=C.clientX-W.left,E=W.width/R;Math.floor(L/E)<v?u&&u(t.id,-1,t.stress,t.stressMax):u&&u(t.id,1,t.stress,t.stressMax)},S=C=>{C.stopPropagation(),(t.thresholds&&t.thresholds.major&&t.thresholds.severe||t.type==="Minion")&&(l(!0),b(t.type==="Minion"?"1":""))},z=()=>{const C=parseInt(x);if(C>0){if(t.type==="Minion")n&&n(t.id,C,t.hp,t.hpMax);else{let v=0;C>=t.thresholds.severe?v=3:C>=t.thresholds.major?v=2:C>=1&&(v=1),n&&n(t.id,v,t.hp,t.hpMax)}l(!1),b("")}};return{showDamageInput:y,damageValue:x,setDamageValue:b,setShowDamageInput:l,handleHpClick:h,handleStressClick:I,handleDifficultyClick:S,applyDamage:z,handleKeyDown:C=>{C.key==="Enter"?z():C.key==="Escape"&&(l(!1),b(""))}}},tt=({item:t,type:n,mode:c="expanded",onClick:u,onDelete:y,onApplyDamage:l,onApplyHealing:x,onApplyStressChange:b,onUpdate:h,adversaries:I=[],isSelected:S=!1,isEditMode:z=!1,instances:N=[],isEmbedded:C=!1})=>{const v=et(t,l,x,b);(n==="adversary"||n==="adversaries")&&v.handleDifficultyClick;const[R,W]=j.useState(!1),L=()=>{W(!0)},E=()=>{W(!1)},D=(i=!1)=>{let f={..._.card};if(S?f.transition="none":f.transition=R?_.transitions.hoverIn:_.transitions.hoverOut,i){const{marginTop:o,...r}=f;f=r}return(R&&c!=="expanded"||S)&&(f={...f,..._.cardHover}),n==="adversary"&&(t.hp||0)>=(t.hpMax||1)&&(f={...f,..._.cardDead}),n==="countdown"&&(t.value||0)>=t.max&&(f={...f,..._.cardAtMax}),f},k=()=>{if(C)return"";let i="border rounded-lg";return(R&&c!=="expanded"||S)&&(i+=" border-hover"),i},F=()=>{var i,f;if(n==="adversary"||n==="adversaries"){const o=t.baseName||((i=t.name)==null?void 0:i.replace(/\s+\(\d+\)$/,""))||"",r=t.duplicateNumber||((f=t.name)!=null&&f.match(/\((\d+)\)$/)?parseInt(t.name.match(/\((\d+)\)$/)[1]):1),p=[...I];return I.some(H=>H.id===t.id)||p.push(t),p.filter(H=>H.baseName===o).length>1?`${o} (${r})`:o}return t.name},T=()=>{const i=[];return t.type&&i.push(e.jsx("span",{style:{..._.badge,..._.typeBadge},children:t.type},"type")),n==="environment"&&t.tier&&i.push(e.jsxs("span",{style:{..._.badge,..._.tierBadge},children:["Tier ",t.tier]},"tier")),i},a=()=>n!=="adversary"||!v.showDamageInput||!(t.thresholds&&t.thresholds.major&&t.thresholds.severe||t.type==="Minion")?null:e.jsx("div",{className:"damage-input-popup",style:_.damageInputPopup,onClick:i=>{i.stopPropagation(),i.target===i.currentTarget&&(n==="adversary"||n==="adversaries")&&(v.setShowDamageInput(!1),v.setDamageValue(""))},children:e.jsxs("div",{className:"border rounded-lg",style:{..._.damageInputContent,borderColor:"var(--border)"},onClick:i=>i.stopPropagation(),children:[e.jsx("input",{type:"number",inputMode:"numeric",enterKeyHint:"done",placeholder:"dmg",min:(t.type==="Minion","0"),value:n==="adversary"||n==="adversaries"?v.damageValue:"",onChange:i=>{(n==="adversary"||n==="adversaries")&&v.setDamageValue(i.target.value)},onKeyDown:n==="adversary"||n==="adversaries"?v.handleKeyDown:void 0,className:"border rounded-sm",style:{..._.damageInput,borderColor:"var(--border)"},autoFocus:!0}),e.jsxs("div",{style:_.damageIndicators,children:[t.type==="Minion"?(()=>{var p,m;const i=parseInt(n==="adversary"||n==="adversaries"?v.damageValue:"0")||0,f=(p=t.features)==null?void 0:p.find(V=>{var H;return(H=V.name)==null?void 0:H.startsWith("Minion (")}),o=f?parseInt(((m=f.name.match(/\((\d+)\)/))==null?void 0:m[1])||"1"):1,r=Math.floor(i/o);return i>=o&&r>0?e.jsxs("span",{style:{..._.damageDrop,color:"var(--red)"},title:`${i} damage can defeat ${r+1} minion${r+1!==1?"s":""} (1 + ${r} additional)`,children:["+",r," additional minion(s)"]}):e.jsx("span",{style:_.damageDrop,title:`${i} damage defeats this minion only`,children:"+0 additional minion(s)"})})():[1,2,3].map(i=>{const f=parseInt(n==="adversary"||n==="adversaries"?v.damageValue:"0")||0;let o=!1;return i===1&&f>=1&&(o=!0),i===2&&f>=t.thresholds.major&&(o=!0),i===3&&f>=t.thresholds.severe&&(o=!0),e.jsx("span",{style:{..._.damageDrop,color:o?"var(--red)":"var(--text-secondary)"},onClick:r=>{r.stopPropagation(),(n==="adversary"||n==="adversaries")&&(i===1?v.setDamageValue("1"):i===2?v.setDamageValue(t.thresholds.major.toString()):i===3&&v.setDamageValue(t.thresholds.severe.toString()))},title:`Click to set damage to ${i===1?"1":i===2?t.thresholds.major:t.thresholds.severe}`,children:e.jsx(K,{size:16})},i)}),e.jsx("button",{style:{..._.applyButton,backgroundColor:"var(--gray-600)"},onClick:i=>{i.stopPropagation(),(n==="adversary"||n==="adversaries")&&(!v.damageValue||parseInt(v.damageValue)<1?(v.setShowDamageInput(!1),v.setDamageValue("")):v.applyDamage())},title:!v.damageValue||parseInt(v.damageValue)<1?"Close damage input":"Apply damage",children:!v.damageValue||parseInt(v.damageValue)<1?e.jsx(fe,{size:16}):e.jsx(Le,{size:16})})]})]})}),g=()=>{var o;const i=(t.hp||0)>=(t.hpMax||1),f=c==="edit";return e.jsxs("div",{className:k(),style:{...D(!0),padding:0,minHeight:"400px",opacity:i?.7:1,backgroundColor:i?"var(--gray-900)":D(!0).backgroundColor,borderColor:i?"color-mix(in srgb, var(--gray-600) 40%, transparent)":S?"var(--purple)":R&&c!=="expanded"?"var(--border-hover)":"var(--border)",borderWidth:"2px",display:"flex",flexDirection:"column",position:"relative"},onClick:u,...c!=="expanded"&&{onMouseEnter:L,onMouseLeave:E},children:[i&&e.jsxs(e.Fragment,{children:[e.jsx("div",{style:{position:"absolute",top:0,left:0,right:0,bottom:0,background:`repeating-linear-gradient(
                45deg,
                transparent,
                transparent 8px,
                var(--gray-600) 1px,
                var(--gray-600) 9px
              )`,pointerEvents:"none",zIndex:9999}}),e.jsx("div",{style:{position:"absolute",top:"50%",left:"50%",transform:"translate(-50%, -50%)",color:"var(--text-secondary)",fontSize:"1rem",fontWeight:600,textTransform:"uppercase",letterSpacing:"0.05em",zIndex:1e4,pointerEvents:"none",textShadow:"1px 1px 2px rgba(0, 0, 0, 0.5)",backgroundColor:"var(--gray-900)",padding:"0.25rem 0.5rem",borderRadius:"0.5rem",border:"0.5px solid var(--gray-600)"},children:"DEFEATED"})]}),e.jsx("div",{className:"border-b",style:{padding:"12px",flexShrink:0,backgroundColor:"var(--bg-card)",borderRadius:"8px 8px 0 0",position:"relative",zIndex:i?1:"auto",borderBottomColor:S?"var(--purple)":"var(--border)"},children:e.jsx("div",{style:{display:"flex",justifyContent:"flex-start",alignItems:"center",position:"relative",zIndex:i?1:"auto"},children:e.jsx("h4",{style:{..._.rowTitle,color:i?"color-mix(in srgb, var(--gray-400) 80%, transparent)":_.rowTitle.color,textAlign:"left",margin:0,fontSize:"1.1rem"},children:((o=t.name)==null?void 0:o.replace(/\s+\(\d+\)$/,""))||t.name})})}),e.jsxs("div",{style:{borderRadius:"0 0 8px 8px"},children:[e.jsx("div",{style:{marginBottom:"1rem",padding:"0 12px 0.75rem 12px",borderBottom:"1px solid var(--border)"},children:e.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:"0.5rem",fontSize:"0.875rem"},children:[e.jsx("div",{style:{display:"flex",alignItems:"center",gap:"1rem",flexWrap:"wrap"},children:e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"0.5rem"},children:[e.jsxs("div",{style:{position:"relative",display:"flex",alignItems:"center",justifyContent:"center",width:"32px",height:"32px"},children:[e.jsx(re,{size:32,style:{color:"var(--text-primary)",transform:"rotate(0deg)"}}),e.jsx("span",{style:{position:"absolute",fontSize:"0.75rem",fontWeight:600,color:"var(--text-primary)",textAlign:"center"},children:t.difficulty||"~"})]}),e.jsx("span",{style:{fontSize:"0.875rem",fontWeight:500},children:"Difficulty"})]})}),(t.atk!==void 0||t.weapon||t.damage)&&e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"1rem",flexWrap:"wrap"},children:[t.atk!==void 0&&e.jsxs("div",{style:{display:"flex",alignItems:"center",justifyContent:"center",position:"relative"},children:[e.jsx(Be,{size:32,strokeWidth:1,style:{color:"var(--text-secondary)"}}),e.jsxs("span",{style:{position:"absolute",fontSize:"0.875rem",fontWeight:600,color:"white",pointerEvents:"none"},children:[t.atk>=0?"+":"",t.atk]})]}),t.weapon&&e.jsxs("span",{children:[e.jsxs("strong",{children:[t.weapon,":"]})," ",t.range||"Melee"]}),t.damage&&e.jsxs("span",{children:[e.jsx("strong",{children:"Damage:"})," ",t.damage]})]}),t.experience&&t.experience.length>0&&e.jsxs("div",{children:[e.jsx("strong",{children:"Experience:"})," ",t.experience.map(r=>typeof r=="string"?r:`${r.name} ${r.modifier>=0?"+":""}${r.modifier}`).join(", ")]})]})}),t.features&&t.features.length>0&&e.jsxs("div",{style:{marginBottom:"1rem",padding:"0 12px"},children:[t.features.filter(r=>r.type==="Passive").length>0&&e.jsxs("div",{style:{marginBottom:"1rem"},children:[e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"0.75rem",marginBottom:"0.75rem"},children:[e.jsx("hr",{style:{flex:1,border:"none",borderTop:"1px solid var(--border)",margin:0}}),e.jsx("h4",{style:{fontSize:"0.875rem",fontWeight:600,color:"white",margin:0,textTransform:"uppercase",letterSpacing:"0.5px",textAlign:"center",minWidth:"80px"},children:"Passives"}),e.jsx("hr",{style:{flex:1,border:"none",borderTop:"1px solid var(--border)",margin:0}})]}),e.jsx("div",{style:{display:"flex",flexDirection:"column",gap:"0.5rem"},children:t.features.filter(r=>r.type==="Passive").map((r,p)=>e.jsxs("div",{style:{fontSize:"0.875rem",lineHeight:1.4,color:"var(--text-secondary)"},children:[e.jsx("span",{style:{fontWeight:600,color:"var(--text-primary)"},children:r.name}),r.description&&e.jsxs("span",{children:[" - ",r.description]})]},p))})]}),t.features.filter(r=>r.type==="Action").length>0&&e.jsxs("div",{style:{marginBottom:"1rem"},children:[e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"0.75rem",marginBottom:"0.75rem"},children:[e.jsx("hr",{style:{flex:1,border:"none",borderTop:"1px solid var(--border)",margin:0}}),e.jsx("h4",{style:{fontSize:"0.875rem",fontWeight:600,color:"white",margin:0,textTransform:"uppercase",letterSpacing:"0.5px",textAlign:"center",minWidth:"80px"},children:"Actions"}),e.jsx("hr",{style:{flex:1,border:"none",borderTop:"1px solid var(--border)",margin:0}})]}),e.jsx("div",{style:{display:"flex",flexDirection:"column",gap:"0.5rem"},children:t.features.filter(r=>r.type==="Action").map((r,p)=>e.jsxs("div",{style:{fontSize:"0.875rem",lineHeight:1.4,color:"var(--text-secondary)"},children:[e.jsx("span",{style:{fontWeight:600,color:"var(--text-primary)"},children:r.name}),r.description&&e.jsxs("span",{children:[" - ",r.description]})]},p))})]}),t.features.filter(r=>r.type==="Reaction").length>0&&e.jsxs("div",{style:{marginBottom:"1rem"},children:[e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"0.75rem",marginBottom:"0.75rem"},children:[e.jsx("hr",{style:{flex:1,border:"none",borderTop:"1px solid var(--border)",margin:0}}),e.jsx("h4",{style:{fontSize:"0.875rem",fontWeight:600,color:"white",margin:0,textTransform:"uppercase",letterSpacing:"0.5px",textAlign:"center",minWidth:"80px"},children:"Reactions"}),e.jsx("hr",{style:{flex:1,border:"none",borderTop:"1px solid var(--border)",margin:0}})]}),e.jsx("div",{style:{display:"flex",flexDirection:"column",gap:"0.5rem"},children:t.features.filter(r=>r.type==="Reaction").map((r,p)=>e.jsxs("div",{style:{fontSize:"0.875rem",lineHeight:1.4,color:"var(--text-secondary)"},children:[e.jsx("span",{style:{fontWeight:600,color:"var(--text-primary)"},children:r.name}),r.description&&e.jsxs("span",{children:[" - ",r.description]})]},p))})]})]})]}),t.type!=="Minion"&&t.thresholds&&e.jsx("div",{style:{marginTop:"1rem",padding:"0.75rem 12px 0 12px",borderTop:"1px solid var(--border)"},children:e.jsxs("div",{style:{display:"flex",alignItems:"center",justifyContent:"center",gap:"0.5rem",fontSize:"0.875rem"},children:[e.jsx("div",{style:{display:"flex",alignItems:"center",justifyContent:"center",gap:"2px",marginTop:"-3px"},children:e.jsx(K,{size:16,style:{color:"var(--red)"}})}),e.jsx(pe,{value:t.thresholds.major||"7"}),e.jsxs("div",{style:{display:"flex",alignItems:"center",justifyContent:"center",gap:"2px",marginTop:"-3px"},children:[e.jsx(K,{size:16,style:{color:"var(--red)"}}),e.jsx(K,{size:16,style:{color:"var(--red)"}})]}),e.jsx(pe,{value:t.thresholds.severe||"14"}),e.jsxs("div",{style:{display:"flex",alignItems:"center",justifyContent:"center",gap:"2px",marginTop:"-3px"},children:[e.jsx(K,{size:16,style:{color:"var(--red)"}}),e.jsx(K,{size:16,style:{color:"var(--red)"}}),e.jsx(K,{size:16,style:{color:"var(--red)"}})]})]})}),N&&N.length>0&&e.jsx("div",{style:{marginTop:"1rem",borderTop:"1px solid var(--border)"},children:N.map((r,p)=>{var m,V;return e.jsx("div",{children:e.jsxs("div",{style:{backgroundColor:"var(--bg-secondary)",borderRadius:"4px",padding:"4px",border:"1px solid var(--border)",marginBottom:"4px",display:"flex",justifyContent:"flex-start",alignItems:"center",gap:"8px"},children:[e.jsx("div",{style:{backgroundColor:"var(--bg-secondary)",borderRadius:"6px",border:"1px solid var(--border-hover)",width:"32px",textAlign:"center",flexShrink:0,padding:"2px"},children:e.jsx("span",{style:{fontSize:"1rem",fontWeight:600,color:"var(--text-primary)"},children:r.duplicateNumber||((V=(m=r.name)==null?void 0:m.match(/\((\d+)\)/))==null?void 0:V[1])||"1"})}),e.jsxs("div",{style:{display:"flex",flexDirection:"column",alignItems:"flex-start",gap:"2px"},children:[e.jsx("div",{style:{display:"flex",alignItems:"center",cursor:"pointer"},onClick:H=>{if(H.stopPropagation(),!l||n!=="adversary")return;H.currentTarget.getBoundingClientRect();const B=H.currentTarget.querySelector(".pip-container");if(!B)return;const P=B.getBoundingClientRect(),G=H.clientX-P.left,$=r.hp||0,U=r.hpMax||1;if(G<0){$>0&&x&&x(r.id,1,$);return}if(G>P.width){$<U&&l(r.id,1,$,U);return}const J=P.width,Q=J*.05,w=J-2*Q,M=G-Q,O=$/U,X=w*O;M<X?$>0&&x&&x(r.id,1,$):$<U&&l(r.id,1,$,U)},children:e.jsx("div",{className:"pip-container",style:{display:"flex",gap:"2px",alignItems:"center"},children:Array.from({length:r.hpMax||1},(H,B)=>e.jsx("span",{style:{fontSize:"0.75rem",color:B<(r.hp||0)?"var(--red)":"var(--text-secondary)",transition:"all 0.1s ease"},children:e.jsx(K,{size:16})},B))})}),r.stressMax>0&&e.jsx("div",{style:{display:"flex",alignItems:"center",cursor:"pointer"},onClick:H=>{if(H.stopPropagation(),!b||n!=="adversary")return;H.currentTarget.getBoundingClientRect();const B=H.currentTarget.querySelector(".pip-container");if(!B)return;const P=B.getBoundingClientRect(),G=H.clientX-P.left,$=r.stress||0,U=r.stressMax;if(G<0){$>0&&b(r.id,-1);return}if(G>P.width){$<U&&b(r.id,1);return}const J=P.width,Q=J*.05,w=J-2*Q,M=G-Q,O=$/U,X=w*O;M<X?$>0&&b(r.id,-1):$<U&&b(r.id,1)},children:e.jsx("div",{className:"pip-container",style:{display:"flex",gap:"2px",alignItems:"center"},children:Array.from({length:r.stressMax},(H,B)=>e.jsx("span",{style:{fontSize:"0.75rem",color:B<(r.stress||0)?"var(--gold)":"var(--text-secondary)",transition:"all 0.1s ease"},children:e.jsx(ge,{size:16})},B))})})]})]},r.id)},r.id)})}),t.motives&&e.jsxs("div",{style:{marginTop:"1rem",padding:"0.75rem 12px 0 12px",borderTop:"1px solid var(--border)"},children:[e.jsx("h3",{style:{fontSize:"1rem",fontWeight:600,color:"var(--text-primary)",margin:"0 0 0.5rem 0"},children:"Motives"}),f?e.jsx("textarea",{style:{width:"100%",minHeight:"80px",padding:"0.5rem",border:"1px solid var(--border)",borderRadius:"0.5rem",backgroundColor:"var(--bg-secondary)",color:"white",fontSize:"0.875rem",lineHeight:1.5,resize:"vertical",fontFamily:"inherit"},value:t.motives,onChange:r=>{h&&h(t.id,{motives:r.target.value})},placeholder:"Enter adversary motives..."}):e.jsx("p",{style:{fontSize:"0.875rem",lineHeight:1.5,color:"var(--text-secondary)",margin:0,whiteSpace:"pre-wrap"},children:t.motives})]}),t.description&&e.jsxs("div",{style:{marginTop:"1rem",padding:"0.75rem 12px 0 12px",borderTop:"1px solid var(--border)"},children:[e.jsx("h3",{style:{fontSize:"1rem",fontWeight:600,color:"var(--text-primary)",margin:"0 0 0.5rem 0"},children:"Description"}),f?e.jsx("textarea",{style:{width:"100%",minHeight:"100px",padding:"0.5rem",border:"1px solid var(--border)",borderRadius:"0.5rem",backgroundColor:"var(--bg-secondary)",color:"white",fontSize:"0.875rem",lineHeight:1.5,resize:"vertical",fontFamily:"inherit"},value:t.description,onChange:r=>{h&&h(t.id,{description:r.target.value})},placeholder:"Enter adversary description..."}):e.jsx("p",{style:{fontSize:"0.875rem",lineHeight:1.5,color:"var(--text-secondary)",margin:0,whiteSpace:"pre-wrap"},children:t.description})]}),a()]})},d=()=>{const f=c==="edit";return e.jsxs("div",{className:k(),style:{...D(!0),padding:0,minHeight:"400px",display:"flex",flexDirection:"column",position:"relative"},onClick:u,...c!=="expanded"&&{onMouseEnter:L,onMouseLeave:E},children:[e.jsx("div",{className:"border-b",style:{padding:"12px",flexShrink:0,backgroundColor:"var(--bg-card)",borderRadius:"8px 8px 0 0",position:"relative"},children:e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",gap:"0.5rem"},children:[e.jsxs("div",{style:{display:"flex",flexDirection:"column",alignItems:"flex-start",gap:"0.25rem"},children:[e.jsx("h2",{style:{fontSize:"1rem",fontWeight:600,color:"var(--text-primary)",margin:0},children:t.name}),e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"0.25rem"},children:[t.tier&&e.jsxs("span",{style:{fontSize:"0.75rem",fontWeight:500,color:"var(--text-secondary)",letterSpacing:"0.5px"},children:["Tier ",t.tier]}),t.type&&e.jsx("span",{style:{fontSize:"0.75rem",fontWeight:500,color:"var(--text-secondary)",letterSpacing:"0.5px"},children:t.type})]})]}),e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"0.5rem"},children:[t.difficulty&&e.jsxs("div",{style:{display:"flex",alignItems:"center",justifyContent:"center",position:"relative"},children:[e.jsx(re,{size:32,strokeWidth:1,style:{color:"var(--text-secondary)"}}),e.jsx("span",{style:{position:"absolute",top:"50%",left:"50%",transform:"translate(-50%, -50%)",fontSize:"0.75rem",fontWeight:700,color:"white",pointerEvents:"none"},children:t.difficulty})]}),!1]})]})}),e.jsxs("div",{style:{flex:1,overflowY:"auto",borderRadius:"0 0 8px 8px"},children:[t.description&&e.jsxs("div",{style:{marginBottom:"1rem",padding:"0 12px 0.75rem 12px",borderBottom:"1px solid var(--border)"},children:[e.jsx("h3",{style:{fontSize:"1rem",fontWeight:600,color:"var(--text-primary)",margin:"0 0 0.5rem 0"},children:"Description"}),f?e.jsx("textarea",{style:{width:"100%",minHeight:"100px",padding:"0.5rem",border:"1px solid var(--border)",borderRadius:"0.5rem",backgroundColor:"var(--bg-secondary)",color:"white",fontSize:"0.875rem",lineHeight:1.5,resize:"vertical",fontFamily:"inherit"},value:t.description,onChange:o=>{h&&h(t.id,{description:o.target.value})},placeholder:"Enter environment description..."}):e.jsx("p",{style:{fontSize:"0.875rem",lineHeight:1.5,color:"var(--text-secondary)",margin:0,whiteSpace:"pre-wrap"},children:t.description})]}),t.impulses&&e.jsxs("div",{style:{marginBottom:"1rem",padding:"0 12px 0.75rem 12px",borderBottom:"1px solid var(--border)"},children:[e.jsx("h3",{style:{fontSize:"1rem",fontWeight:600,color:"var(--text-primary)",margin:"0 0 0.5rem 0"},children:"Impulses"}),e.jsx("p",{style:{fontSize:"0.875rem",lineHeight:1.5,color:"var(--text-secondary)",margin:0,whiteSpace:"pre-wrap"},children:t.impulses})]}),e.jsxs("div",{style:{marginBottom:"1rem",padding:"0 12px 0.75rem 12px",borderBottom:"1px solid var(--border)"},children:[e.jsx("h3",{style:{fontSize:"1rem",fontWeight:600,color:"var(--text-primary)",margin:"0 0 0.5rem 0"},children:"Core Stats"}),e.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:"0.5rem",fontSize:"0.875rem"},children:[e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"1rem",flexWrap:"wrap",fontSize:"0.875rem"},children:[e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"0.5rem"},children:[e.jsxs("div",{style:{position:"relative",display:"flex",alignItems:"center",justifyContent:"center",width:"32px",height:"32px"},children:[e.jsx(re,{size:32,style:{color:"var(--text-primary)",transform:"rotate(0deg)"}}),e.jsx("span",{style:{position:"absolute",fontSize:"0.75rem",fontWeight:600,color:"var(--text-primary)",textAlign:"center"},children:t.difficulty||"~"})]}),e.jsx("span",{style:{fontSize:"0.875rem",fontWeight:500},children:"Difficulty"})]}),e.jsxs("span",{children:[e.jsx("strong",{children:"Type:"})," ",t.type]}),e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"1rem"},children:[e.jsx("span",{children:e.jsx("strong",{children:"Tier:"})}),e.jsxs("div",{style:{display:"flex",alignItems:"center",justifyContent:"center",position:"relative"},children:[e.jsx(Re,{size:32,strokeWidth:1,style:{color:"var(--text-secondary)"}}),e.jsx("span",{style:{position:"absolute",fontSize:"0.875rem",fontWeight:600,color:"white",pointerEvents:"none"},children:t.tier})]})]})]}),t.potentialAdversaries&&t.potentialAdversaries.length>0&&e.jsxs("div",{children:[e.jsx("strong",{children:"Potential Adversaries:"}),e.jsx("div",{style:{marginTop:"0.25rem",display:"flex",flexDirection:"column",gap:"0.125rem"},children:t.potentialAdversaries.map((o,r)=>e.jsxs("div",{style:{fontSize:"0.75rem",color:"var(--text-secondary)",marginLeft:"0.5rem"},children:["• ",o]},r))})]})]})]}),t.features&&t.features.length>0&&e.jsxs("div",{style:{marginBottom:"1rem",padding:"0 12px"},children:[t.features.filter(o=>o.type==="Passive").length>0&&e.jsxs("div",{style:{marginBottom:"1rem"},children:[e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"0.75rem",marginBottom:"0.75rem"},children:[e.jsx("hr",{style:{flex:1,border:"none",borderTop:"1px solid var(--border)",margin:0}}),e.jsx("h4",{style:{fontSize:"0.875rem",fontWeight:600,color:"white",margin:0,textTransform:"uppercase",letterSpacing:"0.5px",textAlign:"center",minWidth:"80px"},children:"Passives"}),e.jsx("hr",{style:{flex:1,border:"none",borderTop:"1px solid var(--border)",margin:0}})]}),e.jsx("div",{style:{display:"flex",flexDirection:"column",gap:"0.75rem"},children:t.features.filter(o=>o.type==="Passive").map((o,r)=>e.jsxs("div",{style:{fontSize:"0.875rem",lineHeight:1.4,color:"var(--text-secondary)"},children:[e.jsx("div",{style:{fontWeight:600,color:"white",marginBottom:"0.25rem"},children:o.name}),e.jsx("div",{style:{marginBottom:"0.25rem"},children:o.description}),o.details&&o.details.length>0&&e.jsxs("div",{style:{marginLeft:"0.5rem"},children:[e.jsx("strong",{children:"Details:"}),e.jsx("ul",{style:{margin:"0.25rem 0 0 0",paddingLeft:"1rem",fontSize:"0.75rem"},children:o.details.map((p,m)=>e.jsx("li",{children:p},m))})]}),o.prompts&&o.prompts.length>0&&e.jsxs("div",{style:{marginLeft:"0.5rem"},children:[e.jsx("strong",{children:"Prompts:"}),e.jsx("ul",{style:{margin:"0.25rem 0 0 0",paddingLeft:"1rem",fontSize:"0.75rem"},children:o.prompts.map((p,m)=>e.jsxs("li",{style:{fontStyle:"italic"},children:['"',p,'"']},m))})]})]},r))})]}),t.features.filter(o=>o.type==="Action").length>0&&e.jsxs("div",{style:{marginBottom:"1rem"},children:[e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"0.75rem",marginBottom:"0.75rem"},children:[e.jsx("hr",{style:{flex:1,border:"none",borderTop:"1px solid var(--border)",margin:0}}),e.jsx("h4",{style:{fontSize:"0.875rem",fontWeight:600,color:"white",margin:0,textTransform:"uppercase",letterSpacing:"0.5px",textAlign:"center",minWidth:"80px"},children:"Actions"}),e.jsx("hr",{style:{flex:1,border:"none",borderTop:"1px solid var(--border)",margin:0}})]}),e.jsx("div",{style:{display:"flex",flexDirection:"column",gap:"0.75rem"},children:t.features.filter(o=>o.type==="Action").map((o,r)=>e.jsxs("div",{style:{fontSize:"0.875rem",lineHeight:1.4,color:"var(--text-secondary)"},children:[e.jsx("div",{style:{fontWeight:600,color:"white",marginBottom:"0.25rem"},children:o.name}),e.jsx("div",{style:{marginBottom:"0.25rem"},children:o.description}),o.details&&o.details.length>0&&e.jsxs("div",{style:{marginLeft:"0.5rem"},children:[e.jsx("strong",{children:"Details:"}),e.jsx("ul",{style:{margin:"0.25rem 0 0 0",paddingLeft:"1rem",fontSize:"0.75rem"},children:o.details.map((p,m)=>e.jsx("li",{children:p},m))})]}),o.prompts&&o.prompts.length>0&&e.jsxs("div",{style:{marginLeft:"0.5rem"},children:[e.jsx("strong",{children:"Prompts:"}),e.jsx("ul",{style:{margin:"0.25rem 0 0 0",paddingLeft:"1rem",fontSize:"0.75rem"},children:o.prompts.map((p,m)=>e.jsxs("li",{style:{fontStyle:"italic"},children:['"',p,'"']},m))})]})]},r))})]}),t.features.filter(o=>o.type==="Reaction").length>0&&e.jsxs("div",{style:{marginBottom:"1rem"},children:[e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"0.75rem",marginBottom:"0.75rem"},children:[e.jsx("hr",{style:{flex:1,border:"none",borderTop:"1px solid var(--border)",margin:0}}),e.jsx("h4",{style:{fontSize:"0.875rem",fontWeight:600,color:"white",margin:0,textTransform:"uppercase",letterSpacing:"0.5px",textAlign:"center",minWidth:"80px"},children:"Reactions"}),e.jsx("hr",{style:{flex:1,border:"none",borderTop:"1px solid var(--border)",margin:0}})]}),e.jsx("div",{style:{display:"flex",flexDirection:"column",gap:"0.75rem"},children:t.features.filter(o=>o.type==="Reaction").map((o,r)=>e.jsxs("div",{style:{fontSize:"0.875rem",lineHeight:1.4,color:"var(--text-secondary)"},children:[e.jsx("div",{style:{fontWeight:600,color:"white",marginBottom:"0.25rem"},children:o.name}),e.jsx("div",{style:{marginBottom:"0.25rem"},children:o.description}),o.details&&o.details.length>0&&e.jsxs("div",{style:{marginLeft:"0.5rem"},children:[e.jsx("strong",{children:"Details:"}),e.jsx("ul",{style:{margin:"0.25rem 0 0 0",paddingLeft:"1rem",fontSize:"0.75rem"},children:o.details.map((p,m)=>e.jsx("li",{children:p},m))})]}),o.prompts&&o.prompts.length>0&&e.jsxs("div",{style:{marginLeft:"0.5rem"},children:[e.jsx("strong",{children:"Prompts:"}),e.jsx("ul",{style:{margin:"0.25rem 0 0 0",paddingLeft:"1rem",fontSize:"0.75rem"},children:o.prompts.map((p,m)=>e.jsxs("li",{style:{fontStyle:"italic"},children:['"',p,'"']},m))})]})]},r))})]})]}),N&&N.length>0&&e.jsx("div",{style:{marginTop:"1rem",borderTop:"1px solid var(--border)"},children:N.map((o,r)=>{var p,m;return e.jsx("div",{children:e.jsxs("div",{style:{backgroundColor:"var(--bg-secondary)",borderRadius:"4px",padding:"8px",border:"1px solid var(--border)",marginBottom:"4px",display:"flex",justifyContent:"space-between",alignItems:"center",gap:"8px"},children:[e.jsx("div",{style:{backgroundColor:"var(--bg-secondary)",borderRadius:"3px",padding:"2px 6px",border:"1px solid var(--border)",minWidth:"24px",textAlign:"center"},children:e.jsx("span",{style:{fontSize:"0.75rem",fontWeight:600,color:"var(--text-primary)"},children:o.duplicateNumber||((m=(p=o.name)==null?void 0:p.match(/\((\d+)\)/))==null?void 0:m[1])||"1"})}),e.jsx("div",{style:{display:"flex",alignItems:"center",justifyContent:"center",flex:1},children:e.jsxs("span",{style:{fontSize:"0.75rem",fontWeight:500,color:"var(--text-secondary)"},children:["Instance ",r+1]})})]},o.id)},o.id)})})]})]})};return(c==="expanded"||c==="edit")&&(n==="adversary"||n==="adversaries")?g():(c==="expanded"||c==="edit")&&(n==="environment"||n==="environments")?d():n==="adversary"||n==="adversaries"||n==="environment"||n==="environments"?null:e.jsxs("div",{className:k(),style:D(!0),children:[e.jsxs("div",{style:_.rowMain,children:[e.jsx("h4",{style:_.rowTitle,children:F()}),e.jsx("div",{style:_.rowMeta,children:T()})]}),e.jsxs("p",{style:{color:"var(--text-secondary)",fontSize:"12px",margin:0},children:["Expanded view coming soon for ",n]})]})},rt="modulepreload",nt=function(t){return"/Daggerheart/"+t},xe={},he=function(n,c,u){if(!c||c.length===0)return n();const y=document.getElementsByTagName("link");return Promise.all(c.map(l=>{if(l=nt(l),l in xe)return;xe[l]=!0;const x=l.endsWith(".css"),b=x?'[rel="stylesheet"]':"";if(!!u)for(let S=y.length-1;S>=0;S--){const z=y[S];if(z.href===l&&(!x||z.rel==="stylesheet"))return}else if(document.querySelector(`link[href="${l}"]${b}`))return;const I=document.createElement("link");if(I.rel=x?"stylesheet":rt,x||(I.as="script",I.crossOrigin=""),I.href=l,document.head.appendChild(I),x)return new Promise((S,z)=>{I.addEventListener("load",S),I.addEventListener("error",()=>z(new Error(`Unable to preload CSS for ${l}`)))})})).then(()=>n()).catch(l=>{const x=new Event("vite:preloadError",{cancelable:!0});if(x.payload=l,window.dispatchEvent(x),!x.defaultPrevented)throw l})};let je={adversaries:[]},we={environments:[]};const ot=async()=>{try{const t=await he(()=>import("./adversaries-e62ea4d8.js"),[]);je=(t==null?void 0:t.default)||t}catch(t){console.warn("Failed to load adversaries.json:",t)}try{const t=await he(()=>import("./environments-5ca1c1e1.js"),[]);we=(t==null?void 0:t.default)||t}catch(t){console.warn("Failed to load environments.json:",t)}},it=t=>{const[n,c]=j.useState(""),[u,y]=j.useState([{field:"tier",direction:"asc"},{field:"name",direction:"asc"}]),[l,x]=j.useState([]),[b,h]=j.useState(!0),[I,S]=j.useState([]),[z,N]=j.useState([]),[C,v]=j.useState(!1),[R,W]=j.useState(!1),L=j.useRef(null),E=j.useRef(null);j.useEffect(()=>{(async()=>{await ot(),h(!1);let r=[];t==="adversary"?r=je.adversaries||[]:t==="environment"&&(r=we.environments||[]),x(r)})()},[t]);const D=o=>{const r=l.map(p=>p[o]).filter(Boolean);return[...new Set(r)].sort((p,m)=>typeof p=="number"&&typeof m=="number"?p-m:String(p).localeCompare(String(m)))},k=D("tier"),F=D("type"),T=j.useMemo(()=>{let o=l.filter(r=>{var H,B;const p=r.name.toLowerCase().includes(n.toLowerCase())||((H=r.type)==null?void 0:H.toLowerCase().includes(n.toLowerCase()))||((B=r.description)==null?void 0:B.toLowerCase().includes(n.toLowerCase())),m=I.length===0||I.includes(r.tier.toString()),V=z.length===0||z.includes(r.type);return p&&m&&V});return o.sort((r,p)=>{for(const m of u){const{field:V,direction:H}=m;let B=r[V],P=p[V];if(V==="tier")B=parseInt(B)||0,P=parseInt(P)||0;else if(V==="difficulty"){const G=parseInt(B),$=parseInt(P);!isNaN(G)&&!isNaN($)?(B=G,P=$):!isNaN(G)&&isNaN($)?(B=G,P=999):isNaN(G)&&!isNaN($)?(B=999,P=$):(B=String(B||"").toLowerCase(),P=String(P||"").toLowerCase())}else typeof B=="string"&&typeof P=="string"?(B=B.toLowerCase(),P=P.toLowerCase()):(B=String(B||"").toLowerCase(),P=String(P||"").toLowerCase());if(H==="asc"){if(B>P)return 1;if(B<P)return-1}else{if(B<P)return 1;if(B>P)return-1}}return 0}),o},[l,n,u,I,z]),a=o=>{y(r=>{const p=r.findIndex(m=>m.field===o);if(p>=0)if(p===0){const m=[...r];return m[0]={...m[0],direction:m[0].direction==="asc"?"desc":"asc"},m}else{const m=[...r];return m.splice(p,1)[0],[{field:o,direction:"asc"},...m]}else return[{field:o,direction:"asc"},...r]})},g=o=>{S(o==="clear"?[]:r=>r.includes(o)?r.filter(p=>p!==o):[...r,o])},d=o=>{N(o==="clear"?[]:r=>r.includes(o)?r.filter(p=>p!==o):[...r,o])},s=I.length>0,i=z.length>0;return j.useEffect(()=>{const o=p=>{const m=p.target.closest(".filter-dropdown"),V=p.target.closest(".header-filter-icon");m||V||(v(!1),W(!1))},r=p=>{p.key==="Escape"&&(v(!1),W(!1))};return document.addEventListener("pointerdown",o,!0),document.addEventListener("mousedown",o,!0),document.addEventListener("touchstart",o,!0),document.addEventListener("click",o,!0),document.addEventListener("keydown",r,!0),()=>{document.removeEventListener("pointerdown",o,!0),document.removeEventListener("mousedown",o,!0),document.removeEventListener("touchstart",o,!0),document.removeEventListener("click",o,!0),document.removeEventListener("keydown",r,!0)}},[v,W]),{searchTerm:n,setSearchTerm:c,sortFields:u,handleSort:a,filteredAndSortedData:T,loading:b,selectedTiers:I,selectedTypes:z,showTierDropdown:C,setShowTierDropdown:v,showTypeDropdown:R,setShowTypeDropdown:W,tierFilterRef:L,typeFilterRef:E,uniqueTiers:k,uniqueTypes:F,handleTierSelect:g,handleTypeSelect:d,isTierFiltered:s,isTypeFiltered:i,getDropdownStyle:o=>{if(!o.current)return{};const r=o.current.getBoundingClientRect();return{position:"fixed",top:r.bottom+4,left:r.left-100,zIndex:99999}}}},st=({searchTerm:t,onSearchChange:n,type:c})=>e.jsx("div",{style:A.browserHeader,children:e.jsx("input",{type:"text",placeholder:"Search",value:t,onChange:u=>n(u.target.value),style:A.searchInput})}),at=({sortFields:t,onSort:n,type:c,uniqueTiers:u,uniqueTypes:y,selectedTiers:l,selectedTypes:x,showTierDropdown:b,setShowTierDropdown:h,showTypeDropdown:I,setShowTypeDropdown:S,tierFilterRef:z,typeFilterRef:N,handleTierSelect:C,handleTypeSelect:v,isTierFiltered:R,isTypeFiltered:W,getDropdownStyle:L})=>{const[E,D]=j.useState(null),F=(()=>c==="adversary"?[{key:"name",label:"Name"},{key:"tier",label:"Tier",hasFilter:!0},{key:"type",label:"Type",hasFilter:!0},{key:"difficulty",label:"Diff"},{key:"action",label:""}]:c==="environment"?[{key:"name",label:"Name"},{key:"tier",label:"Tier",hasFilter:!0},{key:"type",label:"Type",hasFilter:!0},{key:"difficulty",label:"Diff"},{key:"action",label:""}]:[])(),T=(a,g,d,s,i,f,o,r)=>{if(!i)return null;const p=()=>{(a==="tier"||a==="type")&&s("clear")};return me.createPortal(e.jsxs("div",{className:"filter-dropdown",style:{...A.filterDropdown,...L(o),maxHeight:"60vh",overflow:"auto"},onMouseDown:m=>m.stopPropagation(),onClick:m=>m.stopPropagation(),children:[e.jsxs("div",{style:{...A.filterOption,...d.length===0?A.filterOptionSelected:{}},onClick:p,children:[e.jsx("span",{style:A.checkIcon,children:d.length===0?e.jsx(ae,{size:16}):e.jsx(le,{size:16})}),e.jsx("span",{style:A.filterLabel,children:"All"})]}),g.map(m=>{const V=d.includes(m.toString());return e.jsxs("div",{style:{...A.filterOption,...V?A.filterOptionSelected:{}},onClick:()=>s(m.toString()),children:[e.jsx("span",{style:A.checkIcon,children:V?e.jsx(ae,{size:16}):e.jsx(le,{size:16})}),e.jsx("span",{style:A.filterLabel,children:m})]},m)})]}),document.body)};return e.jsx("tr",{style:A.tableHeader,children:F.map(a=>e.jsxs("th",{style:{...A.tableHeaderCell,...E===a.key?A.tableHeaderCellHover:{},position:"relative",...a.key==="name"?{width:"auto",minWidth:"0"}:{},...a.key==="tier"?{width:"80px",minWidth:"80px",maxWidth:"80px"}:{},...a.key==="type"?{width:"100px",minWidth:"100px",maxWidth:"100px"}:{},...a.key==="difficulty"?{width:"40px",minWidth:"40px",maxWidth:"40px"}:{},...a.key==="action"?{width:"40px",minWidth:"40px",maxWidth:"40px"}:{}},onClick:()=>n(a.key),onMouseEnter:()=>D(a.key),onMouseLeave:()=>D(null),children:[a.hasFilter?e.jsxs("div",{style:A.headerWithFilter,children:[e.jsx("span",{style:{cursor:"pointer"},onClick:g=>{g.stopPropagation(),n(a.key)},children:a.label}),e.jsxs("button",{ref:a.key==="tier"?z:N,style:{...A.headerFilterIcon,...a.key==="tier"&&R?A.headerFilterIconActive:{},...a.key==="type"&&W?A.headerFilterIconActive:{}},className:"header-filter-icon",onClick:g=>{g.stopPropagation(),a.key==="tier"?(h(!b),S(!1)):a.key==="type"&&(S(!I),h(!1))},children:[e.jsx(Me,{size:14}),a.key==="tier"&&R||a.key==="type"&&W?e.jsx("span",{style:A.filterActiveDot}):null]})]}):a.label,a.key==="tier"&&T("tier",u,l,C,b,h,z),a.key==="type"&&T("type",y,x,v,I,S,N)]},a.key))})},lt=({item:t,onAdd:n,type:c,onRowClick:u})=>{const[y,l]=j.useState(!1),x=()=>{n(t)},b=()=>c==="adversary"?e.jsxs(e.Fragment,{children:[e.jsx("td",{style:{...A.rowCell,width:"auto",minWidth:"0",textAlign:"left"},children:t.name}),e.jsx("td",{style:{...A.rowCell,width:"80px",minWidth:"80px",maxWidth:"80px",textAlign:"center"},children:t.tier}),e.jsx("td",{style:{...A.rowCell,width:"100px",minWidth:"100px",maxWidth:"100px",textAlign:"center"},children:t.type}),e.jsx("td",{style:{...A.rowCell,width:"40px",minWidth:"40px",maxWidth:"40px",textAlign:"center"},children:t.difficulty})]}):c==="environment"?e.jsxs(e.Fragment,{children:[e.jsx("td",{style:{...A.rowCell,width:"auto",minWidth:"0",textAlign:"left"},children:t.name}),e.jsx("td",{style:{...A.rowCell,width:"80px",minWidth:"80px",maxWidth:"80px",textAlign:"center"},children:t.tier}),e.jsx("td",{style:{...A.rowCell,width:"100px",minWidth:"100px",maxWidth:"100px",textAlign:"center"},children:t.type}),e.jsx("td",{style:{...A.rowCell,width:"40px",minWidth:"40px",maxWidth:"40px",textAlign:"center"},children:t.difficulty})]}):null;return e.jsx(e.Fragment,{children:e.jsxs("tr",{style:{...A.row,...y?A.rowHover:{}},onClick:()=>u&&u(t,c),onMouseEnter:()=>l(!0),onMouseLeave:()=>l(!1),children:[b(),e.jsx("td",{style:{width:"40px",minWidth:"40px",maxWidth:"40px",textAlign:"center",padding:"0",margin:"0",border:"none",verticalAlign:"middle",boxSizing:"border-box",overflow:"visible",textOverflow:"unset",whiteSpace:"nowrap"},children:e.jsx("button",{style:A.addButton,onClick:h=>{h.stopPropagation(),x()},onMouseEnter:h=>{h.target.style.background="var(--bg-secondary)"},onMouseLeave:h=>{h.target.style.background="var(--purple)"},children:"+"})})]})})},dt=({type:t,onAddItem:n,onCancel:c,onRowClick:u})=>{const{searchTerm:y,setSearchTerm:l,sortFields:x,handleSort:b,filteredAndSortedData:h,loading:I,selectedTiers:S,selectedTypes:z,showTierDropdown:N,setShowTierDropdown:C,showTypeDropdown:v,setShowTypeDropdown:R,tierFilterRef:W,typeFilterRef:L,uniqueTiers:E,uniqueTypes:D,handleTierSelect:k,handleTypeSelect:F,isTierFiltered:T,isTypeFiltered:a,getDropdownStyle:g}=it(t);return I?e.jsx("div",{style:A.browser,children:e.jsx("div",{style:A.loading,children:"Loading..."})}):e.jsxs("div",{style:A.browserWrapper,children:[e.jsx(st,{searchTerm:y,onSearchChange:l,type:t}),e.jsx("div",{className:"browser-content",style:A.browserContent,children:e.jsxs("table",{style:A.browserTable,children:[e.jsx("thead",{children:e.jsx(at,{sortFields:x,onSort:b,type:t,uniqueTiers:E,uniqueTypes:D,selectedTiers:S,selectedTypes:z,showTierDropdown:N,setShowTierDropdown:C,showTypeDropdown:v,setShowTypeDropdown:R,tierFilterRef:W,typeFilterRef:L,handleTierSelect:k,handleTypeSelect:F,isTierFiltered:T,isTypeFiltered:a,getDropdownStyle:g})}),e.jsx("tbody",{children:h.map(d=>e.jsx(lt,{item:d,onAdd:n,type:t,onRowClick:u},d.id))})]})})]})},A={browserWrapper:{display:"flex",flexDirection:"column",background:"var(--bg-primary)",borderRadius:"var(--radius-md)",border:"1px solid var(--border)",overflow:"hidden",height:"100%",width:"100%",position:"relative"},browserContent:{flex:1,overflowY:"auto",overflowX:"visible",padding:0,width:"100%"},tableHeaderContainer:{flexShrink:0,position:"sticky",top:0,zIndex:15,backgroundColor:"var(--bg-secondary)"},browserTable:{width:"100%",minWidth:"100%",borderCollapse:"collapse",tableLayout:"fixed",background:"var(--bg-primary)",margin:0},browserHeader:{display:"flex",justifyContent:"space-between",alignItems:"center",padding:"16px",borderBottom:"1px solid var(--border)",backgroundColor:"var(--gray-900)",flexShrink:0,position:"sticky",top:0,zIndex:20},browserTitle:{margin:0,color:"var(--text-primary)",fontSize:"18px",fontWeight:"600"},closeButton:{background:"none",border:"none",color:"var(--text-primary)",fontSize:"24px",cursor:"pointer",padding:"4px 8px",borderRadius:"4px",transition:"background-color 0.2s"},searchInput:{flex:1,padding:"8px 12px",border:"1px solid var(--border)",borderRadius:"4px",backgroundColor:"var(--bg-primary)",color:"var(--text-primary)",fontSize:"14px",marginRight:"12px",transition:"all 0.2s ease"},searchInputFocus:{outline:"none",borderColor:"var(--purple)",boxShadow:"0 0 0 3px rgba(139, 92, 246, 0.1)"},tableHeader:{background:"var(--gray-900)",borderBottom:"1px solid var(--border)",boxShadow:"0 1px 0 var(--border)",position:"sticky",top:"0",zIndex:10},tableHeaderCell:{backgroundColor:"var(--gray-900)",fontWeight:"700",borderBottom:"1px solid var(--border)",cursor:"pointer",userSelect:"none",minWidth:"100px",whiteSpace:"nowrap",padding:"4px 4px",color:"var(--text-primary)",textShadow:"0 1px 2px rgba(0, 0, 0, 0.3)",boxShadow:"0 1px 0 var(--border)",transition:"background-color 0.2s",position:"sticky",top:"0",zIndex:10},tableHeaderCellHover:{backgroundColor:"var(--bg-hover)"},sortIndicator:{fontSize:"12px",color:"var(--text-secondary)"},tableBody:{flex:1,overflowY:"auto",padding:"8px",backgroundColor:"var(--bg-primary)"},row:{height:"35px",borderBottom:"1px solid var(--border)",transition:"background-color 0.2s ease",cursor:"pointer",backgroundColor:"var(--gray-900)"},rowHover:{backgroundColor:"var(--bg-secondary)"},expandedRow:{backgroundColor:"var(--bg-secondary)"},rowCell:{padding:"4px 4px",verticalAlign:"middle",color:"var(--text-primary)",whiteSpace:"nowrap",overflow:"hidden",textOverflow:"ellipsis",borderBottom:"1px solid var(--border)"},rowCellName:{fontWeight:"500",minWidth:"150px"},rowCellCenter:{textAlign:"center",justifyContent:"center",minWidth:"80px"},rowActions:{width:"80px",textAlign:"center",padding:"4px 8px",borderBottom:"1px solid var(--border)"},addButton:{width:"2rem",height:"2rem",border:"1px solid var(--purple)",borderRadius:"var(--radius-sm)",background:"var(--purple)",color:"white",cursor:"pointer",transition:"all 0.2s ease",display:"inline-flex",alignItems:"center",justifyContent:"center",fontSize:"16px",fontWeight:"500"},expandedContent:{padding:"0",backgroundColor:"var(--bg-secondary)",borderBottom:"1px solid var(--border)"},columnName:{width:"auto",minWidth:"0",overflow:"hidden",textOverflow:"ellipsis",paddingLeft:"8px",textAlign:"left"},columnTier:{width:"80px",textAlign:"center",overflow:"visible",textOverflow:"unset"},columnType:{width:"100px",overflow:"hidden",textOverflow:"ellipsis",textAlign:"center"},columnDifficulty:{width:"40px",textAlign:"center",overflow:"visible",textOverflow:"unset"},columnAction:{width:"32px",minWidth:"24px",maxWidth:"24px",textAlign:"center",padding:"0",margin:"0",border:"none",verticalAlign:"middle",color:"var(--text-primary)",whiteSpace:"nowrap",overflow:"visible",textOverflow:"unset"},loading:{display:"flex",justifyContent:"center",alignItems:"center",height:"200px",color:"var(--text-primary)",fontSize:"16px"},mobileBrowser:{width:"95vw",height:"90vh",maxWidth:"none"},mobileSearchInput:{fontSize:"16px"},headerWithFilter:{display:"flex",alignItems:"center",justifyContent:"center",gap:"4px",position:"relative"},headerFilterIcon:{background:"none",border:"none",color:"var(--text-secondary)",cursor:"pointer",padding:"2px 4px",borderRadius:"var(--radius-sm)",display:"flex",alignItems:"center",justifyContent:"center",transition:"all 0.2s ease",position:"relative"},headerFilterIconActive:{color:"var(--purple)"},filterIcon:{fontSize:"12px"},filterActiveDot:{position:"absolute",left:"50%",top:"2px",transform:"translateX(-50%)",width:"4px",height:"4px",borderRadius:"50%",background:"var(--purple)",pointerEvents:"none"},filterDropdown:{position:"absolute",top:"100%",left:"0",background:"var(--bg-secondary)",border:"1px solid var(--border)",borderRadius:"var(--radius-md)",boxShadow:"0 8px 24px rgba(0, 0, 0, 0.25)",zIndex:99999,marginTop:"4px",overflow:"hidden",width:"max-content",minWidth:"120px",maxWidth:"200px"},filterOption:{padding:"8px 12px",cursor:"pointer",color:"var(--text-primary)",fontSize:"14px",display:"flex",alignItems:"center",gap:"8px",borderBottom:"1px solid rgba(255,255,255,0.06)",transition:"background-color 0.2s ease",whiteSpace:"nowrap",overflow:"hidden",textOverflow:"ellipsis"},filterOptionSelected:{backgroundColor:"var(--bg-hover)"},checkIcon:{width:"16px",height:"16px",display:"inline-flex",alignItems:"center",justifyContent:"center",color:"var(--text-secondary)",fontSize:"12px"},filterLabel:{flex:1}},ct=()=>e.jsx("div",{className:"pwa-install-prompt",style:{}}),ue=({side:t="left",children:n,className:c="",style:u={}})=>{const y=t==="left",l={flex:1,minWidth:0,background:"var(--bg-primary)",overflowY:"auto",overflowX:y?"auto":"hidden",display:y?"block":"flex",flexDirection:y?"initial":"column",height:"100%",padding:y?"1rem 0 1rem 0":"0 1rem 0 0",...u};return e.jsx("div",{className:c,style:l,children:n})};class pt extends ie.Component{constructor(n){super(n),this.state={hasError:!1,error:null}}static getDerivedStateFromError(n){return{hasError:!0,error:n}}componentDidCatch(n,c){console.error("ErrorBoundary caught an error:",n,c)}render(){var n;return this.state.hasError?e.jsxs("div",{className:"p-md text-red",children:[e.jsx("h3",{children:"Something went wrong:"}),e.jsx("pre",{children:(n=this.state.error)==null?void 0:n.toString()}),e.jsx("button",{className:"btn-base btn-text",onClick:()=>this.setState({hasError:!1,error:null}),children:"Try again"})]}):this.props.children}}const xt=()=>{const{adversaries:t,environments:n,countdowns:c,fear:u,updateFear:y,createAdversary:l,updateAdversary:x,deleteAdversary:b,createEnvironment:h,updateEnvironment:I,deleteEnvironment:S,createCountdown:z,updateCountdown:N,deleteCountdown:C,advanceCountdown:v}=Ge(),[R,W]=j.useState(!1),[L,E]=j.useState(!1),[D,k]=j.useState("adversary");j.useState(!1);const[F,T]=j.useState(!1);j.useState(!0);const[a,g]=j.useState(null),[d,s]=j.useState(0),[i,f]=j.useState(0),[o,r]=j.useState(!1);j.useEffect(()=>{const w=()=>{const O=window.matchMedia("(max-width: 800px)");W(O.matches)};w();const M=window.matchMedia("(max-width: 800px)");return M.addEventListener("change",w),()=>M.removeEventListener("change",w)},[]);const p=16,m=250,V=500,H=w=>{if(w<=0)return{visibleColumns:1,columnWidth:m};const M=p*2,O=w-M;let X={visibleColumns:1,columnWidth:Math.min(O,V)};for(let q=1;q<=5;q++){const Y=(q-1)*p,Z=(O-Y)/q;Z>=m&&Z<=V&&q*Z+Y<=O&&q>X.visibleColumns&&(X={visibleColumns:q,columnWidth:Z})}return X.visibleColumns*X.columnWidth+(X.visibleColumns-1)*p>O&&(X={visibleColumns:1,columnWidth:Math.min(O,V)}),X},{visibleColumns:B,columnWidth:P}=H(d);j.useEffect(()=>{const w=()=>{s(window.innerWidth)};return w(),window.addEventListener("resize",w),()=>window.removeEventListener("resize",w)},[]);const G=(w="unified")=>{let M=w;w==="adversaries"?M="adversary":w==="environments"&&(M="environment"),L&&D===M?E(!1):(k(M),E(!0))},$=j.useCallback(()=>{E(!1)},[]),U=j.useCallback(w=>{f(w.target.scrollLeft)},[]);j.useCallback(()=>{r(!0)},[]),j.useCallback(()=>{setTimeout(()=>r(!1),100)},[]);const Q=(()=>{const w={};return t.forEach(M=>{var X;const O=M.baseName||((X=M.name)==null?void 0:X.replace(/\s+\(\d+\)$/,""))||M.name;w[O]||(w[O]={type:"adversary",baseName:O,instances:[]}),w[O].instances.push(M)}),n.forEach(M=>{w[M.name]||(w[M.name]={type:"environment",baseName:M.name,instances:[]}),w[M.name].instances.push(M)}),c.forEach(M=>{w[`countdown-${M.id}`]={type:"countdown",baseName:M.name,instances:[M]}}),Object.values(w)})();return Q.length,e.jsxs("div",{className:"app",onClick:w=>{w.target,w.currentTarget},children:[e.jsx(Ze,{position:"top",children:e.jsx(qe,{type:"fear",value:(u==null?void 0:u.value)||0,maxValue:12,onChange:y,showTooltip:!1,enableBoundaryClick:!0,clickContainerWidth:"100%",centerPips:!0})}),e.jsx(Je,{adversaries:t,environments:n,countdowns:c,deleteAdversary:b,deleteEnvironment:S,deleteCountdown:C,isClearMode:F,setIsClearMode:T,sortAdversaries:()=>{},onOpenDatabase:G}),e.jsx("div",{className:"main-content",style:{position:"relative",width:"100%"},children:e.jsx("div",{className:"dashboard-scroll-container",style:{display:"flex",flexDirection:"row",overflowX:"auto",overflowY:"hidden",padding:`0 ${p}px`,scrollSnapType:"x mandatory",height:"100%",width:"100%"},onScroll:U,children:L?e.jsxs(ue,{className:"invisible-scrollbar",style:{width:`${P+p}px`,flexShrink:0,flexGrow:0,flex:"none",paddingLeft:`${p}px`,paddingRight:"0",paddingTop:`${p}px`,paddingBottom:`${p}px`,scrollSnapAlign:"start",overflowY:"auto",overflowX:"hidden"},children:[e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",padding:"1rem",borderBottom:"1px solid var(--border)",backgroundColor:"var(--bg-secondary)",flexShrink:0},children:[e.jsxs("h3",{style:{margin:0,color:"var(--text-primary)"},children:["Browse ",D==="adversary"?"Adversaries":"Environments"]}),e.jsx("button",{onClick:$,style:{background:"none",border:"none",color:"var(--text-primary)",fontSize:"1.2rem",cursor:"pointer",padding:"0.25rem",borderRadius:"var(--radius-sm)",transition:"background-color 0.2s"},onMouseEnter:w=>w.target.style.backgroundColor="var(--bg-hover)",onMouseLeave:w=>w.target.style.backgroundColor="transparent",title:"Close Browser",children:"×"})]}),e.jsx("div",{style:{flex:1,padding:"1rem",overflowY:"auto"},children:e.jsx(dt,{type:D,onAddItem:w=>{D==="adversary"?(l(w),g("adversary")):D==="environment"&&(h(w),g("environment"))},onCancel:$})})]}):Q.map((w,M)=>e.jsx(ue,{className:"invisible-scrollbar",style:{width:`${P+p}px`,flexShrink:0,flexGrow:0,flex:"none",paddingLeft:`${p}px`,paddingRight:"0",paddingTop:`${p}px`,paddingBottom:`${p}px`,scrollSnapAlign:"start",overflowY:"auto",overflowX:"hidden"},children:e.jsx(tt,{type:w.type,item:{...w.instances[0],name:w.baseName,hp:0,stress:0,isDead:!1},mode:"expanded",instances:w.instances,onApplyDamage:w.type==="adversary"?(O,X,ee,q)=>{const Y=w.instances.find(Z=>Z.id===O);Y&&x(O,{hp:Math.min(Y.hpMax||1,(Y.hp||0)+X)})}:void 0,onApplyHealing:w.type==="adversary"?(O,X,ee)=>{const q=w.instances.find(Y=>Y.id===O);q&&x(O,{hp:Math.max(0,(q.hp||0)-X)})}:void 0,onApplyStressChange:w.type==="adversary"?(O,X)=>{var ee,q;return x(O,{stress:Math.max(0,Math.min(((ee=w.instances.find(Y=>Y.id===O))==null?void 0:ee.stressMax)||6,(((q=w.instances.find(Y=>Y.id===O))==null?void 0:q.stress)||0)+X))})}:void 0,onUpdate:w.type==="adversary"?x:w.type==="environment"?I:N,adversaries:t})},`${w.type}-${w.baseName}`))})}),e.jsx(ct,{})]})},ht=()=>e.jsx(pt,{children:e.jsx(xt,{})});oe.createRoot(document.getElementById("root")).render(e.jsx(ie.StrictMode,{children:e.jsx(Xe,{children:e.jsx(ht,{})})}));
