import{j as o,C as A,a as C,A as j,E}from"./index-e61eb6a9.js";import{r as g}from"./dndkit-fdc06b07.js";import"./fa-8ab3eb90.js";import"./lucide-abc1b48f.js";const R=({type:d,item:e=null,source:c="campaign",onSave:F,onCancel:M})=>{const l=d==="adversary",f=d==="environment",p=d==="countdown",[t,i]=g.useState({name:"",tier:1,type:"",difficulty:1,description:"",source:c,hpMax:1,stressMax:0,passiveFeatures:[{name:"",description:""}],actionFeatures:[{name:"",description:""}],reactionFeatures:[{name:"",description:""}],thresholds:{major:0,severe:0},atk:0,weapon:"Weapon",range:"Melee",damage:"1d6 phy",effects:[],hazards:[],max:5,value:0,countdownType:"standard",loop:"none"});g.useEffect(()=>{var r,s,a;e&&i({name:e.name||"",tier:e.tier||1,type:e.type||"",difficulty:e.difficulty||1,description:e.description||"",source:e.source||c,hpMax:e.hpMax||1,stressMax:e.stressMax||0,passiveFeatures:e.passiveFeatures||((r=e.features)==null?void 0:r.filter(n=>n.type==="Passive"))||[{name:"",description:""}],actionFeatures:e.actionFeatures||((s=e.features)==null?void 0:s.filter(n=>n.type==="Action"))||[{name:"",description:""}],reactionFeatures:e.reactionFeatures||((a=e.features)==null?void 0:a.filter(n=>n.type==="Reaction"))||[{name:"",description:""}],thresholds:e.thresholds||{major:0,severe:0},atk:e.atk||0,weapon:e.weapon||"Weapon",range:e.range||"Melee",damage:e.damage||"1d6 phy",effects:e.effects||[],hazards:e.hazards||[],max:e.max||5,value:e.value||0,countdownType:e.type||"standard",loop:e.loop||"none"})},[e,c]);const m=(r,s)=>{i(a=>({...a,[r]:s}))},h=(r,s,a)=>{i(n=>({...n,[r]:n[r].map((u,w)=>w===s?a:u)}))},x=r=>{i(s=>({...s,[r]:[...s[r],""]}))},y=(r,s)=>{i(a=>({...a,[r]:a[r].filter((n,u)=>u!==s)}))},v=r=>{if(r.preventDefault(),!t.name.trim()){alert("Name is required");return}const s={...t,name:t.name.trim(),description:t.description.trim(),...l&&{hp:0,hpMax:t.hpMax,stress:0,stressMax:t.stressMax,thresholds:t.thresholds,atk:t.atk,weapon:t.weapon,range:t.range,damage:t.damage,features:[...t.passiveFeatures.filter(a=>a.name.trim()).map(a=>({...a,type:"Passive"})),...t.actionFeatures.filter(a=>a.name.trim()).map(a=>({...a,type:"Action"})),...t.reactionFeatures.filter(a=>a.name.trim()).map(a=>({...a,type:"Reaction"}))]},...f&&{effects:t.effects.filter(a=>a.trim()),hazards:t.hazards.filter(a=>a.trim())},...p&&{max:t.max,value:t.value,type:t.countdownType,loop:t.loop}};F(s)};return o.jsx("div",{className:"creator-container",children:o.jsx("form",{onSubmit:v,className:"creator-form",children:o.jsxs(A,{item:e,type:d,editData:t,onChange:m,onSave:v,onCancel:M,showMetaDetails:!p,children:[p&&o.jsx(C,{data:t,onChange:m}),l&&o.jsx(j,{data:t,onChange:m,onArrayChange:h,onAddItem:x,onRemoveItem:y}),f&&o.jsx(E,{data:t,onArrayChange:h,onAddItem:x,onRemoveItem:y})]})})})};export{R as default};
