import{j as o,A as j,C as A,a as E,E as C}from"./index-da4cb297.js";import{r as x}from"./dndkit-fdc06b07.js";import"./fa-8ab3eb90.js";import"./lucide-abc1b48f.js";const S=({type:d,item:e=null,source:p="campaign",onSave:y,onCancel:l})=>{const f=d==="adversary",h=d==="environment",c=d==="countdown",[t,i]=x.useState({name:"",tier:1,type:"",difficulty:1,description:"",motives:"",source:p,hpMax:1,stressMax:0,passiveFeatures:[{name:"",description:""}],actionFeatures:[{name:"",description:""}],reactionFeatures:[{name:"",description:""}],thresholds:{major:0,severe:0},atk:0,weapon:"Weapon",range:"Melee",damage:"1d6 phy",effects:[],hazards:[],max:5,value:0,countdownType:"standard",loop:"none"});x.useEffect(()=>{var r,s,a;e&&i({name:e.name||"",tier:e.tier||1,type:e.type||"",difficulty:e.difficulty||1,description:e.description||"",motives:e.motives||"",source:e.source||p,hpMax:e.hpMax||1,stressMax:e.stressMax||0,passiveFeatures:e.passiveFeatures||((r=e.features)==null?void 0:r.filter(n=>n.type==="Passive"))||[{name:"",description:""}],actionFeatures:e.actionFeatures||((s=e.features)==null?void 0:s.filter(n=>n.type==="Action"))||[{name:"",description:""}],reactionFeatures:e.reactionFeatures||((a=e.features)==null?void 0:a.filter(n=>n.type==="Reaction"))||[{name:"",description:""}],thresholds:e.thresholds||{major:0,severe:0},atk:e.atk||0,weapon:e.weapon||"Weapon",range:e.range||"Melee",damage:e.damage||"1d6 phy",effects:e.effects||[],hazards:e.hazards||[],max:e.max||5,value:e.value||0,countdownType:e.type||"standard",loop:e.loop||"none"})},[e,p]);const v=(r,s)=>{i(a=>({...a,[r]:s}))},g=(r,s,a)=>{i(n=>({...n,[r]:n[r].map((u,w)=>w===s?a:u)}))},F=r=>{i(s=>({...s,[r]:[...s[r],""]}))},M=(r,s)=>{i(a=>({...a,[r]:a[r].filter((n,u)=>u!==s)}))},m=r=>{if(r.preventDefault(),!t.name.trim()){alert("Name is required");return}const s={...t,name:t.name.trim(),description:t.description.trim(),...f&&{hp:0,hpMax:t.hpMax,stress:0,stressMax:t.stressMax,thresholds:t.thresholds,atk:t.atk,weapon:t.weapon,range:t.range,damage:t.damage,features:[...t.passiveFeatures.filter(a=>a.name.trim()).map(a=>({...a,type:"Passive"})),...t.actionFeatures.filter(a=>a.name.trim()).map(a=>({...a,type:"Action"})),...t.reactionFeatures.filter(a=>a.name.trim()).map(a=>({...a,type:"Reaction"}))]},...h&&{effects:t.effects.filter(a=>a.trim()),hazards:t.hazards.filter(a=>a.trim())},...c&&{max:t.max,value:t.value,type:t.countdownType,loop:t.loop}};y(s)};return o.jsx("div",{className:"creator-container",children:o.jsx("form",{onSubmit:m,className:"creator-form",children:f?o.jsx(j,{item:t,isEditMode:!0,onSave:m,onCancel:l}):o.jsxs(A,{item:e,type:d,editData:t,onChange:v,onSave:m,onCancel:l,showMetaDetails:!c,children:[c&&o.jsx(E,{data:t,onChange:v}),h&&o.jsx(C,{data:t,onArrayChange:g,onAddItem:F,onRemoveItem:M})]})})})};export{S as default};
