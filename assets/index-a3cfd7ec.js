import{r as w,a as ue,R as re}from"./dndkit-57209f9c.js";import{F as Me,f as Le,a as Re,b as De,c as ge}from"./fa-b4bcccb0.js";import{D as Z,A as Se,C as Ne,T as Pe,S as He,M as Fe,X as oe,E as Oe,H as de,L as qe,a as $e,b as Ve,F as _e,c as ne,d as se,e as ce,P as pe}from"./lucide-7a0c9f84.js";(function(){const a=document.createElement("link").relList;if(a&&a.supports&&a.supports("modulepreload"))return;for(const g of document.querySelectorAll('link[rel="modulepreload"]'))b(g);new MutationObserver(g=>{for(const d of g)if(d.type==="childList")for(const y of d.addedNodes)y.tagName==="LINK"&&y.rel==="modulepreload"&&b(y)}).observe(document,{childList:!0,subtree:!0});function c(g){const d={};return g.integrity&&(d.integrity=g.integrity),g.referrerPolicy&&(d.referrerPolicy=g.referrerPolicy),g.crossOrigin==="use-credentials"?d.credentials="include":g.crossOrigin==="anonymous"?d.credentials="omit":d.credentials="same-origin",d}function b(g){if(g.ep)return;g.ep=!0;const d=c(g);fetch(g.href,d)}})();var ke={exports:{}},le={};/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Ge=w,Xe=Symbol.for("react.element"),Ye=Symbol.for("react.fragment"),Ue=Object.prototype.hasOwnProperty,Ke=Ge.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,Je={key:!0,ref:!0,__self:!0,__source:!0};function Ee(t,a,c){var b,g={},d=null,y=null;c!==void 0&&(d=""+c),a.key!==void 0&&(d=""+a.key),a.ref!==void 0&&(y=a.ref);for(b in a)Ue.call(a,b)&&!Je.hasOwnProperty(b)&&(g[b]=a[b]);if(t&&t.defaultProps)for(b in a=t.defaultProps,a)g[b]===void 0&&(g[b]=a[b]);return{$$typeof:Xe,type:t,key:d,ref:y,props:g,_owner:Ke.current}}le.Fragment=Ye;le.jsx=Ee;le.jsxs=Ee;ke.exports=le;var e=ke.exports,he={},ye=ue;he.createRoot=ye.createRoot,he.hydrateRoot=ye.hydrateRoot;function ie(t){const a=typeof crypto<"u"&&crypto.randomUUID?crypto.randomUUID():`${Date.now()}-${Math.random().toString(36).slice(2,10)}`;return t?`${t}-${a}`:a}const Ie=w.createContext();function Qe(t){if(typeof localStorage>"u")return null;try{const a=localStorage.getItem(t);return a==null?null:JSON.parse(a)}catch{return null}}function Ze(t,a){if(!(typeof localStorage>"u"))try{localStorage.setItem(t,JSON.stringify(a))}catch{}}const et=({children:t})=>{const[a,c]=w.useState({fear:{value:0,visible:!1},countdowns:[],adversaries:[],environments:[]}),[b,g]=w.useState(!1);w.useEffect(()=>{var s,o,n;const i=Qe("daggerheart-game-state");if(i)try{(((s=i.adversaries)==null?void 0:s.length)>0||((o=i.environments)==null?void 0:o.length)>0||((n=i.countdowns)==null?void 0:n.length)>0)&&c(i)}catch(r){console.error("Failed to load saved state:",r)}g(!0)},[]),w.useEffect(()=>{Ze("daggerheart-game-state",a)},[a]);const d=i=>{c(s=>({...s,fear:{...s.fear,value:i}}))},y=()=>{c(i=>({...i,fear:{...i.fear,visible:!i.fear.visible}}))},u=w.useRef(a);w.useEffect(()=>{u.current=a},[a]);const M={gameState:a,isLoaded:b,updateFear:d,toggleFearVisibility:y,createCountdown:i=>{const s={id:ie("countdown"),name:i.name||"Countdown",max:parseInt(i.max)||1,value:0,visible:!0,type:i.type||"standard",loop:i.loop||"none",source:i.source||"campaign"};c(o=>({...o,countdowns:[...o.countdowns,s]}))},updateCountdown:(i,s)=>{c(o=>({...o,countdowns:o.countdowns.map(n=>n.id===i?{...n,...s}:n)}))},deleteCountdown:i=>{c(s=>({...s,countdowns:s.countdowns.filter(o=>o.id!==i)}))},advanceCountdown:(i,s)=>{c(o=>({...o,countdowns:o.countdowns.map(n=>{if(n.id!==i)return n;let r=s;if(n.loop==="loop")r>n.max?r=(r-1)%n.max+1:r<0&&(r=n.max);else if(n.loop==="increasing"){if(r>n.max)return{...n,max:n.max+1,value:1};if(r<0)return{...n,max:Math.max(1,n.max-1),value:1};r=Math.max(0,r)}else if(n.loop==="decreasing"){if(r>n.max)return{...n,max:Math.max(1,n.max-1),value:1};if(r<0)return{...n,max:n.max+1,value:1};r=Math.min(n.max,r)}else r=Math.max(0,Math.min(r,n.max));return{...n,value:r}})}))},incrementCountdown:(i,s=1)=>{c(o=>({...o,countdowns:o.countdowns.map(n=>{if(n.id!==i)return n;let r=n.value+s;if(n.loop==="loop")r>n.max&&(r=(r-1)%n.max+1);else if(n.loop==="increasing"){if(r>n.max)return{...n,max:n.max+1,value:1}}else if(n.loop==="decreasing"){if(r>n.max)return{...n,max:Math.max(1,n.max-1),value:1}}else r=Math.min(r,n.max);return{...n,value:r}})}))},decrementCountdown:i=>{c(s=>({...s,countdowns:s.countdowns.map(o=>{if(o.id!==i)return o;let n=o.value-1;if(o.loop==="loop")n<0&&(n=o.max);else if(o.loop==="increasing"){if(n<0)return{...o,max:Math.max(1,o.max-1),value:o.max};n=Math.max(0,n)}else if(o.loop==="decreasing"){if(n<0)return{...o,max:o.max+1,value:1}}else n=Math.max(0,n);return{...o,value:n}})}))},reorderCountdowns:i=>{c(s=>{const[o,n]=i,r=[...s.countdowns],[x]=r.splice(o,1);return r.splice(n,0,x),{...s,countdowns:r}})},createAdversary:i=>{var p;const s=ie("adv"),o=a.adversaries||[],n=i.baseName||((p=i.name)==null?void 0:p.replace(/\s+\(\d+\)$/,""))||i.name||"Unknown",r=o.filter(C=>C.baseName===n);let x=1;if(r.length===0)x=1;else{const C=r.map(q=>q.duplicateNumber||1);let I=1;for(;C.includes(I);)I++;x=I}const l={...i,id:s,baseName:n,duplicateNumber:x,name:`${n} (${x})`,hp:0,stress:0,isVisible:!0};c(C=>({...C,adversaries:[...C.adversaries,l]}))},createAdversariesBulk:i=>{const s=[],o={};i.forEach(n=>{var V;const r=n.baseName||((V=n.name)==null?void 0:V.replace(/\s+\(\d+\)$/,""))||n.name||"Unknown",p=(a.adversaries||[]).filter(B=>B.baseName===r).length,C=o[r]||0,I=p+C+1;o[r]=C+1;const q={...n,id:ie("adv"),baseName:r,duplicateNumber:I,name:`${r} (${I})`,hp:0,stress:0,isVisible:!0};s.push(q)}),c(n=>({...n,adversaries:[...n.adversaries,...s]}))},updateAdversary:(i,s)=>{c(o=>({...o,adversaries:o.adversaries.map(n=>{if(n.id===i){const r={...n,...s};if(s.baseName!==void 0){const x=s.baseName,l=r.duplicateNumber||1;r.name=l===1?x:`${x} (${l})`}return r}return n})}))},deleteAdversary:i=>{c(s=>({...s,adversaries:s.adversaries.filter(o=>o.id!==i)}))},reorderAdversaries:i=>{c(s=>{const[o,n]=i,r=[...s.adversaries],[x]=r.splice(o,1);return r.splice(n,0,x),{...s,adversaries:r}})},bulkReorderAdversaries:i=>{c(s=>({...s,adversaries:i}))},createEnvironment:i=>{const s=ie("env"),n=(a.environments||[]).filter(l=>l.name.replace(/\s+\(\d+\)$/,"")===i.name);let r=i.name||"Unknown";if(n.length===0)r=i.name;else if(n.length===1){const l=n[0],p=l.name.replace(/\s+\(\d+\)$/,""),C=a.environments.map(I=>I.id===l.id?{...I,name:`${p} (1)`}:I);c(I=>({...I,environments:C})),r=`${i.name} (2)`}else{const l=n.map(C=>{const I=C.name.match(/\((\d+)\)$/);return I?parseInt(I[1]):null}).filter(C=>C!==null);let p=1;for(;l.includes(p);)p++;r=`${i.name} (${p})`}const x={...i,id:s,name:r,isVisible:!0};c(l=>({...l,environments:[...l.environments,x]}))},updateEnvironment:(i,s)=>{c(o=>({...o,environments:o.environments.map(n=>n.id===i?{...n,...s}:n)}))},deleteEnvironment:i=>{c(s=>({...s,environments:s.environments.filter(o=>o.id!==i)}))},reorderEnvironments:i=>{c(s=>{const[o,n]=i,r=[...s.environments],[x]=r.splice(o,1);return r.splice(n,0,x),{...s,environments:r}})}};return e.jsx(Ie.Provider,{value:M,children:t})},tt=()=>{const t=w.useContext(Ie);if(!t)return console.warn("useGameState: Context not available yet, returning defaults"),{fear:{value:0,visible:!1},countdowns:[],adversaries:[],environments:[],updateFear:()=>{},toggleFearVisibility:()=>{},createCountdown:()=>{},updateCountdown:()=>{},deleteCountdown:()=>{},advanceCountdown:()=>{},incrementCountdown:()=>{},decrementCountdown:()=>{},reorderCountdowns:()=>{},createAdversary:()=>{},updateAdversary:()=>{},deleteAdversary:()=>{},reorderAdversaries:()=>{},createEnvironment:()=>{},updateEnvironment:()=>{},deleteEnvironment:()=>{},reorderEnvironments:()=>{},hasCountdowns:!1,hasAdversaries:!1,hasEnvironments:!1,getCountdownById:()=>null,getAdversaryById:()=>null,getEnvironmentById:()=>null};const{gameState:a,...c}=t;if(!a)return console.warn("useGameState: gameState not available, returning defaults"),{fear:{value:0,visible:!1},countdowns:[],adversaries:[],environments:[],updateFear:()=>{},toggleFearVisibility:()=>{},createCountdown:()=>{},updateCountdown:()=>{},deleteCountdown:()=>{},advanceCountdown:()=>{},incrementCountdown:()=>{},decrementCountdown:()=>{},reorderCountdowns:()=>{},createAdversary:()=>{},updateAdversary:()=>{},deleteAdversary:()=>{},reorderAdversaries:()=>{},createEnvironment:()=>{},updateEnvironment:()=>{},deleteEnvironment:()=>{},reorderEnvironments:()=>{},hasCountdowns:!1,hasAdversaries:!1,hasEnvironments:!1,getCountdownById:()=>null,getAdversaryById:()=>null,getEnvironmentById:()=>null};const{fear:b,countdowns:g,adversaries:d,environments:y}=a;return{gameState:a,fear:b,countdowns:g,adversaries:d,environments:y,...c,hasCountdowns:g.length>0,hasAdversaries:d.length>0,hasEnvironments:y.length>0,getCountdownById:u=>g.find(v=>v.id===u),getAdversaryById:u=>d.find(v=>v.id===u),getEnvironmentById:u=>y.find(v=>v.id===u)}},fe={fear:{icon:Le,maxValue:12,containerStyle:{display:"flex",gap:"0.125rem",alignItems:"center",justifyContent:"center",width:"100%",height:"100%",padding:"0.125rem",maxWidth:"none"},pipStyle:{fontSize:"var(--text-lg)",fontWeight:600,transition:"color 0.3s ease",height:"1.5rem",width:"1.5rem",display:"inline-block",textAlign:"center",lineHeight:"1.5rem",flexShrink:0,imageRendering:"crisp-edges"},filledColor:"var(--purple)",emptyColor:"var(--gray-dark)",tooltipTitle:"Click anywhere in header to adjust fear:",tooltipInstructions:[{text:"Left of boundary:",description:"Click to decrease fear by 1"},{text:"Right of boundary:",description:"Click to increase fear by 1"}]},hp:{icon:Re,maxValue:20,containerStyle:{display:"inline-block",width:"auto",height:"100%",padding:"0.125rem",textAlign:"center"},pipStyle:{fontSize:"var(--text-sm)",fontWeight:600,transition:"color 0.3s ease",height:"1.5rem",width:"1.5rem",display:"inline-block",textAlign:"center",lineHeight:"1.5rem",flexShrink:0},filledColor:"var(--red)",emptyColor:"var(--text-secondary)",tooltipTitle:"Click anywhere to adjust HP:",tooltipInstructions:[{text:"Left of boundary:",description:"Click to decrease HP by 1"},{text:"Right of boundary:",description:"Click to increase HP by 1"}]},stress:{icon:De,maxValue:12,containerStyle:{display:"inline-block",width:"auto",height:"100%",padding:"0.125rem",textAlign:"center"},pipStyle:{fontSize:"var(--text-sm)",fontWeight:600,transition:"color 0.3s ease",height:"1.5rem",width:"1.5rem",display:"inline-block",textAlign:"center",lineHeight:"1.5rem",flexShrink:0},filledColor:"var(--gold)",emptyColor:"var(--text-secondary)",tooltipTitle:"Click anywhere to adjust stress:",tooltipInstructions:[{text:"Left of boundary:",description:"Click to decrease stress by 1"},{text:"Right of boundary:",description:"Click to increase stress by 1"}]},countdown:{icon:ge,maxValue:6,containerStyle:{display:"inline-block",width:"auto",height:"100%",padding:"0.125rem",textAlign:"center"},pipStyle:{fontSize:"var(--text-sm)",fontWeight:600,transition:"color 0.3s ease",height:"1.5rem",width:"1.5rem",display:"inline-block",textAlign:"center",lineHeight:"1.5rem",flexShrink:0},filledColor:"var(--text-secondary)",emptyColor:"var(--text-secondary)",tooltipTitle:"Click anywhere to adjust countdown:",tooltipInstructions:[{text:"Left of boundary:",description:"Click to decrease countdown by 1"},{text:"Right of boundary:",description:"Click to increase countdown by 1"}]},hpDots:{maxValue:20,containerStyle:{display:"flex",flexWrap:"wrap",gap:"1px",justifyContent:"center",alignItems:"center",maxWidth:"120px"},pipStyle:{width:"8px",height:"8px",borderRadius:"50%",border:"1px solid var(--border)",transition:"background-color 0.5s ease, border-color 0.5s ease, box-shadow 0.5s ease"},filledStyle:{background:"var(--red)",borderColor:"var(--red)",boxShadow:"0 0 4px rgba(239, 68, 68, 0.5)"},emptyStyle:{background:"var(--bg-primary)",borderColor:"var(--border)"},isDots:!0,tooltipTitle:"Click anywhere to adjust HP:",tooltipInstructions:[{text:"Left of boundary:",description:"Click to decrease HP by 1"},{text:"Right of boundary:",description:"Click to increase HP by 1"}]},stressDots:{maxValue:12,containerStyle:{display:"flex",flexWrap:"wrap",gap:"1px",justifyContent:"center",alignItems:"center",maxWidth:"120px"},pipStyle:{width:"8px",height:"8px",borderRadius:"50%",border:"1px solid var(--border)",transition:"background-color 0.5s ease, border-color 0.5s ease, box-shadow 0.5s ease"},filledStyle:{background:"var(--purple)",borderColor:"var(--purple)",boxShadow:"0 0 4px rgba(139, 92, 246, 0.5)"},emptyStyle:{background:"var(--bg-primary)",borderColor:"var(--border)"},isDots:!0,tooltipTitle:"Click anywhere to adjust stress:",tooltipInstructions:[{text:"Left of boundary:",description:"Click to decrease stress by 1"},{text:"Right of boundary:",description:"Click to increase stress by 1"}]},adversaryHP:{icon:Z,maxValue:20,containerStyle:{display:"flex",gap:"0px",flexWrap:"wrap",alignContent:"flex-start",rowGap:"0.03125rem",maxWidth:"100%"},pipStyle:{fontSize:"var(--text-sm)",fontWeight:600,transition:"none",cursor:"pointer",width:"1rem",height:"1rem",display:"flex",alignItems:"center",justifyContent:"center",flexShrink:0},filledColor:"var(--red)",emptyColor:"var(--gray-400)",tooltipTitle:"Click to adjust HP:",tooltipInstructions:[{text:"Filled pip:",description:"Click to heal (reduce damage)"},{text:"Empty pip:",description:"Click to take damage"}]},adversaryStress:{icon:Se,maxValue:12,containerStyle:{display:"flex",gap:"0px",flexWrap:"wrap",alignContent:"flex-start",rowGap:"0.03125rem",maxWidth:"100%"},pipStyle:{fontSize:"var(--text-sm)",fontWeight:600,transition:"none",cursor:"pointer",width:"1rem",height:"1rem",display:"flex",alignItems:"center",justifyContent:"center",flexShrink:0},filledColor:"var(--gold)",emptyColor:"var(--gray-400)",tooltipTitle:"Click to adjust stress:",tooltipInstructions:[{text:"Filled pip:",description:"Click to reduce stress"},{text:"Empty pip:",description:"Click to increase stress"}]},countdownDistributed:{icon:ge,maxValue:6,containerStyle:{display:"inline-block",width:"auto",height:"100%",padding:"0.125rem",textAlign:"center"},pipStyle:{fontSize:"var(--text-sm)",fontWeight:600,transition:"color 0.3s ease",height:"1.5rem",width:"1.5rem",display:"inline-block",textAlign:"center",lineHeight:"1.5rem",flexShrink:0},filledColor:"var(--text-secondary)",emptyColor:"var(--text-secondary)",tooltipTitle:"Countdown progress:",tooltipInstructions:[{text:"Progress:",description:"Current countdown value"}]}},rt=({type:t="fear",value:a=0,maxValue:c,onChange:b,size:g="lg",showTooltip:d=!0,containerStyle:y={},pipStyle:u={},countdownType:v=null,distributedGroups:k=null,onPipClick:S=null,enableBoundaryClick:T=!1,clickContainerWidth:F="auto",centerPips:h=!0})=>{const[f,N]=w.useState(!1),E=fe[t]||fe.fear,z=c||E.maxValue,A=Math.max(0,Math.min(z,a));let L=E.filledColor;t==="countdown"&&v&&(["progress","dynamic-progress","simple-hope"].includes(v)?L="var(--gold)":["consequence","dynamic-consequence","simple-fear"].includes(v)?L="var(--purple)":["long-term","standard"].includes(v)&&(L="var(--text-secondary)"));const j=(M,i)=>{if(S)S(M,i);else if(b){const s=M+1;b(s)}},P=M=>{if(!T||!b||S)return;M.currentTarget.getBoundingClientRect();const i=M.currentTarget.querySelector(".pip-container");if(!i)return;const s=i.getBoundingClientRect(),o=M.clientX-s.left;if(o<0){A>0&&b(A-1);return}if(o>s.width){A<z&&b(A+1);return}const n=s.width,r=n*.05,x=n-2*r,l=o-r,p=A/z,C=x*p;l<C?A>0&&b(A-1):A<z&&b(A+1)},U=(()=>{if(!k||t!=="countdownDistributed")return[{start:0,end:z,groupIndex:0}];let M=0;return k.map((i,s)=>{const o={start:M,end:M+i,groupIndex:s};return M+=i,o})})(),J=()=>e.jsxs(e.Fragment,{children:[U.map(M=>e.jsx(re.Fragment,{children:[...Array(M.end-M.start)].map((i,s)=>{const o=M.start+s,n=o<A;if(E.isDots)return e.jsx("div",{style:{...E.pipStyle,...n?E.filledStyle:E.emptyStyle,...u,cursor:b||S?"pointer":"default"},onClick:T?void 0:()=>j(o,n),title:`${o+1} of ${z}`},o);{const r=E.icon,x=r&&typeof r=="object"&&r.iconName,l=n?L:E.emptyColor;return e.jsx("span",{className:`fear-pip ${n?"filled":"empty"}`,style:{...E.pipStyle,color:l,cursor:b||S?"pointer":"default",...u},onClick:T?void 0:()=>j(o,n),title:`${o+1} of ${z}`,children:x?e.jsx(Me,{icon:r,size:g}):e.jsx(r,{size:16})},o)}})},M.groupIndex)),d&&e.jsx("div",{style:{position:"relative",cursor:"help",pointerEvents:"none"},children:e.jsxs("div",{style:{position:"absolute",bottom:"100%",left:"50%",transform:f?"translateX(-50%) translateY(-5px)":"translateX(-50%)",background:"rgba(15, 23, 42, 0.95)",border:"1px solid var(--gray)",borderRadius:"var(--radius-md)",padding:"var(--space-md)",minWidth:"250px",zIndex:1e3,opacity:f?1:0,visibility:f?"visible":"hidden",transition:"all 0.2s ease",boxShadow:"0 10px 25px rgba(0, 0, 0, 0.5)"},children:[e.jsx("div",{style:{fontWeight:600,color:"var(--gray-200)",marginBottom:"0.75rem",fontSize:"var(--text-sm)"},children:E.tooltipTitle}),E.tooltipInstructions.map((M,i)=>e.jsxs("div",{style:{marginBottom:"0.5rem",fontSize:"0.8rem",color:"var(--gray-300)",lineHeight:1.4},children:[e.jsx("strong",{style:{color:"var(--gray-200)"},children:M.text})," ",M.description]},i))]})})]});return e.jsx("div",{style:{width:F,height:"100%",cursor:b||S?"pointer":"default",touchAction:"manipulation",userSelect:"none",display:h?"flex":"block",alignItems:h?"center":"stretch",justifyContent:h?"center":"flex-start",...y},onClick:M=>{M.stopPropagation(),M.preventDefault(),T&&P(M)},onMouseEnter:()=>N(d),onMouseLeave:()=>N(!1),children:e.jsx("div",{className:"pip-container",style:{...E.containerStyle,width:"auto",height:"100%",padding:"0.125rem",textAlign:"center"},children:J()})})},nt="/Daggerheart/assets/daggerheart-logo-fe7815ad.svg",st=({showFlyout:t,onFlyoutChange:a})=>{const[c,b]=w.useState(!1),[g,d]=w.useState(!1),y=t!==void 0?t:c,u=a||b;return w.useEffect(()=>{const v=k=>{k.target.closest(".help-button")||u(!1)};return document.addEventListener("click",v),()=>document.removeEventListener("click",v)},[u]),w.useEffect(()=>{const v=window.matchMedia("(max-width: 800px)"),k=S=>d(S.matches);return d(v.matches),v.addEventListener("change",k),()=>v.removeEventListener("change",k)},[]),e.jsxs("div",{className:"help-button",style:{position:"relative",display:"flex",alignItems:"center",justifyContent:"center",padding:"0.5rem",color:y?"white":"var(--text-primary)",borderRadius:"50%",cursor:"pointer",transition:"all 0.2s ease",minWidth:"44px",minHeight:"44px",backgroundColor:y?"var(--purple)":"transparent"},onMouseEnter:v=>{y||(v.currentTarget.style.backgroundColor="var(--bg-secondary)")},onMouseLeave:v=>{y||(v.currentTarget.style.backgroundColor="transparent")},onClick:v=>{v.stopPropagation(),u(!y)},title:"Help & Info",children:[e.jsx("div",{style:{width:"20px",height:"20px",display:"flex",alignItems:"center",justifyContent:"center",color:"inherit",backgroundColor:"transparent",border:"none",outline:"none"},children:e.jsx(Ne,{size:20})}),e.jsxs("div",{style:{position:"absolute",top:"50%",right:"100%",left:"auto",transform:"translateY(-50%)",background:"var(--bg-primary)",border:"1px solid var(--border)",borderRadius:"var(--radius-md)",boxShadow:"0 4px 12px rgba(0, 0, 0, 0.3)",zIndex:1e3,opacity:y?1:0,visibility:y?"visible":"hidden",transition:"opacity 0.2s ease, visibility 0.2s ease, transform 0.2s ease",pointerEvents:y?"auto":"none",minWidth:"280px",maxWidth:g?"calc(100vw - 2rem)":"320px",marginRight:"0.5rem"},children:[e.jsxs("div",{style:{padding:"0.75rem",borderTop:"1px solid rgba(255, 255, 255, 0.1)",borderBottom:"1px solid rgba(255, 255, 255, 0.1)",background:"var(--bg-primary)",maxWidth:"280px"},children:[e.jsx("img",{src:nt,alt:"Daggerheart Community Content Logo",style:{width:"100%",maxWidth:"200px",height:"auto",margin:"0 auto 0.75rem auto",display:"block"},onError:v=>{console.error("Failed to load Daggerheart logo:",v.target.src),v.target.style.display="none";const k=document.createElement("div");k.style.cssText="text-align: center; margin-bottom: 0.75rem; font-size: 1.5rem; font-weight: bold; color: var(--purple);",k.textContent="⚔️ DAGGERHEART ⚔️",v.target.parentNode.insertBefore(k,v.target)},onLoad:()=>{}}),e.jsxs("div",{style:{fontSize:"0.7rem",lineHeight:1.3,color:"var(--text-secondary)",textAlign:"left",wordWrap:"break-word",overflowWrap:"break-word"},children:[e.jsx("p",{children:"This product includes materials from the Daggerheart System Reference Document 1.0, © Critical Role, LLC, under the terms of the Darrington Press Community Gaming (DPCGL) License."}),e.jsxs("p",{children:["More information can be found at ",e.jsx("a",{href:"https://www.daggerheart.com",target:"_blank",rel:"noopener noreferrer",children:"daggerheart.com"})]}),e.jsx("p",{children:e.jsx("em",{children:"This project is unofficial and not endorsed by Darrington Press or Critical Role."})})]})]}),e.jsx("button",{style:{display:"flex",alignItems:"center",justifyContent:"flex-start",padding:"0.25rem 1rem",color:"var(--text-primary)",border:"none",background:"none",width:"100%",textAlign:"left",cursor:"pointer",transition:"background-color 0.2s ease",fontSize:"0.875rem",minHeight:"32px",borderBottom:"1px solid rgba(255, 255, 255, 0.1)"},onMouseEnter:v=>{v.target.style.backgroundColor="var(--gray-dark)"},onMouseLeave:v=>{v.target.style.backgroundColor="transparent"},onClick:v=>{v.stopPropagation(),u(!1),window.open("https://github.com/Splinter714/Daggerheart","_blank")},children:e.jsx("div",{style:{display:"flex",alignItems:"center",justifyContent:"center",gap:"0.25rem"},children:e.jsx("span",{children:"GitHub"})})}),e.jsx("div",{style:{display:"flex",alignItems:"center",justifyContent:"flex-start",padding:"0.25rem 1rem",color:"var(--text-secondary)",border:"none",background:"none",width:"100%",textAlign:"left",cursor:"default",fontSize:"0.875rem",minHeight:"32px"},children:e.jsx("div",{style:{display:"flex",alignItems:"center",justifyContent:"center",gap:"0.25rem"},children:e.jsxs("span",{children:["Version ","0.3.4 (41c0fed)"]})})})]})]})},it=({adversaries:t,environments:a,countdowns:c,deleteAdversary:b,deleteEnvironment:g,deleteCountdown:d,isClearMode:y,setIsClearMode:u,showFlyout:v,onFlyoutChange:k})=>{const[S,T]=w.useState(!1),F=v!==void 0?v:S,h=k||T,f=((t==null?void 0:t.length)||0)>0||((a==null?void 0:a.length)||0)>0||((c==null?void 0:c.length)||0)>0,N=(t||[]).some(j=>(j.hp||0)>=(j.hpMax||1));w.useEffect(()=>{const j=P=>{P.target.closest(".delete-clear-container")||(h(!1),y&&u(!1))};return document.addEventListener("click",j),()=>document.removeEventListener("click",j)},[y,h]),w.useEffect(()=>{y&&!f&&(u(!1),h(!1))},[y,f,u,h]);const E={position:"absolute",top:"50%",right:"100%",left:"auto",transform:"translateY(-50%)",backgroundColor:"var(--bg-secondary)",border:"1px solid var(--border)",borderRadius:"var(--radius-md)",padding:"0.5rem",minWidth:"200px",boxShadow:"0 4px 12px rgba(0, 0, 0, 0.3)",zIndex:1e3,display:F?"block":"none",marginRight:"0.5rem"},z={background:y||F?"var(--red)":"none",border:"none",color:y||F?"white":f?"var(--text-primary)":"var(--text-secondary)",cursor:f?"pointer":"not-allowed",padding:"0.5rem",borderRadius:"50%",display:"flex",alignItems:"center",justifyContent:"center",transition:"all 0.2s",opacity:f?1:.5,minWidth:"44px",minHeight:"44px"},A={background:"none",border:"none",color:"var(--text-primary)",cursor:"pointer",padding:"0.5rem",borderRadius:"var(--radius-sm)",width:"100%",textAlign:"left",display:"flex",alignItems:"center",gap:"0.5rem",transition:"background-color 0.2s"},L={backgroundColor:"var(--bg-hover)"};return e.jsxs("div",{className:"delete-clear-container",style:{position:"relative"},children:[e.jsx("button",{style:z,onClick:j=>{j.stopPropagation(),f&&(y?(u(!1),h(!1)):(u(!0),h(!0)))},title:f?y?"Clear Items":"Enter Clear Mode":"Nothing to clear",children:e.jsx(Pe,{size:20})}),e.jsxs("div",{style:E,children:[t&&t.length>0&&e.jsxs("button",{style:A,onMouseEnter:j=>Object.assign(j.target.style,L),onMouseLeave:j=>Object.assign(j.target.style,A),onClick:j=>{j.stopPropagation(),T(!1),t.forEach(P=>b(P.id))},children:[e.jsx("span",{children:"×"}),e.jsx("span",{children:"All Adversaries"})]}),t&&t.length>0&&N&&e.jsxs("button",{style:A,onMouseEnter:j=>Object.assign(j.target.style,L),onMouseLeave:j=>Object.assign(j.target.style,A),onClick:j=>{j.stopPropagation(),T(!1),t.filter(D=>(D.hp||0)>=(D.hpMax||1)).forEach(D=>b(D.id))},children:[e.jsx("span",{children:"×"}),e.jsx("span",{children:"Dead Adversaries"})]}),a&&a.length>0&&e.jsxs("button",{style:A,onMouseEnter:j=>Object.assign(j.target.style,L),onMouseLeave:j=>Object.assign(j.target.style,A),onClick:j=>{j.stopPropagation(),T(!1),a.forEach(P=>g(P.id))},children:[e.jsx("span",{children:"×"}),e.jsx("span",{children:"All Environments"})]}),c&&c.length>0&&e.jsxs("button",{style:A,onMouseEnter:j=>Object.assign(j.target.style,L),onMouseLeave:j=>Object.assign(j.target.style,A),onClick:j=>{j.stopPropagation(),T(!1),c.forEach(P=>d(P.id))},children:[e.jsx("span",{children:"×"}),e.jsx("span",{children:"All Countdowns"})]})]})]})},ot=({adversaries:t,environments:a,countdowns:c,deleteAdversary:b,deleteEnvironment:g,deleteCountdown:d,isClearMode:y,setIsClearMode:u,sortAdversaries:v,onOpenDatabase:k})=>{const[S,T]=w.useState(!1),[F,h]=w.useState(!1),[f,N]=w.useState(!1);w.useEffect(()=>{const D=U=>{U.target.closest(".floating-menu-container")||(T(!1),h(!1),N(!1),y&&u(!1))};return document.addEventListener("click",D),()=>document.removeEventListener("click",D)},[y,u]),w.useEffect(()=>{S||(h(!1),N(!1),y&&u(!1))},[S,y,u]);const E=D=>{h(D),D&&(N(!1),y&&u(!1))},z=D=>{N(D),D&&h(!1)},L={position:"fixed",bottom:window.matchMedia("(display-mode: standalone)").matches||window.navigator.standalone===!0||document.referrer.includes("android-app://")?"calc(60px + env(safe-area-inset-bottom) + 2rem)":"calc(60px + env(safe-area-inset-bottom) + 1rem)",right:"1rem",zIndex:1100,display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center",pointerEvents:"none",width:"56px",height:"56px"},j={width:"56px",height:"56px",borderRadius:"50%",background:S?"var(--red)":"var(--bg-secondary)",border:"2px solid var(--border)",color:S?"white":"var(--text-primary)",display:"flex",alignItems:"center",justifyContent:"center",cursor:"pointer",boxShadow:"0 4px 12px rgba(0, 0, 0, 0.3)",transition:"all 0.3s ease",pointerEvents:"auto"},P=(D,U)=>{const s=135+D*135/(U-1),o=70,n=s*Math.PI/180,r=Math.cos(n)*o,x=Math.sin(n)*o;return{width:"48px",height:"48px",borderRadius:"50%",background:"var(--bg-secondary)",border:"1px solid var(--border)",color:"var(--text-primary)",display:"flex",alignItems:"center",justifyContent:"center",cursor:"pointer",boxShadow:"0 2px 8px rgba(0, 0, 0, 0.2)",transition:"all 0.3s ease",position:"absolute",pointerEvents:"auto",transform:S?`translate(${r}px, ${x}px)`:"translate(0px, 0px)",opacity:S?1:0,visibility:S?"visible":"hidden"}};return e.jsxs("div",{className:"floating-menu-container",style:L,children:[e.jsxs("div",{style:{position:"absolute",top:"0",left:"0",width:"56px",height:"56px",pointerEvents:"none"},children:[e.jsx("div",{style:P(0,4),children:e.jsx("button",{onClick:D=>{D.stopPropagation(),k("adversaries"),T(!1)},style:{width:"100%",height:"100%",background:"none",border:"none",color:"inherit",cursor:"pointer",display:"flex",alignItems:"center",justifyContent:"center"},title:"Browse Adversaries",children:e.jsx(He,{size:20})})}),e.jsx("div",{style:P(1,4),children:e.jsx("button",{onClick:D=>{D.stopPropagation(),k("environments"),T(!1)},style:{width:"100%",height:"100%",background:"none",border:"none",color:"inherit",cursor:"pointer",display:"flex",alignItems:"center",justifyContent:"center"},title:"Browse Environments",children:e.jsx(Fe,{size:20})})}),e.jsx("div",{style:P(2,4),children:e.jsx(it,{adversaries:t,environments:a,countdowns:c,deleteAdversary:b,deleteEnvironment:g,deleteCountdown:d,isClearMode:y,setIsClearMode:u,showFlyout:f,onFlyoutChange:z})}),e.jsx("div",{style:P(3,4),children:e.jsx(st,{showFlyout:F,onFlyoutChange:E})})]}),e.jsx("button",{style:j,onClick:D=>{D.stopPropagation(),T(!S)},title:S?"Close Menu":"Open Menu",children:S?e.jsx(oe,{size:24}):e.jsx(Oe,{size:24})})]})},at=({position:t="top",children:a,onClick:c,className:b="",style:g={}})=>{const d=t==="top",y=window.matchMedia("(display-mode: standalone)").matches||window.navigator.standalone===!0||document.referrer.includes("android-app://"),u={background:"var(--bg-primary)",borderTop:d?"none":"1px solid var(--border)",borderBottom:d?"1px solid var(--border)":"none",padding:d?"0.25rem 0":"0.5rem",paddingBottom:d?"0.25rem":y?"calc(0.5rem + env(safe-area-inset-bottom) + 1rem)":"calc(0.5rem + env(safe-area-inset-bottom))",position:d?"relative":"sticky",[d?"top":"bottom"]:0,zIndex:d?10:100,order:d?1:3,flexShrink:0,touchAction:"manipulation",userSelect:"none",display:"flex",flexDirection:d?"column":"row",justifyContent:d?"stretch":"center",alignItems:d?"stretch":"center",gap:d?"0":"1rem",height:d?"auto":"60px",...g};return e.jsx("div",{className:b,style:u,onClick:c,children:a})},ve=({value:t})=>e.jsxs("div",{style:{position:"relative",display:"flex",alignItems:"center",justifyContent:"center",width:"36px",height:"24px"},children:[e.jsx("svg",{width:"32",height:"24",viewBox:"0 0 32 24",fill:"none",stroke:"var(--text-secondary)",strokeWidth:"1",strokeLinecap:"round",strokeLinejoin:"round",style:{position:"absolute"},children:e.jsx("path",{d:"M2 2h20l4 10-4 10H2l4-10-4-10z"})}),e.jsx("span",{style:{position:"absolute",fontSize:"0.7rem",fontWeight:500,color:"var(--text-primary)",textAlign:"center",zIndex:1,left:"45%",top:"50%",transform:"translate(-50%, -50%)"},children:t})]}),Y={transitions:{hoverIn:"all 0.1s ease",hoverOut:"all 0.3s ease"},card:{backgroundColor:"var(--bg-card)",borderRadius:"8px",padding:"8px",cursor:"pointer",transition:"all 0.1s ease",position:"relative"},cardHover:{backgroundColor:"var(--bg-card-hover)"},cardDead:{opacity:.6,backgroundColor:"var(--gray-800)",borderColor:"var(--border)"},cardAtMax:{backgroundColor:"var(--success)",borderColor:"var(--success)"},rowMain:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:"8px"},rowTitle:{fontSize:"16px",fontWeight:"600",color:"var(--text-primary)",margin:0},rowMeta:{display:"flex",gap:"8px",alignItems:"center"},badge:{padding:"2px 6px",borderRadius:"3px",fontSize:"10px",fontWeight:"600",textTransform:"uppercase"},typeBadge:{backgroundColor:"var(--purple)",color:"var(--text-primary)"},tierBadge:{backgroundColor:"var(--info)",color:"var(--text-primary)"},damageInputPopup:{position:"absolute",top:0,left:0,right:0,bottom:0,backgroundColor:"rgba(0, 0, 0, 0.8)",display:"flex",alignItems:"center",justifyContent:"center",zIndex:1e3,borderRadius:"8px"},damageInputContent:{backgroundColor:"var(--gray-900)",borderWidth:"1px",borderStyle:"solid",borderColor:"var(--border)",borderRadius:"8px",padding:"8px",display:"flex",flexDirection:"row",gap:"8px",minWidth:"200px",alignItems:"center",position:"absolute",right:"1rem",top:"50%",transform:"translateY(-50%)"},damageInput:{backgroundColor:"var(--gray-900)",borderWidth:"1px",borderStyle:"solid",borderColor:"var(--border)",borderRadius:"4px",padding:"4px 6px",color:"var(--text-primary)",fontSize:"12px",width:"80px",textAlign:"center"},damageIndicators:{display:"flex",gap:"8px",alignItems:"center",justifyContent:"center"},damageDrop:{fontSize:"16px",color:"var(--text-secondary)",cursor:"pointer",transition:"color 0.1s ease"},applyButton:{backgroundColor:"var(--gray-600)",color:"white",borderWidth:"0",borderStyle:"none",borderRadius:"4px",padding:"4px 8px",fontSize:"14px",cursor:"pointer",transition:"background-color 0.1s ease",display:"flex",alignItems:"center",justifyContent:"center",minWidth:"32px",minHeight:"32px"}},lt=(t,a,c,b)=>{const[g,d]=w.useState(!1),[y,u]=w.useState("");w.useEffect(()=>{if(g){const h=f=>{f.target.closest(".damage-input-popup")||(d(!1),u(""))};return document.addEventListener("click",h),()=>document.removeEventListener("click",h)}},[g]);const v=h=>{h.stopPropagation(),h.preventDefault();const f=t.hp||0,N=t.hpMax||1,E=h.currentTarget.getBoundingClientRect(),z=h.clientX-E.left,A=E.width/N;Math.floor(z/A)<f?c&&c(t.id,1,t.hp):a&&a(t.id,1,t.hp,t.hpMax)},k=h=>{h.stopPropagation(),h.preventDefault();const f=t.stress||0,N=t.stressMax||1,E=h.currentTarget.getBoundingClientRect(),z=h.clientX-E.left,A=E.width/N;Math.floor(z/A)<f?b&&b(t.id,-1,t.stress,t.stressMax):b&&b(t.id,1,t.stress,t.stressMax)},S=h=>{h.stopPropagation(),(t.thresholds&&t.thresholds.major&&t.thresholds.severe||t.type==="Minion")&&(d(!0),u(t.type==="Minion"?"1":""))},T=()=>{const h=parseInt(y);if(h>0){if(t.type==="Minion")a&&a(t.id,h,t.hp,t.hpMax);else{let f=0;h>=t.thresholds.severe?f=3:h>=t.thresholds.major?f=2:h>=1&&(f=1),a&&a(t.id,f,t.hp,t.hpMax)}d(!1),u("")}};return{showDamageInput:g,damageValue:y,setDamageValue:u,setShowDamageInput:d,handleHpClick:v,handleStressClick:k,handleDifficultyClick:S,applyDamage:T,handleKeyDown:h=>{h.key==="Enter"?T():h.key==="Escape"&&(d(!1),u(""))}}},We=({item:t,type:a,mode:c="expanded",onClick:b,onDelete:g,onApplyDamage:d,onApplyHealing:y,onApplyStressChange:u,onUpdate:v,adversaries:k=[],isSelected:S=!1,isEditMode:T=!1,instances:F=[],isEmbedded:h=!1})=>{const f=lt(t,d,y,u);(a==="adversary"||a==="adversaries")&&f.handleDifficultyClick;const[N,E]=w.useState(!1),z=()=>{E(!0)},A=()=>{E(!1)},L=(s=!1)=>{let o={...Y.card};if(S?o.transition="none":o.transition=N?Y.transitions.hoverIn:Y.transitions.hoverOut,s){const{marginTop:n,...r}=o;o=r}return(N&&c!=="expanded"||S)&&(o={...o,...Y.cardHover}),a==="adversary"&&(t.hp||0)>=(t.hpMax||1)&&(o={...o,...Y.cardDead}),a==="countdown"&&(t.value||0)>=t.max&&(o={...o,...Y.cardAtMax}),o},j=()=>{if(h)return"";let s="border rounded-lg";return(N&&c!=="expanded"||S)&&(s+=" border-hover"),s},P=()=>{var s;if(a==="adversary"||a==="adversaries"){const o=t.baseName||((s=t.name)==null?void 0:s.replace(/\s+\(\d+\)$/,""))||"",n=t.duplicateNumber||1,r=[...k];return k.some(p=>p.id===t.id)||r.push(t),r.filter(p=>p.baseName===o).length>1?`${o} (${n})`:o}return t.name},D=()=>{const s=[];return t.type&&s.push(e.jsx("span",{style:{...Y.badge,...Y.typeBadge},children:t.type},"type")),a==="environment"&&t.tier&&s.push(e.jsxs("span",{style:{...Y.badge,...Y.tierBadge},children:["Tier ",t.tier]},"tier")),s},U=()=>a!=="adversary"||!f.showDamageInput||!(t.thresholds&&t.thresholds.major&&t.thresholds.severe||t.type==="Minion")?null:e.jsx("div",{className:"damage-input-popup",style:Y.damageInputPopup,onClick:s=>{s.stopPropagation(),s.target===s.currentTarget&&(a==="adversary"||a==="adversaries")&&(f.setShowDamageInput(!1),f.setDamageValue(""))},children:e.jsxs("div",{className:"border rounded-lg",style:{...Y.damageInputContent,borderColor:"var(--border)"},onClick:s=>s.stopPropagation(),children:[e.jsx("input",{type:"number",inputMode:"numeric",enterKeyHint:"done",placeholder:"dmg",min:(t.type==="Minion","0"),value:a==="adversary"||a==="adversaries"?f.damageValue:"",onChange:s=>{(a==="adversary"||a==="adversaries")&&f.setDamageValue(s.target.value)},onKeyDown:a==="adversary"||a==="adversaries"?f.handleKeyDown:void 0,className:"border rounded-sm",style:{...Y.damageInput,borderColor:"var(--border)"},autoFocus:!0}),e.jsxs("div",{style:Y.damageIndicators,children:[t.type==="Minion"?(()=>{var x,l;const s=parseInt(a==="adversary"||a==="adversaries"?f.damageValue:"0")||0,o=(x=t.features)==null?void 0:x.find(p=>{var C;return(C=p.name)==null?void 0:C.startsWith("Minion (")}),n=o?parseInt(((l=o.name.match(/\((\d+)\)/))==null?void 0:l[1])||"1"):1,r=Math.floor(s/n);return s>=n&&r>0?e.jsxs("span",{style:{...Y.damageDrop,color:"var(--red)"},title:`${s} damage can defeat ${r+1} minion${r+1!==1?"s":""} (1 + ${r} additional)`,children:["+",r," additional minion(s)"]}):e.jsx("span",{style:Y.damageDrop,title:`${s} damage defeats this minion only`,children:"+0 additional minion(s)"})})():[1,2,3].map(s=>{const o=parseInt(a==="adversary"||a==="adversaries"?f.damageValue:"0")||0;let n=!1;return s===1&&o>=1&&(n=!0),s===2&&o>=t.thresholds.major&&(n=!0),s===3&&o>=t.thresholds.severe&&(n=!0),e.jsx("span",{style:{...Y.damageDrop,color:n?"var(--red)":"var(--text-secondary)"},onClick:r=>{r.stopPropagation(),(a==="adversary"||a==="adversaries")&&(s===1?f.setDamageValue("1"):s===2?f.setDamageValue(t.thresholds.major.toString()):s===3&&f.setDamageValue(t.thresholds.severe.toString()))},title:`Click to set damage to ${s===1?"1":s===2?t.thresholds.major:t.thresholds.severe}`,children:e.jsx(Z,{size:16})},s)}),e.jsx("button",{style:{...Y.applyButton,backgroundColor:"var(--gray-600)"},onClick:s=>{s.stopPropagation(),(a==="adversary"||a==="adversaries")&&(!f.damageValue||parseInt(f.damageValue)<1?(f.setShowDamageInput(!1),f.setDamageValue("")):f.applyDamage())},title:!f.damageValue||parseInt(f.damageValue)<1?"Close damage input":"Apply damage",children:!f.damageValue||parseInt(f.damageValue)<1?e.jsx(oe,{size:16}):e.jsx(Ve,{size:16})})]})]})}),J=()=>{var n;const s=(t.hp||0)>=(t.hpMax||1),o=c==="edit";return e.jsxs("div",{className:j(),style:{...L(!0),padding:0,minHeight:"400px",opacity:s?.7:1,backgroundColor:s?"var(--gray-900)":L(!0).backgroundColor,borderColor:s?"color-mix(in srgb, var(--gray-600) 40%, transparent)":S?"var(--purple)":N&&c!=="expanded"?"var(--border-hover)":"var(--border)",borderWidth:"2px",display:"flex",flexDirection:"column",position:"relative"},onClick:b,...c!=="expanded"&&{onMouseEnter:z,onMouseLeave:A},children:[s&&e.jsxs(e.Fragment,{children:[e.jsx("div",{style:{position:"absolute",top:0,left:0,right:0,bottom:0,background:`repeating-linear-gradient(
                45deg,
                transparent,
                transparent 8px,
                var(--gray-600) 1px,
                var(--gray-600) 9px
              )`,pointerEvents:"none",zIndex:9999}}),e.jsx("div",{style:{position:"absolute",top:"50%",left:"50%",transform:"translate(-50%, -50%)",color:"var(--text-secondary)",fontSize:"1rem",fontWeight:600,textTransform:"uppercase",letterSpacing:"0.05em",zIndex:1e4,pointerEvents:"none",textShadow:"1px 1px 2px rgba(0, 0, 0, 0.5)",backgroundColor:"var(--gray-900)",padding:"0.25rem 0.5rem",borderRadius:"0.5rem",border:"0.5px solid var(--gray-600)"},children:"DEFEATED"})]}),e.jsx("div",{className:"border-b",style:{padding:"8px",flexShrink:0,backgroundColor:"var(--bg-card)",borderRadius:"8px 8px 0 0",position:"relative",zIndex:s?1:"auto",borderBottomColor:S?"var(--purple)":"var(--border)"},children:e.jsx("div",{style:{display:"flex",justifyContent:"flex-start",alignItems:"center",position:"relative",zIndex:s?1:"auto"},children:e.jsx("h4",{style:{...Y.rowTitle,color:s?"color-mix(in srgb, var(--gray-400) 80%, transparent)":Y.rowTitle.color,textAlign:"left",margin:0,fontSize:"1.1rem"},children:((n=t.name)==null?void 0:n.replace(/\s+\(\d+\)$/,""))||t.name})})}),e.jsxs("div",{style:{borderRadius:"0 0 8px 8px"},children:[e.jsx("div",{style:{marginBottom:"1rem",padding:"0 8px 0.75rem 8px",borderBottom:"1px solid var(--border)"},children:e.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:"0.5rem",fontSize:"0.875rem"},children:[e.jsx("div",{style:{display:"flex",alignItems:"center",gap:"1rem",flexWrap:"wrap"},children:e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"0.5rem"},children:[e.jsxs("div",{style:{position:"relative",display:"flex",alignItems:"center",justifyContent:"center",width:"32px",height:"32px"},children:[e.jsx(de,{size:32,style:{color:"var(--text-primary)",transform:"rotate(0deg)"}}),e.jsx("span",{style:{position:"absolute",fontSize:"0.75rem",fontWeight:600,color:"var(--text-primary)",textAlign:"center"},children:t.difficulty||"~"})]}),e.jsx("span",{style:{fontSize:"0.875rem",fontWeight:500},children:"Difficulty"})]})}),(t.atk!==void 0||t.weapon||t.damage)&&e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"1rem",flexWrap:"wrap"},children:[t.atk!==void 0&&e.jsxs("div",{style:{display:"flex",alignItems:"center",justifyContent:"center",position:"relative"},children:[e.jsx(qe,{size:32,strokeWidth:1,style:{color:"var(--text-secondary)"}}),e.jsxs("span",{style:{position:"absolute",fontSize:"0.875rem",fontWeight:600,color:"white",pointerEvents:"none"},children:[t.atk>=0?"+":"",t.atk]})]}),t.weapon&&e.jsxs("span",{children:[e.jsxs("strong",{children:[t.weapon,":"]})," ",t.range||"Melee"]}),t.damage&&e.jsxs("span",{children:[e.jsx("strong",{children:"Damage:"})," ",t.damage]})]}),t.experience&&t.experience.length>0&&e.jsxs("div",{children:[e.jsx("strong",{children:"Experience:"})," ",t.experience.map(r=>typeof r=="string"?r:`${r.name} ${r.modifier>=0?"+":""}${r.modifier}`).join(", ")]})]})}),t.features&&t.features.length>0&&e.jsxs("div",{style:{marginBottom:"1rem",padding:"0 8px"},children:[t.features.filter(r=>r.type==="Passive").length>0&&e.jsxs("div",{style:{marginBottom:"1rem"},children:[e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"0.75rem",marginBottom:"0.75rem"},children:[e.jsx("hr",{style:{flex:1,border:"none",borderTop:"1px solid var(--border)",margin:0}}),e.jsx("h4",{style:{fontSize:"0.875rem",fontWeight:600,color:"white",margin:0,textTransform:"uppercase",letterSpacing:"0.5px",textAlign:"center",minWidth:"80px"},children:"Passives"}),e.jsx("hr",{style:{flex:1,border:"none",borderTop:"1px solid var(--border)",margin:0}})]}),e.jsx("div",{style:{display:"flex",flexDirection:"column",gap:"0.5rem"},children:t.features.filter(r=>r.type==="Passive").map((r,x)=>e.jsxs("div",{style:{fontSize:"0.875rem",lineHeight:1.4,color:"var(--text-secondary)"},children:[e.jsx("span",{style:{fontWeight:600,color:"var(--text-primary)"},children:r.name}),r.description&&e.jsxs("span",{children:[" - ",r.description]})]},x))})]}),t.features.filter(r=>r.type==="Action").length>0&&e.jsxs("div",{style:{marginBottom:"1rem"},children:[e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"0.75rem",marginBottom:"0.75rem"},children:[e.jsx("hr",{style:{flex:1,border:"none",borderTop:"1px solid var(--border)",margin:0}}),e.jsx("h4",{style:{fontSize:"0.875rem",fontWeight:600,color:"white",margin:0,textTransform:"uppercase",letterSpacing:"0.5px",textAlign:"center",minWidth:"80px"},children:"Actions"}),e.jsx("hr",{style:{flex:1,border:"none",borderTop:"1px solid var(--border)",margin:0}})]}),e.jsx("div",{style:{display:"flex",flexDirection:"column",gap:"0.5rem"},children:t.features.filter(r=>r.type==="Action").map((r,x)=>e.jsxs("div",{style:{fontSize:"0.875rem",lineHeight:1.4,color:"var(--text-secondary)"},children:[e.jsx("span",{style:{fontWeight:600,color:"var(--text-primary)"},children:r.name}),r.description&&e.jsxs("span",{children:[" - ",r.description]})]},x))})]}),t.features.filter(r=>r.type==="Reaction").length>0&&e.jsxs("div",{style:{marginBottom:"1rem"},children:[e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"0.75rem",marginBottom:"0.75rem"},children:[e.jsx("hr",{style:{flex:1,border:"none",borderTop:"1px solid var(--border)",margin:0}}),e.jsx("h4",{style:{fontSize:"0.875rem",fontWeight:600,color:"white",margin:0,textTransform:"uppercase",letterSpacing:"0.5px",textAlign:"center",minWidth:"80px"},children:"Reactions"}),e.jsx("hr",{style:{flex:1,border:"none",borderTop:"1px solid var(--border)",margin:0}})]}),e.jsx("div",{style:{display:"flex",flexDirection:"column",gap:"0.5rem"},children:t.features.filter(r=>r.type==="Reaction").map((r,x)=>e.jsxs("div",{style:{fontSize:"0.875rem",lineHeight:1.4,color:"var(--text-secondary)"},children:[e.jsx("span",{style:{fontWeight:600,color:"var(--text-primary)"},children:r.name}),r.description&&e.jsxs("span",{children:[" - ",r.description]})]},x))})]})]})]}),t.type!=="Minion"&&t.thresholds&&e.jsx("div",{style:{marginTop:"1rem",padding:"0.75rem 8px 0 8px",borderTop:"1px solid var(--border)"},children:e.jsxs("div",{style:{display:"flex",alignItems:"center",justifyContent:"center",gap:"0.5rem",fontSize:"0.875rem"},children:[e.jsx("div",{style:{display:"flex",alignItems:"center",justifyContent:"center",gap:"2px",marginTop:"-3px"},children:e.jsx(Z,{size:16,style:{color:"var(--red)"}})}),e.jsx(ve,{value:t.thresholds.major||"7"}),e.jsxs("div",{style:{display:"flex",alignItems:"center",justifyContent:"center",gap:"2px",marginTop:"-3px"},children:[e.jsx(Z,{size:16,style:{color:"var(--red)"}}),e.jsx(Z,{size:16,style:{color:"var(--red)"}})]}),e.jsx(ve,{value:t.thresholds.severe||"14"}),e.jsxs("div",{style:{display:"flex",alignItems:"center",justifyContent:"center",gap:"2px",marginTop:"-3px"},children:[e.jsx(Z,{size:16,style:{color:"var(--red)"}}),e.jsx(Z,{size:16,style:{color:"var(--red)"}}),e.jsx(Z,{size:16,style:{color:"var(--red)"}})]})]})}),F&&F.length>0&&e.jsx("div",{style:{marginTop:"1rem",borderTop:"1px solid var(--border)"},children:F.map((r,x)=>{const l=(r.hp||0)>=(r.hpMax||1);return e.jsx("div",{children:e.jsxs("div",{style:{backgroundColor:"var(--bg-secondary)",borderRadius:"4px",padding:"4px",border:"1px solid var(--border)",marginBottom:"4px",display:"flex",justifyContent:"flex-start",alignItems:"center",gap:"8px",opacity:l?.7:1,backgroundColor:l?"var(--gray-900)":"var(--bg-secondary)",borderColor:l?"color-mix(in srgb, var(--gray-600) 40%, transparent)":"var(--border)",position:"relative"},children:[l&&e.jsxs(e.Fragment,{children:[e.jsx("div",{style:{position:"absolute",top:0,left:0,right:0,bottom:0,background:`repeating-linear-gradient(
                          45deg,
                          transparent 0px,
                          transparent 8px,
                          var(--gray-600) 9px,
                          var(--gray-600) 9px
                        )`,pointerEvents:"none",zIndex:1,borderRadius:"4px"}}),e.jsx("div",{style:{position:"absolute",top:"50%",left:"50%",transform:"translate(-50%, -50%)",color:"var(--text-secondary)",fontSize:"0.75rem",fontWeight:600,textTransform:"uppercase",letterSpacing:"0.05em",zIndex:2,backgroundColor:"var(--gray-900)",padding:"0.125rem 0.25rem",borderRadius:"0.25rem",border:"0.5px solid var(--gray-600)"},children:"DEFEATED"})]}),e.jsx("div",{style:{backgroundColor:"var(--bg-secondary)",borderRadius:"6px",border:"1px solid var(--border-hover)",width:"32px",textAlign:"center",flexShrink:0,padding:"2px"},children:e.jsx("span",{style:{fontSize:"1rem",fontWeight:600,color:"var(--text-primary)"},children:r.duplicateNumber||1})}),e.jsxs("div",{style:{display:"flex",flexDirection:"column",alignItems:"flex-start",gap:"2px"},children:[e.jsx("div",{style:{display:"flex",alignItems:"center",cursor:"pointer"},onClick:p=>{if(p.stopPropagation(),!d||a!=="adversary")return;p.currentTarget.getBoundingClientRect();const C=p.currentTarget.querySelector(".pip-container");if(!C)return;const I=C.getBoundingClientRect(),q=p.clientX-I.left,V=r.hp||0,B=r.hpMax||1;if(q<0){V>0&&y&&y(r.id,1,V);return}if(q>I.width){V<B&&d(r.id,1,V,B);return}const R=I.width,G=R*.05,m=R-2*G,O=q-G,H=V/B,X=m*H;O<X?V>0&&y&&y(r.id,1,V):V<B&&d(r.id,1,V,B)},children:e.jsx("div",{className:"pip-container",style:{display:"flex",gap:"2px",alignItems:"center"},children:Array.from({length:r.hpMax||1},(p,C)=>e.jsx("span",{style:{fontSize:"0.75rem",color:C<(r.hp||0)?"var(--red)":"var(--text-secondary)",transition:"all 0.1s ease"},children:e.jsx(Z,{size:16})},C))})}),r.stressMax>0&&e.jsx("div",{style:{display:"flex",alignItems:"center",cursor:"pointer"},onClick:p=>{if(p.stopPropagation(),!u||a!=="adversary")return;p.currentTarget.getBoundingClientRect();const C=p.currentTarget.querySelector(".pip-container");if(!C)return;const I=C.getBoundingClientRect(),q=p.clientX-I.left,V=r.stress||0,B=r.stressMax;if(q<0){V>0&&u(r.id,-1);return}if(q>I.width){V<B&&u(r.id,1);return}const R=I.width,G=R*.05,m=R-2*G,O=q-G,H=V/B,X=m*H;O<X?V>0&&u(r.id,-1):V<B&&u(r.id,1)},children:e.jsx("div",{className:"pip-container",style:{display:"flex",gap:"2px",alignItems:"center"},children:Array.from({length:r.stressMax},(p,C)=>e.jsx("span",{style:{fontSize:"0.75rem",color:C<(r.stress||0)?"var(--gold)":"var(--text-secondary)",transition:"all 0.1s ease"},children:e.jsx(Se,{size:16})},C))})})]})]},r.id)},r.id)})}),t.motives&&e.jsxs("div",{style:{marginTop:"1rem",padding:"0.75rem 8px 0 8px",borderTop:"1px solid var(--border)"},children:[e.jsx("h3",{style:{fontSize:"1rem",fontWeight:600,color:"var(--text-primary)",margin:"0 0 0.5rem 0"},children:"Motives"}),o?e.jsx("textarea",{style:{width:"100%",minHeight:"80px",padding:"0.5rem",border:"1px solid var(--border)",borderRadius:"0.5rem",backgroundColor:"var(--bg-secondary)",color:"white",fontSize:"0.875rem",lineHeight:1.5,resize:"vertical",fontFamily:"inherit"},value:t.motives,onChange:r=>{v&&v(t.id,{motives:r.target.value})},placeholder:"Enter adversary motives..."}):e.jsx("p",{style:{fontSize:"0.875rem",lineHeight:1.5,color:"var(--text-secondary)",margin:0,whiteSpace:"pre-wrap"},children:t.motives})]}),t.description&&e.jsxs("div",{style:{marginTop:"1rem",padding:"0.75rem 8px 0 8px",borderTop:"1px solid var(--border)"},children:[e.jsx("h3",{style:{fontSize:"1rem",fontWeight:600,color:"var(--text-primary)",margin:"0 0 0.5rem 0"},children:"Description"}),o?e.jsx("textarea",{style:{width:"100%",minHeight:"100px",padding:"0.5rem",border:"1px solid var(--border)",borderRadius:"0.5rem",backgroundColor:"var(--bg-secondary)",color:"white",fontSize:"0.875rem",lineHeight:1.5,resize:"vertical",fontFamily:"inherit"},value:t.description,onChange:r=>{v&&v(t.id,{description:r.target.value})},placeholder:"Enter adversary description..."}):e.jsx("p",{style:{fontSize:"0.875rem",lineHeight:1.5,color:"var(--text-secondary)",margin:0,whiteSpace:"pre-wrap"},children:t.description})]}),U()]})},M=()=>{const o=c==="edit";return e.jsxs("div",{className:j(),style:{...L(!0),padding:0,minHeight:"400px",display:"flex",flexDirection:"column",position:"relative"},onClick:b,...c!=="expanded"&&{onMouseEnter:z,onMouseLeave:A},children:[e.jsx("div",{className:"border-b",style:{padding:"8px",flexShrink:0,backgroundColor:"var(--bg-card)",borderRadius:"8px 8px 0 0",position:"relative"},children:e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",gap:"0.5rem"},children:[e.jsxs("div",{style:{display:"flex",flexDirection:"column",alignItems:"flex-start",gap:"0.25rem"},children:[e.jsx("h2",{style:{fontSize:"1rem",fontWeight:600,color:"var(--text-primary)",margin:0},children:t.name}),e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"0.25rem"},children:[t.tier&&e.jsxs("span",{style:{fontSize:"0.75rem",fontWeight:500,color:"var(--text-secondary)",letterSpacing:"0.5px"},children:["Tier ",t.tier]}),t.type&&e.jsx("span",{style:{fontSize:"0.75rem",fontWeight:500,color:"var(--text-secondary)",letterSpacing:"0.5px"},children:t.type})]})]}),e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"0.5rem"},children:[t.difficulty&&e.jsxs("div",{style:{display:"flex",alignItems:"center",justifyContent:"center",position:"relative"},children:[e.jsx(de,{size:32,strokeWidth:1,style:{color:"var(--text-secondary)"}}),e.jsx("span",{style:{position:"absolute",top:"50%",left:"50%",transform:"translate(-50%, -50%)",fontSize:"0.75rem",fontWeight:700,color:"white",pointerEvents:"none"},children:t.difficulty})]}),!1]})]})}),e.jsxs("div",{style:{flex:1,overflowY:"auto",borderRadius:"0 0 8px 8px"},children:[t.description&&e.jsxs("div",{style:{marginBottom:"1rem",padding:"0 8px 0.75rem 8px",borderBottom:"1px solid var(--border)"},children:[e.jsx("h3",{style:{fontSize:"1rem",fontWeight:600,color:"var(--text-primary)",margin:"0 0 0.5rem 0"},children:"Description"}),o?e.jsx("textarea",{style:{width:"100%",minHeight:"100px",padding:"0.5rem",border:"1px solid var(--border)",borderRadius:"0.5rem",backgroundColor:"var(--bg-secondary)",color:"white",fontSize:"0.875rem",lineHeight:1.5,resize:"vertical",fontFamily:"inherit"},value:t.description,onChange:n=>{v&&v(t.id,{description:n.target.value})},placeholder:"Enter environment description..."}):e.jsx("p",{style:{fontSize:"0.875rem",lineHeight:1.5,color:"var(--text-secondary)",margin:0,whiteSpace:"pre-wrap"},children:t.description})]}),t.impulses&&e.jsxs("div",{style:{marginBottom:"1rem",padding:"0 8px 0.75rem 8px",borderBottom:"1px solid var(--border)"},children:[e.jsx("h3",{style:{fontSize:"1rem",fontWeight:600,color:"var(--text-primary)",margin:"0 0 0.5rem 0"},children:"Impulses"}),e.jsx("p",{style:{fontSize:"0.875rem",lineHeight:1.5,color:"var(--text-secondary)",margin:0,whiteSpace:"pre-wrap"},children:t.impulses})]}),e.jsxs("div",{style:{marginBottom:"1rem",padding:"0 8px 0.75rem 8px",borderBottom:"1px solid var(--border)"},children:[e.jsx("h3",{style:{fontSize:"1rem",fontWeight:600,color:"var(--text-primary)",margin:"0 0 0.5rem 0"},children:"Core Stats"}),e.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:"0.5rem",fontSize:"0.875rem"},children:[e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"1rem",flexWrap:"wrap",fontSize:"0.875rem"},children:[e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"0.5rem"},children:[e.jsxs("div",{style:{position:"relative",display:"flex",alignItems:"center",justifyContent:"center",width:"32px",height:"32px"},children:[e.jsx(de,{size:32,style:{color:"var(--text-primary)",transform:"rotate(0deg)"}}),e.jsx("span",{style:{position:"absolute",fontSize:"0.75rem",fontWeight:600,color:"var(--text-primary)",textAlign:"center"},children:t.difficulty||"~"})]}),e.jsx("span",{style:{fontSize:"0.875rem",fontWeight:500},children:"Difficulty"})]}),e.jsxs("span",{children:[e.jsx("strong",{children:"Type:"})," ",t.type]}),e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"1rem"},children:[e.jsx("span",{children:e.jsx("strong",{children:"Tier:"})}),e.jsxs("div",{style:{display:"flex",alignItems:"center",justifyContent:"center",position:"relative"},children:[e.jsx($e,{size:32,strokeWidth:1,style:{color:"var(--text-secondary)"}}),e.jsx("span",{style:{position:"absolute",fontSize:"0.875rem",fontWeight:600,color:"white",pointerEvents:"none"},children:t.tier})]})]})]}),t.potentialAdversaries&&t.potentialAdversaries.length>0&&e.jsxs("div",{children:[e.jsx("strong",{children:"Potential Adversaries:"}),e.jsx("div",{style:{marginTop:"0.25rem",display:"flex",flexDirection:"column",gap:"0.125rem"},children:t.potentialAdversaries.map((n,r)=>e.jsxs("div",{style:{fontSize:"0.75rem",color:"var(--text-secondary)",marginLeft:"0.5rem"},children:["• ",n]},r))})]})]})]}),t.features&&t.features.length>0&&e.jsxs("div",{style:{marginBottom:"1rem",padding:"0 8px"},children:[t.features.filter(n=>n.type==="Passive").length>0&&e.jsxs("div",{style:{marginBottom:"1rem"},children:[e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"0.75rem",marginBottom:"0.75rem"},children:[e.jsx("hr",{style:{flex:1,border:"none",borderTop:"1px solid var(--border)",margin:0}}),e.jsx("h4",{style:{fontSize:"0.875rem",fontWeight:600,color:"white",margin:0,textTransform:"uppercase",letterSpacing:"0.5px",textAlign:"center",minWidth:"80px"},children:"Passives"}),e.jsx("hr",{style:{flex:1,border:"none",borderTop:"1px solid var(--border)",margin:0}})]}),e.jsx("div",{style:{display:"flex",flexDirection:"column",gap:"0.75rem"},children:t.features.filter(n=>n.type==="Passive").map((n,r)=>e.jsxs("div",{style:{fontSize:"0.875rem",lineHeight:1.4,color:"var(--text-secondary)"},children:[e.jsx("div",{style:{fontWeight:600,color:"white",marginBottom:"0.25rem"},children:n.name}),e.jsx("div",{style:{marginBottom:"0.25rem"},children:n.description}),n.details&&n.details.length>0&&e.jsxs("div",{style:{marginLeft:"0.5rem"},children:[e.jsx("strong",{children:"Details:"}),e.jsx("ul",{style:{margin:"0.25rem 0 0 0",paddingLeft:"1rem",fontSize:"0.75rem"},children:n.details.map((x,l)=>e.jsx("li",{children:x},l))})]}),n.prompts&&n.prompts.length>0&&e.jsxs("div",{style:{marginLeft:"0.5rem"},children:[e.jsx("strong",{children:"Prompts:"}),e.jsx("ul",{style:{margin:"0.25rem 0 0 0",paddingLeft:"1rem",fontSize:"0.75rem"},children:n.prompts.map((x,l)=>e.jsxs("li",{style:{fontStyle:"italic"},children:['"',x,'"']},l))})]})]},r))})]}),t.features.filter(n=>n.type==="Action").length>0&&e.jsxs("div",{style:{marginBottom:"1rem"},children:[e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"0.75rem",marginBottom:"0.75rem"},children:[e.jsx("hr",{style:{flex:1,border:"none",borderTop:"1px solid var(--border)",margin:0}}),e.jsx("h4",{style:{fontSize:"0.875rem",fontWeight:600,color:"white",margin:0,textTransform:"uppercase",letterSpacing:"0.5px",textAlign:"center",minWidth:"80px"},children:"Actions"}),e.jsx("hr",{style:{flex:1,border:"none",borderTop:"1px solid var(--border)",margin:0}})]}),e.jsx("div",{style:{display:"flex",flexDirection:"column",gap:"0.75rem"},children:t.features.filter(n=>n.type==="Action").map((n,r)=>e.jsxs("div",{style:{fontSize:"0.875rem",lineHeight:1.4,color:"var(--text-secondary)"},children:[e.jsx("div",{style:{fontWeight:600,color:"white",marginBottom:"0.25rem"},children:n.name}),e.jsx("div",{style:{marginBottom:"0.25rem"},children:n.description}),n.details&&n.details.length>0&&e.jsxs("div",{style:{marginLeft:"0.5rem"},children:[e.jsx("strong",{children:"Details:"}),e.jsx("ul",{style:{margin:"0.25rem 0 0 0",paddingLeft:"1rem",fontSize:"0.75rem"},children:n.details.map((x,l)=>e.jsx("li",{children:x},l))})]}),n.prompts&&n.prompts.length>0&&e.jsxs("div",{style:{marginLeft:"0.5rem"},children:[e.jsx("strong",{children:"Prompts:"}),e.jsx("ul",{style:{margin:"0.25rem 0 0 0",paddingLeft:"1rem",fontSize:"0.75rem"},children:n.prompts.map((x,l)=>e.jsxs("li",{style:{fontStyle:"italic"},children:['"',x,'"']},l))})]})]},r))})]}),t.features.filter(n=>n.type==="Reaction").length>0&&e.jsxs("div",{style:{marginBottom:"1rem"},children:[e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"0.75rem",marginBottom:"0.75rem"},children:[e.jsx("hr",{style:{flex:1,border:"none",borderTop:"1px solid var(--border)",margin:0}}),e.jsx("h4",{style:{fontSize:"0.875rem",fontWeight:600,color:"white",margin:0,textTransform:"uppercase",letterSpacing:"0.5px",textAlign:"center",minWidth:"80px"},children:"Reactions"}),e.jsx("hr",{style:{flex:1,border:"none",borderTop:"1px solid var(--border)",margin:0}})]}),e.jsx("div",{style:{display:"flex",flexDirection:"column",gap:"0.75rem"},children:t.features.filter(n=>n.type==="Reaction").map((n,r)=>e.jsxs("div",{style:{fontSize:"0.875rem",lineHeight:1.4,color:"var(--text-secondary)"},children:[e.jsx("div",{style:{fontWeight:600,color:"white",marginBottom:"0.25rem"},children:n.name}),e.jsx("div",{style:{marginBottom:"0.25rem"},children:n.description}),n.details&&n.details.length>0&&e.jsxs("div",{style:{marginLeft:"0.5rem"},children:[e.jsx("strong",{children:"Details:"}),e.jsx("ul",{style:{margin:"0.25rem 0 0 0",paddingLeft:"1rem",fontSize:"0.75rem"},children:n.details.map((x,l)=>e.jsx("li",{children:x},l))})]}),n.prompts&&n.prompts.length>0&&e.jsxs("div",{style:{marginLeft:"0.5rem"},children:[e.jsx("strong",{children:"Prompts:"}),e.jsx("ul",{style:{margin:"0.25rem 0 0 0",paddingLeft:"1rem",fontSize:"0.75rem"},children:n.prompts.map((x,l)=>e.jsxs("li",{style:{fontStyle:"italic"},children:['"',x,'"']},l))})]})]},r))})]})]}),F&&F.length>0&&e.jsx("div",{style:{marginTop:"1rem",borderTop:"1px solid var(--border)"},children:F.map((n,r)=>{const x=(n.hp||0)>=(n.hpMax||1);return e.jsx("div",{children:e.jsxs("div",{style:{backgroundColor:"var(--bg-secondary)",borderRadius:"4px",padding:"8px",border:"1px solid var(--border)",marginBottom:"4px",display:"flex",justifyContent:"space-between",alignItems:"center",gap:"8px",opacity:x?.7:1,backgroundColor:x?"var(--gray-900)":"var(--bg-secondary)",borderColor:x?"color-mix(in srgb, var(--gray-600) 40%, transparent)":"var(--border)",position:"relative"},children:[x&&e.jsxs(e.Fragment,{children:[e.jsx("div",{style:{position:"absolute",top:0,left:0,right:0,bottom:0,background:`repeating-linear-gradient(
                            45deg,
                            transparent 0px,
                            transparent 8px,
                            var(--gray-600) 9px,
                            var(--gray-600) 9px
                          )`,pointerEvents:"none",zIndex:1,borderRadius:"4px"}}),e.jsx("div",{style:{position:"absolute",top:"50%",left:"50%",transform:"translate(-50%, -50%)",color:"var(--text-secondary)",fontSize:"0.75rem",fontWeight:600,textTransform:"uppercase",letterSpacing:"0.05em",zIndex:2,backgroundColor:"var(--gray-900)",padding:"0.125rem 0.25rem",borderRadius:"0.25rem",border:"0.5px solid var(--gray-600)"},children:"DEFEATED"})]}),e.jsx("div",{style:{backgroundColor:"var(--bg-secondary)",borderRadius:"3px",padding:"2px 6px",border:"1px solid var(--border)",minWidth:"24px",textAlign:"center"},children:e.jsx("span",{style:{fontSize:"0.75rem",fontWeight:600,color:"var(--text-primary)"},children:n.duplicateNumber||1})}),e.jsx("div",{style:{display:"flex",alignItems:"center",justifyContent:"center",flex:1},children:e.jsxs("span",{style:{fontSize:"0.75rem",fontWeight:500,color:"var(--text-secondary)"},children:["Instance ",r+1]})})]},n.id)},n.id)})})]})]})};return(c==="expanded"||c==="edit")&&(a==="adversary"||a==="adversaries")?J():(c==="expanded"||c==="edit")&&(a==="environment"||a==="environments")?M():a==="adversary"||a==="adversaries"||a==="environment"||a==="environments"?null:e.jsxs("div",{className:j(),style:L(!0),children:[e.jsxs("div",{style:Y.rowMain,children:[e.jsx("h4",{style:Y.rowTitle,children:P()}),e.jsx("div",{style:Y.rowMeta,children:D()})]}),e.jsxs("p",{style:{color:"var(--text-secondary)",fontSize:"12px",margin:0},children:["Expanded view coming soon for ",a]})]})},dt="modulepreload",ct=function(t){return"/Daggerheart/"+t},be={},je=function(a,c,b){if(!c||c.length===0)return a();const g=document.getElementsByTagName("link");return Promise.all(c.map(d=>{if(d=ct(d),d in be)return;be[d]=!0;const y=d.endsWith(".css"),u=y?'[rel="stylesheet"]':"";if(!!b)for(let S=g.length-1;S>=0;S--){const T=g[S];if(T.href===d&&(!y||T.rel==="stylesheet"))return}else if(document.querySelector(`link[href="${d}"]${u}`))return;const k=document.createElement("link");if(k.rel=y?"stylesheet":dt,y||(k.as="script",k.crossOrigin=""),k.href=d,document.head.appendChild(k),y)return new Promise((S,T)=>{k.addEventListener("load",S),k.addEventListener("error",()=>T(new Error(`Unable to preload CSS for ${d}`)))})})).then(()=>a()).catch(d=>{const y=new Event("vite:preloadError",{cancelable:!0});if(y.payload=d,window.dispatchEvent(y),!y.defaultPrevented)throw d})},ae={Minion:1,Social:1,Support:1,Horde:2,Ranged:2,Skulk:2,Standard:2,Leader:3,Bruiser:4,Solo:5},we={twoOrMoreSolos:-2,noBruisersHordesLeadersSolos:1,lowerTierAdversary:1};let Ae={adversaries:[]},ze={environments:[]};const pt=async()=>{try{const t=await je(()=>import("./adversaries-77db5e43.js"),[]);Ae=(t==null?void 0:t.default)||t}catch(t){console.warn("Failed to load adversaries.json:",t)}try{const t=await je(()=>import("./environments-5ca1c1e1.js"),[]);ze=(t==null?void 0:t.default)||t}catch(t){console.warn("Failed to load environments.json:",t)}},xt=(t,a=[],c=4,b=1)=>{const[g,d]=w.useState(""),[y,u]=w.useState([{field:"tier",direction:"asc"},{field:"name",direction:"asc"}]),[v,k]=w.useState([]),[S,T]=w.useState(!0),[F,h]=w.useState([]),[f,N]=w.useState([]),[E,z]=w.useState(!1),[A,L]=w.useState(!1),j=w.useRef(null),P=w.useRef(null);w.useEffect(()=>{(async()=>{await pt(),T(!1);let p=[];t==="adversary"?p=Ae.adversaries||[]:t==="environment"&&(p=ze.environments||[]),k(p)})()},[t]);const D=l=>{const p=v.map(C=>C[l]).filter(Boolean);return[...new Set(p)].sort((C,I)=>typeof C=="number"&&typeof I=="number"?C-I:String(C).localeCompare(String(I)))},U=D("tier"),J=D("type"),M=w.useMemo(()=>{let l=v.filter(p=>{var V,B;const C=p.name.toLowerCase().includes(g.toLowerCase())||((V=p.type)==null?void 0:V.toLowerCase().includes(g.toLowerCase()))||((B=p.description)==null?void 0:B.toLowerCase().includes(g.toLowerCase())),I=F.length===0||(F.includes("party-tier")?p.tier===b:F.includes(p.tier.toString())),q=f.length===0||f.includes(p.type);return C&&I&&q});return l.sort((p,C)=>{for(const I of y){const{field:q,direction:V}=I;let B=p[q],R=C[q];if(q==="tier")B=parseInt(B)||0,R=parseInt(R)||0;else if(q==="cost"){const G=m=>{if(t!=="adversary")return 0;const O=ae[m.type]||2;let H=0;const X=a.filter($=>$.type==="adversary"&&$.item.type==="Solo"&&$.quantity>0).reduce(($,K)=>$+K.quantity,0),Q=a.filter($=>$.type==="adversary"&&["Bruiser","Horde","Leader","Solo"].includes($.item.type)&&$.quantity>0).reduce(($,K)=>$+K.quantity,0);return m.type==="Solo"&&X===1&&(H+=2),["Bruiser","Horde","Leader","Solo"].includes(m.type)&&Q===0&&(H+=1),O+H};B=G(p),R=G(C)}else if(q==="difficulty"){const G=parseInt(B),m=parseInt(R);!isNaN(G)&&!isNaN(m)?(B=G,R=m):!isNaN(G)&&isNaN(m)?(B=G,R=999):isNaN(G)&&!isNaN(m)?(B=999,R=m):(B=String(B||"").toLowerCase(),R=String(R||"").toLowerCase())}else typeof B=="string"&&typeof R=="string"?(B=B.toLowerCase(),R=R.toLowerCase()):(B=String(B||"").toLowerCase(),R=String(R||"").toLowerCase());if(V==="asc"){if(B>R)return 1;if(B<R)return-1}else{if(B<R)return 1;if(B>R)return-1}}return 0}),l},[v,g,y,F,f,a,c,b]),i=l=>{u(p=>{const C=p.findIndex(I=>I.field===l);if(C>=0)if(C===0){const I=[...p];return I[0]={...I[0],direction:I[0].direction==="asc"?"desc":"asc"},I}else{const I=[...p];return I.splice(C,1)[0],[{field:l,direction:"asc"},...I]}else return[{field:l,direction:"asc"},...p]})},s=l=>{h(l==="clear"?[]:l==="party-tier"?["party-tier"]:p=>p.includes(l)?p.filter(C=>C!==l):[...p,l])},o=l=>{N(l==="clear"?[]:p=>p.includes(l)?p.filter(C=>C!==l):[...p,l])},n=F.length>0,r=f.length>0;return w.useEffect(()=>{const l=C=>{const I=C.target.closest(".filter-dropdown"),q=C.target.closest(".header-filter-icon");I||q||(z(!1),L(!1))},p=C=>{C.key==="Escape"&&(z(!1),L(!1))};return document.addEventListener("pointerdown",l,!0),document.addEventListener("mousedown",l,!0),document.addEventListener("touchstart",l,!0),document.addEventListener("click",l,!0),document.addEventListener("keydown",p,!0),()=>{document.removeEventListener("pointerdown",l,!0),document.removeEventListener("mousedown",l,!0),document.removeEventListener("touchstart",l,!0),document.removeEventListener("click",l,!0),document.removeEventListener("keydown",p,!0)}},[z,L]),{searchTerm:g,setSearchTerm:d,sortFields:y,handleSort:i,filteredAndSortedData:M,loading:S,selectedTiers:F,selectedTypes:f,showTierDropdown:E,setShowTierDropdown:z,showTypeDropdown:A,setShowTypeDropdown:L,tierFilterRef:j,typeFilterRef:P,uniqueTiers:U,uniqueTypes:J,handleTierSelect:s,handleTypeSelect:o,isTierFiltered:n,isTypeFiltered:r,getDropdownStyle:l=>{if(!l.current)return{};const p=l.current.getBoundingClientRect();return{position:"fixed",top:p.bottom+4,left:p.left-100,zIndex:99999}}}},ut=({searchTerm:t,onSearchChange:a,type:c,partyControls:b})=>e.jsxs("div",{style:W.browserHeader,children:[e.jsx("input",{type:"text",placeholder:"Search",value:t,onChange:g=>a(g.target.value),style:W.searchInput}),b&&e.jsx("div",{style:W.partyControls,children:b})]}),ht=({sortFields:t,onSort:a,type:c,uniqueTiers:b,uniqueTypes:g,selectedTiers:d,selectedTypes:y,showTierDropdown:u,setShowTierDropdown:v,showTypeDropdown:k,setShowTypeDropdown:S,tierFilterRef:T,typeFilterRef:F,handleTierSelect:h,handleTypeSelect:f,isTierFiltered:N,isTypeFiltered:E,getDropdownStyle:z,costFilter:A,showCostDropdown:L,setShowCostDropdown:j,costFilterRef:P,handleCostFilterSelect:D,isCostFiltered:U})=>{const[J,M]=w.useState(null),s=(()=>c==="adversary"?[{key:"name",label:"Name"},{key:"tier",label:"Tier",hasFilter:!0},{key:"type",label:"Type",hasFilter:!0},{key:"cost",label:"Cost",hasFilter:!0},{key:"difficulty",label:"Diff"},{key:"action",label:""}]:c==="environment"?[{key:"name",label:"Name"},{key:"tier",label:"Tier",hasFilter:!0},{key:"type",label:"Type",hasFilter:!0},{key:"difficulty",label:"Diff"},{key:"action",label:""}]:[])(),o=()=>{if(!L)return null;const r=[{value:"all",label:"All"},{value:"auto-grey",label:"Auto Grey"},{value:"auto-hide",label:"Auto Hide"}];return ue.createPortal(e.jsx("div",{className:"filter-dropdown",style:{...W.filterDropdown,...z(P),maxHeight:"60vh",overflow:"auto"},onMouseDown:x=>x.stopPropagation(),onClick:x=>x.stopPropagation(),children:r.map(x=>{const l=A===x.value;return e.jsxs("div",{style:{...W.filterOption,...l?W.filterOptionSelected:{}},onClick:()=>D(x.value),children:[e.jsx("span",{style:W.checkIcon,children:l?e.jsx(ne,{size:16}):e.jsx(se,{size:16})}),e.jsx("span",{style:W.filterLabel,children:x.label})]},x.value)})}),document.body)},n=(r,x,l,p,C,I,q,V)=>{if(!C)return null;const B=()=>{(r==="tier"||r==="type")&&p("clear")};return ue.createPortal(e.jsxs("div",{className:"filter-dropdown",style:{...W.filterDropdown,...z(q),maxHeight:"60vh",overflow:"auto"},onMouseDown:R=>R.stopPropagation(),onClick:R=>R.stopPropagation(),children:[e.jsxs("div",{style:{...W.filterOption,...l.length===0?W.filterOptionSelected:{}},onClick:B,children:[e.jsx("span",{style:W.checkIcon,children:l.length===0?e.jsx(ne,{size:16}):e.jsx(se,{size:16})}),e.jsx("span",{style:W.filterLabel,children:"All"})]}),r==="tier"&&e.jsxs("div",{style:{...W.filterOption,...l.includes("party-tier")?W.filterOptionSelected:{}},onClick:()=>p("party-tier"),children:[e.jsx("span",{style:W.checkIcon,children:l.includes("party-tier")?e.jsx(ne,{size:16}):e.jsx(se,{size:16})}),e.jsx("span",{style:W.filterLabel,children:"Party Tier"})]}),x.map(R=>{const G=l.includes(R.toString());return e.jsxs("div",{style:{...W.filterOption,...G?W.filterOptionSelected:{}},onClick:()=>p(R.toString()),children:[e.jsx("span",{style:W.checkIcon,children:G?e.jsx(ne,{size:16}):e.jsx(se,{size:16})}),e.jsx("span",{style:W.filterLabel,children:R})]},R)})]}),document.body)};return e.jsx("tr",{style:W.tableHeader,children:s.map(r=>e.jsxs("th",{style:{...W.tableHeaderCell,...J===r.key?W.tableHeaderCellHover:{},position:"relative",...r.key==="name"?{width:"auto",minWidth:"0"}:{},...r.key==="tier"?{width:"40px",minWidth:"40px",maxWidth:"40px"}:{},...r.key==="type"?{width:"80px",minWidth:"80px",maxWidth:"80px"}:{},...r.key==="difficulty"?{width:"40px",minWidth:"40px",maxWidth:"40px"}:{},...r.key==="cost"?{width:"50px",minWidth:"50px",maxWidth:"50px"}:{},...r.key==="action"?{width:"40px",minWidth:"40px",maxWidth:"40px"}:{}},onClick:()=>a(r.key),onMouseEnter:()=>M(r.key),onMouseLeave:()=>M(null),children:[r.hasFilter?e.jsxs("div",{style:W.headerWithFilter,children:[e.jsx("span",{style:{cursor:"pointer"},onClick:x=>{x.stopPropagation(),a(r.key)},children:r.label}),e.jsxs("button",{ref:r.key==="tier"?T:r.key==="type"?F:P,style:{...W.headerFilterIcon,...r.key==="tier"&&N?W.headerFilterIconActive:{},...r.key==="type"&&E?W.headerFilterIconActive:{},...r.key==="cost"&&U?W.headerFilterIconActive:{}},className:"header-filter-icon",onClick:x=>{x.stopPropagation(),r.key==="tier"?(v(!u),S(!1),j(!1)):r.key==="type"?(S(!k),v(!1),j(!1)):r.key==="cost"&&(j(!L),v(!1),S(!1))},children:[e.jsx(_e,{size:14}),r.key==="tier"&&N||r.key==="type"&&E||r.key==="cost"&&U?e.jsx("span",{style:W.filterActiveDot}):null]})]}):r.label,r.key==="tier"&&n("tier",b,d,h,u,v,T),r.key==="type"&&n("type",g,y,f,k,S,F),r.key==="cost"&&o()]},r.key))})},mt=({item:t,onAdd:a,type:c,onRowClick:b,encounterItems:g=[],pcCount:d=4,playerTier:y=1,remainingBudget:u=0,costFilter:v="auto-grey",onAdversaryClick:k})=>{const[S,T]=w.useState(!1),F=()=>{a(t)},h=()=>{if(c!=="adversary")return null;const E=ae[t.type]||2;let z=0;const A=g.filter(j=>j.type==="adversary"&&j.item.type==="Solo"&&j.quantity>0).reduce((j,P)=>j+P.quantity,0),L=g.filter(j=>j.type==="adversary"&&["Bruiser","Horde","Leader","Solo"].includes(j.item.type)&&j.quantity>0).reduce((j,P)=>j+P.quantity,0);return t.type==="Solo"&&A===1&&(z+=2),["Bruiser","Horde","Leader","Solo"].includes(t.type)&&L===0&&(z+=1),E+z},N=(()=>{if(c==="adversary"){const E=h();ae[t.type];const z=E>u||u<=0;if(v==="auto-hide"&&z)return null;const A=v==="auto-grey"&&z?{opacity:.5,color:"var(--text-secondary)"}:{};return e.jsxs(e.Fragment,{children:[e.jsx("td",{style:{...W.rowCell,width:"auto",minWidth:"0",textAlign:"left",...A},children:e.jsxs("div",{style:{overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap",maxWidth:"100%"},children:[e.jsx("div",{style:{fontWeight:"600"},children:t.name}),t.description&&e.jsx("div",{style:{fontSize:"0.85rem",color:"var(--text-secondary)",marginTop:"0.125rem",overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap"},children:t.description})]})}),e.jsx("td",{style:{...W.rowCell,width:"40px",minWidth:"40px",maxWidth:"40px",textAlign:"center",...A},children:t.tier}),e.jsx("td",{style:{...W.rowCell,width:"80px",minWidth:"80px",maxWidth:"80px",textAlign:"center",...A},children:t.type}),e.jsx("td",{style:{...W.rowCell,width:"50px",minWidth:"50px",maxWidth:"50px",textAlign:"center",...A},children:E}),e.jsx("td",{style:{...W.rowCell,width:"40px",minWidth:"40px",maxWidth:"40px",textAlign:"center",...A},children:t.difficulty})]})}else if(c==="environment")return e.jsxs(e.Fragment,{children:[e.jsx("td",{style:{...W.rowCell,width:"auto",minWidth:"0",textAlign:"left"},children:t.name}),e.jsx("td",{style:{...W.rowCell,width:"80px",minWidth:"80px",maxWidth:"80px",textAlign:"center"},children:t.tier}),e.jsx("td",{style:{...W.rowCell,width:"100px",minWidth:"100px",maxWidth:"100px",textAlign:"center"},children:t.type}),e.jsx("td",{style:{...W.rowCell,width:"40px",minWidth:"40px",maxWidth:"40px",textAlign:"center"},children:t.difficulty})]});return null})();return N===null?null:e.jsx(e.Fragment,{children:e.jsxs("tr",{style:{...W.row,...S?W.rowHover:{}},onClick:()=>{c==="adversary"&&k?k(t):b&&b(t,c)},onMouseEnter:()=>T(!0),onMouseLeave:()=>T(!1),children:[N,e.jsx("td",{style:{width:"40px",minWidth:"40px",maxWidth:"40px",textAlign:"center",padding:"0",margin:"0",border:"none",verticalAlign:"middle",boxSizing:"border-box",overflow:"visible",textOverflow:"unset",whiteSpace:"nowrap"},children:e.jsx("button",{style:W.addButton,onClick:E=>{E.stopPropagation(),F()},onMouseEnter:E=>{E.target.style.background="var(--bg-secondary)"},onMouseLeave:E=>{E.target.style.background="var(--purple)"},children:"+"})})]})})},gt=({type:t,onAddItem:a,onCancel:c,onRowClick:b,encounterItems:g=[],pcCount:d=4,playerTier:y=1,partyControls:u=null,showContainer:v=!0})=>{const[k,S]=w.useState("all"),[T,F]=w.useState(!1),[h,f]=w.useState(null),N=w.useRef(null),{searchTerm:E,setSearchTerm:z,sortFields:A,handleSort:L,filteredAndSortedData:j,loading:P,selectedTiers:D,selectedTypes:U,showTierDropdown:J,setShowTierDropdown:M,showTypeDropdown:i,setShowTypeDropdown:s,tierFilterRef:o,typeFilterRef:n,uniqueTiers:r,uniqueTypes:x,handleTierSelect:l,handleTypeSelect:p,isTierFiltered:C,isTypeFiltered:I,getDropdownStyle:q}=xt(t,g,d,y),B=(()=>{const m=3*d+2,O=g.reduce((_,te)=>{if(te.type==="adversary"){const me=ae[te.item.type]||2;if(te.item.type==="Minion"){const Be=Math.ceil(te.quantity/d);return _+Be*me}else return _+te.quantity*me}return _},0);let H=0;g.filter(_=>_.type==="adversary"&&_.item.type==="Solo"&&_.quantity>0).reduce((_,te)=>_+te.quantity,0)>=2&&(H+=we.twoOrMoreSolos);const Q=g.some(_=>_.type==="adversary"&&_.item.type==="Bruiser"&&_.quantity>0),$=g.some(_=>_.type==="adversary"&&_.item.type==="Horde"&&_.quantity>0),K=g.some(_=>_.type==="adversary"&&_.item.type==="Leader"&&_.quantity>0),ee=g.some(_=>_.type==="adversary"&&_.item.type==="Solo"&&_.quantity>0);return!Q&&!$&&!K&&!ee&&(H+=we.noBruisersHordesLeadersSolos),m+H-O})(),R=m=>{S(m),F(!1)},G=k!=="all";return P?e.jsx("div",{style:W.browser,children:e.jsx("div",{style:W.loading,children:"Loading..."})}):e.jsxs(e.Fragment,{children:[e.jsxs("div",{style:v?W.browserWrapper:W.browserWrapperNoContainer,children:[e.jsx(ut,{searchTerm:E,onSearchChange:z,type:t,partyControls:u}),e.jsx("div",{className:"browser-content",style:W.browserContent,children:e.jsxs("table",{style:W.browserTable,children:[e.jsx("thead",{style:{position:"sticky",top:0,zIndex:10,backgroundColor:"var(--bg-primary)"},children:e.jsx(ht,{sortFields:A,onSort:L,type:t,uniqueTiers:r,uniqueTypes:x,selectedTiers:D,selectedTypes:U,showTierDropdown:J,setShowTierDropdown:M,showTypeDropdown:i,setShowTypeDropdown:s,tierFilterRef:o,typeFilterRef:n,handleTierSelect:l,handleTypeSelect:p,isTierFiltered:C,isTypeFiltered:I,getDropdownStyle:q,costFilter:k,showCostDropdown:T,setShowCostDropdown:F,costFilterRef:N,handleCostFilterSelect:R,isCostFiltered:G})}),e.jsx("tbody",{children:j.map(m=>e.jsx(mt,{item:m,onAdd:a,type:t,onRowClick:b,encounterItems:g,pcCount:d,playerTier:y,remainingBudget:B,costFilter:k,onAdversaryClick:O=>{t==="adversary"&&f(O)}},m.id))})]})})]}),h&&e.jsx("div",{style:{position:"fixed",top:0,left:0,right:0,bottom:0,backgroundColor:"rgba(0, 0, 0, 0.5)",backdropFilter:"blur(8px)",zIndex:2e3,display:"flex",alignItems:"center",justifyContent:"center",padding:"2rem"},onClick:()=>f(null),children:e.jsx("div",{style:{maxWidth:"600px",width:"90vw",maxHeight:"80vh",overflowY:"auto"},onClick:m=>m.stopPropagation(),children:e.jsx(We,{item:h,type:"adversary",mode:"expanded",onClose:()=>f(null)})})})]})},W={browserWrapper:{display:"flex",flexDirection:"column",background:"var(--bg-primary)",borderRadius:"var(--radius-md)",border:"1px solid var(--border)",overflow:"hidden",height:"100%",width:"100%",position:"relative"},browserWrapperNoContainer:{display:"flex",flexDirection:"column",overflow:"hidden",height:"100%",width:"100%",position:"relative"},browserContent:{flex:1,overflowY:"auto",overflowX:"visible",padding:0,width:"100%"},tableHeaderContainer:{flexShrink:0,position:"sticky",top:0,zIndex:15,backgroundColor:"var(--bg-secondary)"},browserTable:{width:"100%",minWidth:"100%",borderCollapse:"collapse",tableLayout:"fixed",background:"var(--bg-primary)",margin:0},browserHeader:{display:"flex",justifyContent:"space-between",alignItems:"center",padding:"16px",borderBottom:"1px solid var(--border)",backgroundColor:"var(--gray-900)",flexShrink:0,position:"sticky",top:0,zIndex:20},browserTitle:{margin:0,color:"var(--text-primary)",fontSize:"18px",fontWeight:"600"},closeButton:{background:"none",border:"none",color:"var(--text-primary)",fontSize:"24px",cursor:"pointer",padding:"4px 8px",borderRadius:"4px",transition:"background-color 0.2s"},searchInput:{flex:1,padding:"8px 12px",border:"1px solid var(--border)",borderRadius:"4px",backgroundColor:"var(--bg-primary)",color:"var(--text-primary)",fontSize:"14px",marginRight:"12px",transition:"all 0.2s ease"},partyControls:{display:"flex",alignItems:"center",gap:"12px",flexShrink:0},searchInputFocus:{outline:"none",borderColor:"var(--purple)",boxShadow:"0 0 0 3px rgba(139, 92, 246, 0.1)"},tableHeader:{background:"var(--gray-900)",borderBottom:"1px solid var(--border)",boxShadow:"0 1px 0 var(--border)",position:"sticky",top:"0",zIndex:10},tableHeaderCell:{backgroundColor:"var(--gray-900)",fontWeight:"700",borderBottom:"1px solid var(--border)",cursor:"pointer",userSelect:"none",minWidth:"100px",whiteSpace:"nowrap",padding:"4px 4px",color:"var(--text-primary)",textShadow:"0 1px 2px rgba(0, 0, 0, 0.3)",boxShadow:"0 1px 0 var(--border)",transition:"background-color 0.2s",position:"sticky",top:"0",zIndex:10},tableHeaderCellHover:{backgroundColor:"var(--bg-hover)"},sortIndicator:{fontSize:"12px",color:"var(--text-secondary)"},tableBody:{flex:1,overflowY:"auto",padding:"8px",backgroundColor:"var(--bg-primary)"},row:{height:"35px",borderBottom:"1px solid var(--border)",transition:"background-color 0.2s ease",cursor:"pointer",backgroundColor:"var(--gray-900)"},rowHover:{backgroundColor:"var(--bg-secondary)"},expandedRow:{backgroundColor:"var(--bg-secondary)"},rowCell:{padding:"4px 4px",verticalAlign:"middle",color:"var(--text-primary)",whiteSpace:"nowrap",overflow:"hidden",textOverflow:"ellipsis",borderBottom:"1px solid var(--border)"},rowCellName:{fontWeight:"500",minWidth:"150px"},rowCellCenter:{textAlign:"center",justifyContent:"center",minWidth:"80px"},rowActions:{width:"80px",textAlign:"center",padding:"4px 8px",borderBottom:"1px solid var(--border)"},addButton:{width:"2rem",height:"2rem",border:"1px solid var(--purple)",borderRadius:"var(--radius-sm)",background:"var(--purple)",color:"white",cursor:"pointer",transition:"all 0.2s ease",display:"inline-flex",alignItems:"center",justifyContent:"center",fontSize:"16px",fontWeight:"500"},expandedContent:{padding:"0",backgroundColor:"var(--bg-secondary)",borderBottom:"1px solid var(--border)"},columnName:{width:"auto",minWidth:"0",overflow:"hidden",textOverflow:"ellipsis",paddingLeft:"8px",textAlign:"left"},columnTier:{width:"80px",textAlign:"center",overflow:"visible",textOverflow:"unset"},columnType:{width:"100px",overflow:"hidden",textOverflow:"ellipsis",textAlign:"center"},columnDifficulty:{width:"40px",textAlign:"center",overflow:"visible",textOverflow:"unset"},columnAction:{width:"32px",minWidth:"24px",maxWidth:"24px",textAlign:"center",padding:"0",margin:"0",border:"none",verticalAlign:"middle",color:"var(--text-primary)",whiteSpace:"nowrap",overflow:"visible",textOverflow:"unset"},loading:{display:"flex",justifyContent:"center",alignItems:"center",height:"200px",color:"var(--text-primary)",fontSize:"16px"},mobileBrowser:{width:"95vw",height:"90vh",maxWidth:"none"},mobileSearchInput:{fontSize:"16px"},headerWithFilter:{display:"flex",alignItems:"center",justifyContent:"center",gap:"0px",position:"relative"},headerFilterIcon:{background:"none",border:"none",color:"var(--text-secondary)",cursor:"pointer",padding:"2px 4px",borderRadius:"var(--radius-sm)",display:"flex",alignItems:"center",justifyContent:"center",transition:"all 0.2s ease",position:"relative",marginLeft:"-2px"},headerFilterIconActive:{color:"var(--purple)"},filterIcon:{fontSize:"12px"},filterActiveDot:{position:"absolute",left:"50%",top:"2px",transform:"translateX(-50%)",width:"4px",height:"4px",borderRadius:"50%",background:"var(--purple)",pointerEvents:"none"},filterDropdown:{position:"fixed",background:"var(--bg-secondary)",border:"1px solid var(--border)",borderRadius:"var(--radius-md)",boxShadow:"0 8px 24px rgba(0, 0, 0, 0.25)",zIndex:99999,marginTop:"4px",overflow:"hidden",width:"max-content",minWidth:"120px",maxWidth:"200px"},filterOption:{padding:"8px 12px",cursor:"pointer",color:"var(--text-primary)",fontSize:"14px",display:"flex",alignItems:"center",gap:"8px",borderBottom:"1px solid rgba(255,255,255,0.06)",transition:"background-color 0.2s ease",whiteSpace:"nowrap",overflow:"hidden",textOverflow:"ellipsis"},filterOptionSelected:{backgroundColor:"var(--bg-hover)"},checkIcon:{width:"16px",height:"16px",display:"inline-flex",alignItems:"center",justifyContent:"center",color:"var(--text-secondary)",fontSize:"12px"},filterLabel:{flex:1}},yt=()=>e.jsx("div",{className:"pwa-install-prompt",style:{}}),ft=({side:t="left",children:a,className:c="",style:b={}})=>{const g=t==="left",d={flex:1,minWidth:0,background:"var(--bg-primary)",overflowY:"auto",overflowX:g?"auto":"hidden",display:g?"block":"flex",flexDirection:g?"initial":"column",height:"100%",padding:g?"8px 0 8px 0":"0 8px 0 0",...b};return e.jsx("div",{className:c,style:d,children:a})},vt=t=>3*t+2,Ce={Minion:1,Social:1,Support:1,Horde:2,Ranged:2,Skulk:2,Standard:2,Leader:3,Bruiser:4,Solo:5},xe={lessDifficult:-1,twoOrMoreSolos:-2,increasedDamage:-2,lowerTierAdversary:1,noBruisersHordesLeadersSolos:1,moreDangerous:2},bt=({isOpen:t,onClose:a,onAddAdversary:c,onAddAdversariesBulk:b,onAddEnvironment:g,adversaries:d=[],environments:y=[]})=>{const[u,v]=w.useState(4),[k,S]=w.useState(1),[T,F]=w.useState({lessDifficult:!1,increasedDamage:!1,moreDangerous:!1}),[h,f]=w.useState([]),N=re.useRef(u);re.useEffect(()=>{if(t&&d.length>0){const i={};d.forEach(o=>{var r;const n=o.baseName||((r=o.name)==null?void 0:r.replace(/\s+\(\d+\)$/,""))||o.name;i[n]||(i[n]={type:"adversary",item:o,quantity:0}),i[n].quantity+=1});const s=Object.values(i);f(s)}else t&&d.length===0&&f([])},[t,d]);const E=re.useMemo(()=>{let i=0;h.filter(l=>l.type==="adversary"&&l.item.type==="Solo"&&l.quantity>0).reduce((l,p)=>l+p.quantity,0)>=2&&(i+=xe.twoOrMoreSolos);const o=h.some(l=>l.type==="adversary"&&l.item.type==="Bruiser"&&l.quantity>0),n=h.some(l=>l.type==="adversary"&&l.item.type==="Horde"&&l.quantity>0),r=h.some(l=>l.type==="adversary"&&l.item.type==="Leader"&&l.quantity>0),x=h.some(l=>l.type==="adversary"&&l.item.type==="Solo"&&l.quantity>0);return!o&&!n&&!r&&!x&&(i+=xe.noBruisersHordesLeadersSolos),i},[h,k]),z=vt(u),A=Object.entries(T).filter(([i,s])=>s).reduce((i,[s,o])=>i+xe[s],0),L=z+A+E,j=h.reduce((i,s)=>{if(s.type==="adversary"){const o=Ce[s.item.type]||2;return s.item.type==="Minion"?i+Math.ceil(s.quantity/u)*o:i+o*s.quantity}return i},0),P=L-j,D=e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"1rem"},children:[e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"0.5rem"},children:[e.jsx("span",{style:{color:"var(--text-secondary)",fontSize:"0.9rem"},children:"Tier:"}),e.jsx("button",{onClick:()=>S(Math.max(1,k-1)),style:{background:"var(--bg-secondary)",border:"1px solid var(--border)",color:"var(--text-primary)",borderRadius:"3px",padding:"0",cursor:"pointer",display:"flex",alignItems:"center",justifyContent:"center",minWidth:"18px",height:"18px",fontSize:"0.7rem"},children:e.jsx(ce,{size:10})}),e.jsx("span",{style:{color:"var(--text-primary)",fontSize:"0.9rem",minWidth:"20px",textAlign:"center"},children:k}),e.jsx("button",{onClick:()=>S(Math.min(4,k+1)),style:{background:"var(--bg-secondary)",border:"1px solid var(--border)",color:"var(--text-primary)",borderRadius:"3px",padding:"0",cursor:"pointer",display:"flex",alignItems:"center",justifyContent:"center",minWidth:"18px",height:"18px",fontSize:"0.7rem"},children:e.jsx(pe,{size:10})})]}),e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"0.5rem"},children:[e.jsx("span",{style:{color:"var(--text-secondary)",fontSize:"0.9rem"},children:"Size:"}),e.jsx("button",{onClick:()=>v(Math.max(1,u-1)),style:{background:"var(--bg-secondary)",border:"1px solid var(--border)",color:"var(--text-primary)",borderRadius:"3px",padding:"0",cursor:"pointer",display:"flex",alignItems:"center",justifyContent:"center",minWidth:"18px",height:"18px",fontSize:"0.7rem"},children:e.jsx(ce,{size:10})}),e.jsx("span",{style:{color:"var(--text-primary)",fontSize:"0.9rem",minWidth:"20px",textAlign:"center"},children:u}),e.jsx("button",{onClick:()=>v(u+1),style:{background:"var(--bg-secondary)",border:"1px solid var(--border)",color:"var(--text-primary)",borderRadius:"3px",padding:"0",cursor:"pointer",display:"flex",alignItems:"center",justifyContent:"center",minWidth:"18px",height:"18px",fontSize:"0.7rem"},children:e.jsx(pe,{size:10})})]})]});re.useEffect(()=>{const i=N.current;i!==u&&(f(s=>s.map(o=>{if(o.type==="adversary"&&o.item.type==="Minion"){const r=Math.ceil(o.quantity/i)*u;return{...o,quantity:r}}return o})),N.current=u)},[u]);const U=(i,s)=>{const o=h.findIndex(r=>r.item.id===i.id&&r.type===s),n=i.type==="Minion"?u:1;o>=0?f(r=>r.map((x,l)=>l===o?{...x,quantity:x.quantity+n}:x)):f(r=>[...r,{item:i,type:s,quantity:n}])},J=(i,s)=>{f(o=>{const n=o.findIndex(r=>r.item.id===i&&r.type===s);if(n>=0){const r=o[n],x=r.item.type==="Minion"?u:1;return r.quantity>0?o.map((l,p)=>p===n?{...l,quantity:Math.max(0,l.quantity-x)}:l):o.filter((l,p)=>p!==n)}return o})},M=()=>{const i=[];h.forEach(s=>{for(let o=0;o<s.quantity;o++)s.type==="adversary"&&i.push(s.item)}),i.length>0&&b(i),f([]),a()};return t?e.jsx("div",{onClick:a,style:{position:"fixed",top:0,left:0,right:0,bottom:0,backgroundColor:"rgba(0, 0, 0, 0.5)",backdropFilter:"blur(8px)",zIndex:1e3,display:"flex",alignItems:"center",justifyContent:"center",padding:"2rem"},children:e.jsxs("div",{onClick:i=>i.stopPropagation(),style:{backgroundColor:"var(--bg-primary)",border:"2px solid var(--border)",borderRadius:"12px",width:"100%",maxWidth:"1200px",height:"90vh",maxHeight:"800px",display:"flex",flexDirection:"column",overflow:"hidden",boxShadow:"0 20px 40px rgba(0, 0, 0, 0.3)"},children:[e.jsx("button",{onClick:a,style:{position:"absolute",top:"1rem",right:"1rem",background:"var(--bg-secondary)",border:"1px solid var(--border)",color:"var(--text-primary)",fontSize:"1.5rem",cursor:"pointer",padding:"0.5rem",borderRadius:"var(--radius-sm)",transition:"background-color 0.2s",zIndex:10},onMouseEnter:i=>i.target.style.backgroundColor="var(--bg-hover)",onMouseLeave:i=>i.target.style.backgroundColor="var(--bg-secondary)",title:"Close Encounter Builder",children:e.jsx(oe,{size:24})}),e.jsxs("div",{className:"encounter-builder-content",style:{display:"flex",flex:1,overflow:"hidden"},children:[e.jsx("div",{className:"encounter-browser-panel",style:{flex:1,display:"flex",flexDirection:"column",overflow:"hidden"},children:e.jsx(gt,{type:"adversary",onAddItem:i=>U(i,"adversary"),onCancel:a,encounterItems:h,pcCount:u,playerTier:k,partyControls:D,showContainer:!1})}),e.jsx("div",{className:"encounter-receipt-panel",style:{width:"350px",borderLeft:"1px solid var(--border)",display:"flex",flexDirection:"column"},children:e.jsxs("div",{className:"receipt-content",style:{padding:"1rem",overflowY:"auto",height:"100%",display:"flex",flexDirection:"column"},children:[e.jsx("div",{style:{flex:1,overflowY:"auto",marginBottom:"0.75rem"},children:h.map(i=>{var n;if(i.type!=="adversary")return null;const s=Ce[i.item.type]||2,o=i.item.type==="Minion"?Math.ceil(i.quantity/u)*s:s*i.quantity;return e.jsxs("div",{className:"receipt-item",style:{display:"flex",alignItems:"center",padding:"0.25rem 0",borderBottom:"1px solid var(--border)"},children:[e.jsx("div",{style:{flex:1},children:e.jsx("span",{style:{color:"var(--text-secondary)",fontSize:"0.9rem"},children:i.item.baseName||((n=i.item.name)==null?void 0:n.replace(/\s+\(\d+\)$/,""))||i.item.name})}),e.jsxs("div",{className:"receipt-controls",style:{width:"60px",textAlign:"center",position:"relative"},children:[e.jsx("button",{onClick:()=>J(i.item.id,i.type),style:{background:i.quantity===0?"var(--danger)":"var(--bg-secondary)",border:i.quantity===0?"none":"1px solid var(--border)",color:i.quantity===0?"white":"var(--text-primary)",borderRadius:"3px",padding:"0",cursor:"pointer",display:"flex",alignItems:"center",justifyContent:"center",minWidth:"18px",height:"18px",fontSize:"0.7rem",position:"absolute",left:"0",top:"50%",transform:"translateY(-50%)"},children:i.quantity===0?e.jsx(oe,{size:10}):e.jsx(ce,{size:10})}),e.jsx("span",{style:{color:"var(--text-secondary)",fontSize:"0.9rem"},children:i.quantity}),e.jsx("button",{onClick:()=>U(i.item,i.type),style:{background:"var(--bg-secondary)",border:"1px solid var(--border)",color:"var(--text-primary)",borderRadius:"3px",padding:"0",cursor:"pointer",display:"flex",alignItems:"center",justifyContent:"center",minWidth:"18px",height:"18px",fontSize:"0.7rem",position:"absolute",right:"0",top:"50%",transform:"translateY(-50%)"},children:e.jsx(pe,{size:10})})]}),e.jsx("div",{className:"receipt-value",style:{width:"35px",textAlign:"right"},children:e.jsxs("span",{style:{color:"var(--text-primary)",fontWeight:600},children:["-",o]})})]},`${i.item.id}-${i.type}`)})}),E!==0&&(()=>{const i=[];return h.filter(s=>s.type==="adversary"&&s.item.type==="Solo"&&s.quantity>0).reduce((s,o)=>s+o.quantity,0)>=2&&i.push("2+ Solo"),h.some(s=>s.type==="adversary"&&["Bruiser","Horde","Leader","Solo"].includes(s.item.type)&&s.quantity>0)||i.push("no major threats"),e.jsxs("div",{className:"receipt-item",style:{display:"flex",alignItems:"center",padding:"0.25rem 0",borderBottom:"1px solid var(--border)",flexShrink:0},children:[e.jsx("div",{style:{flex:1},children:e.jsx("span",{style:{color:"var(--text-secondary)",fontSize:"0.9rem"},children:i.join(", ")})}),e.jsx("div",{className:"receipt-controls",style:{width:"60px",textAlign:"center"}}),e.jsx("div",{className:"receipt-value",style:{width:"35px",textAlign:"right"},children:e.jsx("span",{style:{color:"var(--text-primary)",fontWeight:600},children:E})})]})})(),e.jsxs("div",{className:"receipt-item",style:{display:"flex",alignItems:"center",padding:"0.125rem 0",marginTop:"0.5rem",flexShrink:0},children:[e.jsx("div",{style:{flex:1,display:"flex",alignItems:"center"},children:e.jsxs("span",{style:{color:"var(--text-primary)",fontSize:"0.9rem"},children:[j," / ",L]})}),e.jsx("div",{className:"receipt-controls",style:{width:"60px",textAlign:"center"}}),e.jsx("div",{className:"receipt-value",style:{width:"35px",textAlign:"right",display:"flex",alignItems:"center",justifyContent:"flex-end"},children:e.jsx("span",{style:{color:P<0?"var(--danger)":"var(--text-primary)",fontWeight:600},children:P})})]}),e.jsxs("div",{style:{display:"flex",justifyContent:"flex-end",gap:"0.5rem",padding:"0.75rem 0 0 0",borderTop:"1px solid var(--border)",marginTop:"0.5rem",flexShrink:0},children:[e.jsx("button",{onClick:a,style:{background:"var(--bg-primary)",border:"1px solid var(--border)",color:"var(--text-primary)",padding:"0.5rem 1rem",borderRadius:"6px",cursor:"pointer",transition:"all 0.2s"},onMouseEnter:i=>i.target.style.backgroundColor="var(--bg-hover)",onMouseLeave:i=>i.target.style.backgroundColor="var(--bg-primary)",children:"Cancel"}),e.jsx("button",{onClick:M,disabled:h.length===0,style:{background:h.length===0?"var(--gray-600)":"var(--purple)",border:"none",color:"white",padding:"0.5rem 1rem",borderRadius:"6px",cursor:h.length===0?"not-allowed":"pointer",transition:"all 0.2s",opacity:h.length===0?.6:1},onMouseEnter:i=>{h.length>0&&(i.target.style.backgroundColor="var(--purple-dark)")},onMouseLeave:i=>{h.length>0&&(i.target.style.backgroundColor="var(--purple)")},children:"Create Encounter"})]})]})})]})]})}):null};class jt extends re.Component{constructor(a){super(a),this.state={hasError:!1,error:null}}static getDerivedStateFromError(a){return{hasError:!0,error:a}}componentDidCatch(a,c){console.error("ErrorBoundary caught an error:",a,c)}render(){var a;return this.state.hasError?e.jsxs("div",{className:"p-md text-red",children:[e.jsx("h3",{children:"Something went wrong:"}),e.jsx("pre",{children:(a=this.state.error)==null?void 0:a.toString()}),e.jsx("button",{className:"btn-base btn-text",onClick:()=>this.setState({hasError:!1,error:null}),children:"Try again"})]}):this.props.children}}const wt=()=>{const{adversaries:t,environments:a,countdowns:c,fear:b,updateFear:g,createAdversary:d,createAdversariesBulk:y,updateAdversary:u,deleteAdversary:v,createEnvironment:k,updateEnvironment:S,deleteEnvironment:T,createCountdown:F,updateCountdown:h,deleteCountdown:f,advanceCountdown:N}=tt(),[E,z]=w.useState(!1),[A,L]=w.useState(!1);w.useState(!1);const[j,P]=w.useState(!1);w.useState(!0);const[D,U]=w.useState(null),[J,M]=w.useState(0),[i,s]=w.useState(0),[o,n]=w.useState(!1);w.useEffect(()=>{const m=()=>{const H=window.matchMedia("(max-width: 800px)");z(H.matches)};m();const O=window.matchMedia("(max-width: 800px)");return O.addEventListener("change",m),()=>O.removeEventListener("change",m)},[]);const r=12,x=250,l=500,p=m=>{if(m<=0)return{visibleColumns:1,columnWidth:x};const O=r*2,H=m-O;let X={visibleColumns:1,columnWidth:Math.min(H,l)};for(let $=1;$<=5;$++){const K=($-1)*r,ee=(H-K)/$;ee>=x&&ee<=l&&$*ee+K<=H&&$>X.visibleColumns&&(X={visibleColumns:$,columnWidth:ee})}return X.visibleColumns*X.columnWidth+(X.visibleColumns-1)*r>H&&(X={visibleColumns:1,columnWidth:Math.min(H,l)}),X},{visibleColumns:C,columnWidth:I}=p(J);w.useEffect(()=>{const m=()=>{M(window.innerWidth)};return m(),window.addEventListener("resize",m),()=>window.removeEventListener("resize",m)},[]);const q=()=>{L(!0)},V=w.useCallback(()=>{L(!1)},[]),B=w.useCallback(m=>{s(m.target.scrollLeft)},[]);w.useCallback(()=>{n(!0)},[]),w.useCallback(()=>{setTimeout(()=>n(!1),100)},[]);const G=(()=>{const m={};return t.forEach(O=>{var X;const H=O.baseName||((X=O.name)==null?void 0:X.replace(/\s+\(\d+\)$/,""))||O.name;m[H]||(m[H]={type:"adversary",baseName:H,instances:[]}),m[H].instances.push(O)}),a.forEach(O=>{m[O.name]||(m[O.name]={type:"environment",baseName:O.name,instances:[]}),m[O.name].instances.push(O)}),c.forEach(O=>{m[`countdown-${O.id}`]={type:"countdown",baseName:O.name,instances:[O]}}),Object.values(m)})();return G.length,e.jsxs("div",{className:"app",onClick:m=>{m.target,m.currentTarget},children:[e.jsx(ot,{adversaries:t,environments:a,countdowns:c,deleteAdversary:v,deleteEnvironment:T,deleteCountdown:f,isClearMode:j,setIsClearMode:P,sortAdversaries:()=>{},onOpenDatabase:q}),e.jsx("div",{className:"main-content",style:{position:"relative",width:"100%"},children:e.jsx("div",{className:"dashboard-scroll-container",style:{display:"flex",flexDirection:"row",overflowX:"auto",overflowY:"hidden",padding:`0 ${r}px`,scrollSnapType:"x mandatory",height:"100%",width:"100%"},onScroll:B,children:G.length===0?e.jsx("div",{style:{display:"flex",alignItems:"center",justifyContent:"center",height:"100%",width:"100%",padding:"2rem"},children:e.jsx("button",{onClick:q,style:{backgroundColor:"transparent",color:"var(--text-secondary)",border:"2px dashed var(--border)",borderRadius:"var(--radius-md)",padding:"1rem 2rem",fontSize:"1rem",fontWeight:"500",cursor:"pointer",transition:"all 0.2s ease"},onMouseEnter:m=>{m.target.style.borderColor="var(--purple)",m.target.style.color="var(--purple)"},onMouseLeave:m=>{m.target.style.borderColor="var(--border)",m.target.style.color="var(--text-secondary)"},children:"Create Encounter"})}):G.map((m,O)=>e.jsx(ft,{className:"invisible-scrollbar",style:{width:`${I+r}px`,flexShrink:0,flexGrow:0,flex:"none",paddingLeft:`${r}px`,paddingRight:"0",paddingTop:`${r}px`,paddingBottom:`${r}px`,scrollSnapAlign:"start",overflowY:"auto",overflowX:"hidden"},children:e.jsx(We,{type:m.type,item:{...m.instances[0],name:m.baseName,hp:0,stress:0,isDead:!1},mode:"expanded",instances:m.instances,onApplyDamage:m.type==="adversary"?(H,X,Q,$)=>{const K=m.instances.find(ee=>ee.id===H);K&&u(H,{hp:Math.min(K.hpMax||1,(K.hp||0)+X)})}:void 0,onApplyHealing:m.type==="adversary"?(H,X,Q)=>{const $=m.instances.find(K=>K.id===H);$&&u(H,{hp:Math.max(0,($.hp||0)-X)})}:void 0,onApplyStressChange:m.type==="adversary"?(H,X)=>{var Q,$;return u(H,{stress:Math.max(0,Math.min(((Q=m.instances.find(K=>K.id===H))==null?void 0:Q.stressMax)||6,((($=m.instances.find(K=>K.id===H))==null?void 0:$.stress)||0)+X))})}:void 0,onUpdate:m.type==="adversary"?u:m.type==="environment"?S:h,adversaries:t})},`${m.type}-${m.baseName}`))})}),e.jsx(at,{position:"bottom",children:e.jsx(rt,{type:"fear",value:(b==null?void 0:b.value)||0,maxValue:12,onChange:g,showTooltip:!1,enableBoundaryClick:!0,clickContainerWidth:"100%",centerPips:!0})}),e.jsx(bt,{isOpen:A,onClose:V,onAddAdversary:m=>{d(m),U("adversary")},onAddAdversariesBulk:m=>{y(m),U("adversary")},onAddEnvironment:m=>{k(m),U("environment")},adversaries:t,environments:a}),e.jsx(yt,{})]})},Ct=()=>e.jsx(jt,{children:e.jsx(wt,{})});he.createRoot(document.getElementById("root")).render(e.jsx(re.StrictMode,{children:e.jsx(et,{children:e.jsx(Ct,{})})}));
