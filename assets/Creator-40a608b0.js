import{j as e,A as F,C as S,a as b,E as k}from"./index-cd9c9c7d.js";import{r as C}from"./dndkit-fdc06b07.js";import"./fa-8ab3eb90.js";import"./lucide-abc1b48f.js";const D=({type:c,item:t=null,source:d="campaign",onSave:M,onCancel:h})=>{var y,N;const x=c==="adversary",v=c==="environment",p=c==="countdown",[s,o]=C.useState({name:"",tier:1,type:"",difficulty:1,description:"",motives:"",source:d,hpMax:1,stressMax:0,passiveFeatures:[{name:"",description:""}],actionFeatures:[{name:"",description:""}],reactionFeatures:[{name:"",description:""}],thresholds:{major:0,severe:0},atk:0,weapon:"Weapon",range:"Melee",damage:"1d6 phy",effects:[],hazards:[],max:5,value:0,countdownType:"standard",loop:"none"});C.useEffect(()=>{var a,l,n;t&&o({name:t.name||"",tier:t.tier||1,type:t.type||"",difficulty:t.difficulty||1,description:t.description||"",motives:t.motives||"",source:t.source||d,hpMax:t.hpMax||1,stressMax:t.stressMax||0,passiveFeatures:t.passiveFeatures||((a=t.features)==null?void 0:a.filter(i=>i.type==="Passive"))||[{name:"",description:""}],actionFeatures:t.actionFeatures||((l=t.features)==null?void 0:l.filter(i=>i.type==="Action"))||[{name:"",description:""}],reactionFeatures:t.reactionFeatures||((n=t.features)==null?void 0:n.filter(i=>i.type==="Reaction"))||[{name:"",description:""}],thresholds:t.thresholds||{major:0,severe:0},atk:t.atk||0,weapon:t.weapon||"Weapon",range:t.range||"Melee",damage:t.damage||"1d6 phy",effects:t.effects||[],hazards:t.hazards||[],max:t.max||5,value:t.value||0,countdownType:t.type||"standard",loop:t.loop||"none"})},[t,d]);const r=(a,l)=>{o(n=>({...n,[a]:l}))},j=(a,l,n)=>{o(i=>({...i,[a]:i[a].map((u,w)=>w===l?n:u)}))},g=a=>{o(l=>({...l,[a]:[...l[a],""]}))},f=(a,l)=>{o(n=>({...n,[a]:n[a].filter((i,u)=>u!==l)}))},m=a=>{if(a.preventDefault(),!s.name.trim()){alert("Name is required");return}const l={...s,name:s.name.trim(),description:s.description.trim(),...x&&{hp:0,hpMax:s.hpMax,stress:0,stressMax:s.stressMax,thresholds:s.thresholds,atk:s.atk,weapon:s.weapon,range:s.range,damage:s.damage,features:[...s.passiveFeatures.filter(n=>n.name.trim()).map(n=>({...n,type:"Passive"})),...s.actionFeatures.filter(n=>n.name.trim()).map(n=>({...n,type:"Action"})),...s.reactionFeatures.filter(n=>n.name.trim()).map(n=>({...n,type:"Reaction"}))]},...v&&{effects:s.effects.filter(n=>n.trim()),hazards:s.hazards.filter(n=>n.trim())},...p&&{max:s.max,value:s.value,type:s.countdownType,loop:s.loop}};M(l)};return e.jsx("div",{className:"creator-container",children:e.jsx("form",{onSubmit:m,className:"creator-form",children:x?e.jsxs("div",{className:"expanded-card adversary",children:[e.jsxs("div",{className:"expanded-header",children:[e.jsxs("div",{className:"edit-header-row",children:[e.jsx("input",{type:"text",className:"form-input-inline",value:s.name||"",onChange:a=>r("name",a.target.value),placeholder:"Adversary name"}),e.jsxs("div",{className:"edit-actions",children:[e.jsx("button",{className:"save-button",onClick:m,type:"button",children:"Save"}),e.jsx("button",{className:"cancel-button",onClick:h,type:"button",children:"Cancel"})]})]}),e.jsxs("div",{className:"edit-header-controls",children:[e.jsxs("select",{className:"form-select-inline-small",value:s.tier||1,onChange:a=>r("tier",parseInt(a.target.value)),children:[e.jsx("option",{value:1,children:"Tier 1"}),e.jsx("option",{value:2,children:"Tier 2"}),e.jsx("option",{value:3,children:"Tier 3"}),e.jsx("option",{value:4,children:"Tier 4"})]}),e.jsxs("select",{className:"form-select-inline-small","data-type":"type",value:s.type||"",onChange:a=>r("type",a.target.value),children:[e.jsx("option",{value:"",children:"Type"}),e.jsx("option",{value:"Solo",children:"Solo"}),e.jsx("option",{value:"Bruiser",children:"Bruiser"}),e.jsx("option",{value:"Horde",children:"Horde"}),e.jsx("option",{value:"Minion",children:"Minion"}),e.jsx("option",{value:"Ranged",children:"Ranged"}),e.jsx("option",{value:"Standard",children:"Standard"}),e.jsx("option",{value:"Leader",children:"Leader"}),e.jsx("option",{value:"Skulk",children:"Skulk"}),e.jsx("option",{value:"Social",children:"Social"}),e.jsx("option",{value:"Support",children:"Support"})]})]}),e.jsx("textarea",{className:"form-textarea-inline",value:s.description||"",onChange:a=>r("description",a.target.value),placeholder:"Description",rows:2}),e.jsxs("div",{className:"motives-row",children:[e.jsx("span",{className:"motives-label",children:"Motives & Tactics:"}),e.jsx("div",{className:"motives-field",children:e.jsx("textarea",{className:"inline-field",value:s.motives||"",onChange:a=>r("motives",a.target.value),placeholder:"Motives & Tactics",rows:1})})]})]}),e.jsxs("div",{className:"core-stats-block",children:[e.jsxs("div",{className:"stats-row",children:[e.jsxs("span",{className:"stat-item",children:[e.jsx("strong",{children:"Diff:"}),e.jsx("input",{type:"number",className:"form-input-inline-small",value:s.difficulty||"",onChange:a=>r("difficulty",a.target.value===""?"":parseInt(a.target.value)),min:"1",max:"21"})]}),e.jsx("span",{className:"stat-separator",children:"|"}),e.jsxs("span",{className:"stat-item",children:[e.jsx("strong",{children:"Thresholds:"}),e.jsx("input",{type:"number",className:"form-input-inline-small",value:((y=s.thresholds)==null?void 0:y.major)||"",onChange:a=>r("thresholds",{...s.thresholds,major:a.target.value===""?"":parseInt(a.target.value)}),min:"1",max:"20"}),"/",e.jsx("input",{type:"number",className:"form-input-inline-small",value:((N=s.thresholds)==null?void 0:N.severe)||"",onChange:a=>r("thresholds",{...s.thresholds,severe:a.target.value===""?"":parseInt(a.target.value)}),min:"1",max:"25"})]}),e.jsx("span",{className:"stat-separator",children:"|"}),e.jsxs("span",{className:"stat-item",children:[e.jsx("strong",{children:"HP:"}),e.jsx("input",{type:"number",className:"form-input-inline-small",value:s.hpMax||"",onChange:a=>r("hpMax",a.target.value===""?"":parseInt(a.target.value)),min:"1",max:"12"})]}),e.jsx("span",{className:"stat-separator",children:"|"}),e.jsxs("span",{className:"stat-item",children:[e.jsx("strong",{children:"Stress:"}),e.jsx("input",{type:"number",className:"form-input-inline-small",value:s.stressMax||"",onChange:a=>r("stressMax",a.target.value===""?"":parseInt(a.target.value)),min:"1",max:"10"})]})]}),e.jsxs("div",{className:"stats-row",children:[e.jsxs("span",{className:"stat-item",children:[e.jsx("strong",{children:"ATK:"}),e.jsx("input",{type:"number",className:"form-input-inline-small",value:s.atk||"",onChange:a=>r("atk",a.target.value===""?"":parseInt(a.target.value)),min:"-10",max:"10"})]}),e.jsx("span",{className:"stat-separator",children:"|"}),e.jsxs("span",{className:"stat-item",children:[e.jsx("strong",{children:e.jsx("input",{type:"text",className:"form-input-inline-small",value:s.weapon||"",onChange:a=>r("weapon",a.target.value),placeholder:"Weapon"})}),":",e.jsxs("select",{className:"form-select-inline-small","data-field":"range",value:s.range||"",onChange:a=>r("range",a.target.value),children:[e.jsx("option",{value:"",children:"Select Range"}),e.jsx("option",{value:"Melee",children:"Melee"}),e.jsx("option",{value:"Very Close",children:"Very Close"}),e.jsx("option",{value:"Close",children:"Close"}),e.jsx("option",{value:"Far",children:"Far"}),e.jsx("option",{value:"Very Far",children:"Very Far"})]})]}),e.jsx("span",{className:"stat-separator",children:"|"}),e.jsx("span",{className:"stat-item",children:e.jsx("input",{type:"text",className:"form-input-inline-small",value:s.damage||"",onChange:a=>r("damage",a.target.value),placeholder:"1d12+2 phy"})})]})]}),e.jsx("div",{className:"features-section",children:e.jsx(F,{data:s,onChange:r,onArrayChange:j,onAddItem:g,onRemoveItem:f})})]}):e.jsxs(S,{item:t,type:c,editData:s,onChange:r,onSave:m,onCancel:h,showMetaDetails:!p,children:[p&&e.jsx(b,{data:s,onChange:r}),v&&e.jsx(k,{data:s,onArrayChange:j,onAddItem:g,onRemoveItem:f})]})})})};export{D as default};
